!function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[o]={exports:{}};e[o][0].call(l.exports,function(t){var r=e[o][1][t];return a(r?r:t)},l,l.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){e.exports="# Blender v2.77 (sub 0) OBJ File: 'cube.blend'\n# www.blender.org\nv -0.500000 -0.500000 0.500000\nv -0.500000 0.500000 0.500000\nv -0.500000 -0.500000 -0.500000\nv -0.500000 0.500000 -0.500000\nv 0.500000 -0.500000 0.500000\nv 0.500000 0.500000 0.500000\nv 0.500000 -0.500000 -0.500000\nv 0.500000 0.500000 -0.500000\nvt -0.000000 0.500000\nvt 0.500000 0.500000\nvt 0.500000 1.000000\nvt -0.000000 1.000000\nvt -0.000000 0.500000\nvt 0.500000 0.500000\nvt 0.500000 1.000000\nvt -0.000000 1.000000\nvt -0.000000 0.500000\nvt 0.500000 0.500000\nvt 0.500000 1.000000\nvt -0.000000 1.000000\nvt -0.000000 0.500000\nvt 0.500000 0.500000\nvt 0.500000 1.000000\nvt -0.000000 1.000000\nvt -0.000000 0.500000\nvt 0.500000 0.500000\nvt 0.500000 1.000000\nvt -0.000000 1.000000\nvn -1.000000 0.000000 0.000000\nvn 0.000000 0.000000 -1.000000\nvn 1.000000 0.000000 0.000000\nvn 0.000000 0.000000 1.000000\nvn 0.000000 -1.000000 0.000000\nvn 0.000000 1.000000 0.000000\ns off\nf 2/1/1 4/2/1 3/3/1 1/4/1\nf 4/5/2 8/6/2 7/7/2 3/8/2\nf 8/9/3 6/10/3 5/11/3 7/12/3\nf 6/13/4 2/14/4 1/15/4 5/16/4\nf 1/17/5 3/18/5 7/7/5 5/16/5\nf 6/13/6 8/6/6 4/19/6 2/20/6\n"},{}],2:[function(t,e,r){"use strict";function n(t,e,r){this.model=t,this.position=e,this.color=r,this.destination={x:e.x,y:e.y,z:0},this.position={x:e.x+u(-40,40),y:e.y+u(-40,40),z:e.z}}var a=t("regl")(),i=t("gl-matrix"),o=t("webgl-obj-loader"),s=t("get-pixels"),u=(t("./cube.obj"),function(t,e){return Math.floor(Math.random()*(e-t+1))+t}),f={vertex:function(){return"\n    precision mediump float;\n    attribute vec3 position;\n    uniform mat4 projection;\n    uniform mat4 view;\n    uniform mat4 transform;\n    void main () {\n      gl_Position = projection * view * transform * vec4(position, 1);\n    }"},fragment:function(){return"precision mediump float;\n    uniform vec4 color;\n    void main () {\n      gl_FragColor = color / 255.0;\n    }"}},l=function(){var t=new Float32Array(16),e=i.glMatrix.toRadian(45),r=window.innerWidth/window.innerHeight,n=.1,a=1e3;return i.mat4.perspective(t,e,r,n,a),t},c={position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},h={position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},d=function(){var t=new Float32Array(16);return i.mat4.identity(t),i.mat4.rotate(t,t,i.glMatrix.toRadian(c.rotation.x),[1,0,0]),i.mat4.rotate(t,t,i.glMatrix.toRadian(c.rotation.y),[0,1,0]),i.mat4.rotate(t,t,i.glMatrix.toRadian(c.rotation.z),[0,0,1]),i.mat4.translate(t,t,[-c.position.x,-c.position.y,-c.position.z]),t};n.prototype={getPosition:function(){return this.position},getTransform:function(){var t=new Float32Array(16);return i.mat4.identity(t),i.mat4.rotate(t,t,i.glMatrix.toRadian(h.rotation.x),[1,0,0]),i.mat4.rotate(t,t,i.glMatrix.toRadian(h.rotation.y),[0,1,0]),i.mat4.rotate(t,t,i.glMatrix.toRadian(h.rotation.z),[0,0,1]),i.mat4.translate(t,t,[this.getPosition().x,this.getPosition().y,this.getPosition().z]),i.mat4.scale(t,t,[1,1,1]),t},update:function(){this.position.x-=.1*(this.position.x-this.destination.x),this.position.y-=.1*(this.position.y-this.destination.y),this.position.z-=.1*(this.position.z-this.destination.z)},draw:a({frag:f.fragment,vert:f.vertex,attributes:{position:function(){return this.model.vertices}},uniforms:{transform:function(){return this.getTransform()},view:d,projection:l,color:function(){return this.color}},elements:function(){return this.model.indices},cull:{enable:!0,face:"back"}})},s("Logo.png",function(t,e){if(t)return void console.log("Bad image path");window.cubes=[];for(var r=new o.Mesh(r),i=e.shape[0],s=e.shape[1],f=0;f<s;f++)for(var l=0;l<i;l++){var h=-i/2,d=-s/2,p=e.get(l,f,0),m=e.get(l,f,1),b=e.get(l,f,2);if(0!==p||255!==m||0!==b){var g=[p,m,b,255],v=new n(r,{x:l+h,y:-f-d,z:-40+u(-80,80)},g);cubes.push(v)}}console.log("Everything is loaded"),c.position.z=80,a.frame(function(){a.clear({color:[1,1,1,1],depth:1});for(var t=0;t<cubes.length;t++)cubes[t].update(),cubes[t].draw()})}),document.onmousemove=function(t){var e=t.clientX/window.innerWidth*2-1,r=t.clientY/window.innerHeight*2-1;h.rotation.y=50*e,h.rotation.x=50*r}},{"./cube.obj":1,"get-pixels":13,"gl-matrix":14,regl:79,"webgl-obj-loader":85}],3:[function(t,e,r){"use strict";function n(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)u[e]=t[e],f[t.charCodeAt(e)]=e;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63}function a(t){var e,r,n,a,i,o,s=t.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[s-2]?2:"="===t[s-1]?1:0,o=new l(3*s/4-i),n=i>0?s-4:s;var u=0;for(e=0,r=0;e<n;e+=4,r+=3)a=f[t.charCodeAt(e)]<<18|f[t.charCodeAt(e+1)]<<12|f[t.charCodeAt(e+2)]<<6|f[t.charCodeAt(e+3)],o[u++]=a>>16&255,o[u++]=a>>8&255,o[u++]=255&a;return 2===i?(a=f[t.charCodeAt(e)]<<2|f[t.charCodeAt(e+1)]>>4,o[u++]=255&a):1===i&&(a=f[t.charCodeAt(e)]<<10|f[t.charCodeAt(e+1)]<<4|f[t.charCodeAt(e+2)]>>2,o[u++]=a>>8&255,o[u++]=255&a),o}function i(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function o(t,e,r){for(var n,a=[],o=e;o<r;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],a.push(i(n));return a.join("")}function s(t){for(var e,r=t.length,n=r%3,a="",i=[],s=16383,f=0,l=r-n;f<l;f+=s)i.push(o(t,f,f+s>l?l:f+s));return 1===n?(e=t[r-1],a+=u[e>>2],a+=u[e<<4&63],a+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],a+=u[e>>10],a+=u[e>>4&63],a+=u[e<<2&63],a+="="),i.push(a),i.join("")}r.toByteArray=a,r.fromByteArray=s;var u=[],f=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array;n()},{}],4:[function(t,e,r){},{}],5:[function(t,e,r){(function(e){"use strict";var n=t("buffer"),a=n.Buffer,i=n.SlowBuffer,o=n.kMaxLength||2147483647;r.alloc=function(t,e,r){if("function"==typeof a.alloc)return a.alloc(t,e,r);if("number"==typeof r)throw new TypeError("encoding must not be number");if("number"!=typeof t)throw new TypeError("size must be a number");if(t>o)throw new RangeError("size is too large");var n=r,i=e;void 0===i&&(n=void 0,i=0);var s=new a(t);if("string"==typeof i)for(var u=new a(i,n),f=u.length,l=-1;++l<t;)s[l]=u[l%f];else s.fill(i);return s},r.allocUnsafe=function(t){if("function"==typeof a.allocUnsafe)return a.allocUnsafe(t);if("number"!=typeof t)throw new TypeError("size must be a number");if(t>o)throw new RangeError("size is too large");return new a(t)},r.from=function(t,r,n){if("function"==typeof a.from&&(!e.Uint8Array||Uint8Array.from!==a.from))return a.from(t,r,n);if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("string"==typeof t)return new a(t,r);if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var i=r;if(1===arguments.length)return new a(t);"undefined"==typeof i&&(i=0);var o=n;if("undefined"==typeof o&&(o=t.byteLength-i),i>=t.byteLength)throw new RangeError("'offset' is out of bounds");if(o>t.byteLength-i)throw new RangeError("'length' is out of bounds");return new a(t.slice(i,i+o))}if(a.isBuffer(t)){var s=new a(t.length);return t.copy(s,0,0,t.length),s}if(t){if(Array.isArray(t)||"undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return new a(t);if("Buffer"===t.type&&Array.isArray(t.data))return new a(t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},r.allocUnsafeSlow=function(t){if("function"==typeof a.allocUnsafeSlow)return a.allocUnsafeSlow(t);if("number"!=typeof t)throw new TypeError("size must be a number");if(t>=o)throw new RangeError("size is too large");return new i(t)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:6}],6:[function(t,e,r){(function(e){"use strict";function n(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function a(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):(null===t&&(t=new o(e)),t.length=e),t}function o(t,e,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return s(this,t,e,r)}function s(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?d(t,e,r,n):"string"==typeof e?c(t,e,r):p(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e,r,n){return u(e),e<=0?i(t,e):void 0!==r?"string"==typeof n?i(t,e).fill(r,n):i(t,e).fill(r):i(t,e)}function l(t,e){if(u(e),t=i(t,e<0?0:0|m(e)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function c(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|g(e,r);t=i(t,n);var a=t.write(e,r);return a!==n&&(t=t.slice(0,a)),t}function h(t,e){var r=e.length<0?0:0|m(e.length);t=i(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function d(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),o.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=o.prototype):t=h(t,e),t}function p(t,e){if(o.isBuffer(e)){var r=0|m(e.length);return t=i(t,r),0===t.length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||Z(e.length)?i(t,0):h(t,e);if("Buffer"===e.type&&K(e.data))return h(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function b(t){return+t!=t&&(t=0),o.alloc(+t)}function g(t,e){if(o.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(t).length;default:if(n)return V(t).length;e=(""+e).toLowerCase(),n=!0}}function v(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return F(this,e,r);case"ascii":return j(this,e,r);case"latin1":case"binary":return T(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function x(t,e,r,n,a){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=a?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(a)return-1;r=t.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:w(t,e,r,n,a);if("number"==typeof e)return e=255&e,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,n,a);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,n,a){function i(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,u=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,r/=2}var f;if(a){var l=-1;for(f=r;f<s;f++)if(i(t,f)===i(e,l===-1?0:f-l)){if(l===-1&&(l=f),f-l+1===u)return l*o}else l!==-1&&(f-=f-l),l=-1}else for(r+u>s&&(r=s-u),f=r;f>=0;f--){for(var c=!0,h=0;h<u;h++)if(i(t,f+h)!==i(e,h)){c=!1;break}if(c)return f}return-1}function M(t,e,r,n){r=Number(r)||0;var a=t.length-r;n?(n=Number(n),n>a&&(n=a)):n=a;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[r+o]=s}return o}function S(t,e,r,n){return X(V(e,t.length-r),t,r,n)}function _(t,e,r,n){return X(H(e),t,r,n)}function D(t,e,r,n){return _(t,e,r,n)}function A(t,e,r,n){return X(Q(e),t,r,n)}function I(t,e,r,n){return X(G(e,t.length-r),t,r,n)}function E(t,e,r){return 0===e&&r===t.length?$.fromByteArray(t):$.fromByteArray(t.slice(e,r))}function F(t,e,r){r=Math.min(t.length,r);for(var n=[],a=e;a<r;){var i=t[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s<=r){var u,f,l,c;switch(s){case 1:i<128&&(o=i);break;case 2:u=t[a+1],128===(192&u)&&(c=(31&i)<<6|63&u,c>127&&(o=c));break;case 3:u=t[a+1],f=t[a+2],128===(192&u)&&128===(192&f)&&(c=(15&i)<<12|(63&u)<<6|63&f,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:u=t[a+1],f=t[a+2],l=t[a+3],128===(192&u)&&128===(192&f)&&128===(192&l)&&(c=(15&i)<<18|(63&u)<<12|(63&f)<<6|63&l,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),a+=s}return k(n)}function k(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=tt));return r}function j(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(127&t[a]);return n}function T(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(t[a]);return n}function R(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var a="",i=e;i<r;++i)a+=W(t[i]);return a}function O(t,e,r){for(var n=t.slice(e,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}function z(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,r,n,a,i){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function B(t,e,r,n){e<0&&(e=65535+e+1);for(var a=0,i=Math.min(t.length-r,2);a<i;++a)t[r+a]=(e&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function P(t,e,r,n){e<0&&(e=4294967295+e+1);for(var a=0,i=Math.min(t.length-r,4);a<i;++a)t[r+a]=e>>>8*(n?a:3-a)&255}function C(t,e,r,n,a,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,n,a){return a||C(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,r,n,23,4),r+4}function q(t,e,r,n,a){return a||C(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,r,n,52,8),r+8}function N(t){if(t=Y(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function Y(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function W(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){e=e||1/0;for(var r,n=t.length,a=null,i=[],o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!a){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(e-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function H(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function G(t,e){for(var r,n,a,i=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,a=r%256,i.push(a),i.push(n);return i}function Q(t){return $.toByteArray(N(t))}function X(t,e,r,n){for(var a=0;a<n&&!(a+r>=e.length||a>=t.length);++a)e[a+r]=t[a];return a}function Z(t){return t!==t}var $=t("base64-js"),J=t("ieee754"),K=t("isarray");r.Buffer=o,r.SlowBuffer=b,r.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:n(),r.kMaxLength=a(),o.poolSize=8192,o._augment=function(t){return t.__proto__=o.prototype,t},o.from=function(t,e,r){return s(null,t,e,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(t,e,r){return f(null,t,e,r)},o.allocUnsafe=function(t){return l(null,t)},o.allocUnsafeSlow=function(t){return l(null,t)},o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,a=0,i=Math.min(r,n);a<i;++a)if(t[a]!==e[a]){r=t[a],n=e[a];break}return r<n?-1:n<r?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!K(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=o.allocUnsafe(e),a=0;for(r=0;r<t.length;++r){var i=t[r];if(!o.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,a),a+=i.length}return n},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?F(this,0,t):v.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t,e,r,n,a){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),e<0||r>t.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&e>=r)return 0;if(n>=a)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,a>>>=0,this===t)return 0;for(var i=a-n,s=r-e,u=Math.min(i,s),f=this.slice(n,a),l=t.slice(e,r),c=0;c<u;++c)if(f[c]!==l[c]){i=f[c],s=l[c];break}return i<s?-1:s<i?1:0},o.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},o.prototype.indexOf=function(t,e,r){return x(this,t,e,r,!0)},o.prototype.lastIndexOf=function(t,e,r){return x(this,t,e,r,!1)},o.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-e;if((void 0===r||r>a)&&(r=a),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return M(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":return _(this,t,e,r);case"latin1":case"binary":return D(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;o.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=o.prototype;else{var a=e-t;n=new o(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+t]}return n},o.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||z(t,e,this.length);for(var n=this[t],a=1,i=0;++i<e&&(a*=256);)n+=this[t+i]*a;return n},o.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||z(t,e,this.length);for(var n=this[t+--e],a=1;e>0&&(a*=256);)n+=this[t+--e]*a;return n},o.prototype.readUInt8=function(t,e){return e||z(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||z(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||z(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||z(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||z(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||z(t,e,this.length);for(var n=this[t],a=1,i=0;++i<e&&(a*=256);)n+=this[t+i]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||z(t,e,this.length);for(var n=e,a=1,i=this[t+--n];n>0&&(a*=256);)i+=this[t+--n]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*e)),i},o.prototype.readInt8=function(t,e){return e||z(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,e){e||z(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(t,e){e||z(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(t,e){return e||z(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||z(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||z(t,4,this.length),J.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||z(t,4,this.length),J.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return e||z(t,8,this.length),J.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||z(t,8,this.length),J.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var a=Math.pow(2,8*r)-1;L(this,t,e,r,a,0)}var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},o.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e=0|e,r=0|r,!n){var a=Math.pow(2,8*r)-1;L(this,t,e,r,a,0)}var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},o.prototype.writeUInt8=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):P(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var a=Math.pow(2,8*r-1);L(this,t,e,r,a-1,-a)}var i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},o.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var a=Math.pow(2,8*r-1);L(this,t,e,r,a-1,-a)}var i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},o.prototype.writeInt8=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):P(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},o.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},o.prototype.writeDoubleLE=function(t,e,r){return q(this,t,e,!0,r)},o.prototype.writeDoubleBE=function(t,e,r){return q(this,t,e,!1,r)},o.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var a,i=n-r;if(this===t&&r<e&&e<n)for(a=i-1;a>=0;--a)t[a+e]=this[a+r];else if(i<1e3||!o.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)t[a+e]=this[a+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},o.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t=255&t);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var i;if("number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var s=o.isBuffer(t)?t:V(new o(t,n).toString()),u=s.length;for(i=0;i<r-e;++i)this[i+e]=s[i%u]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":3,ieee754:24,isarray:28}],7:[function(t,e,r){(function(t){function e(t){return Array.isArray?Array.isArray(t):"[object Array]"===b(t)}function n(t){return"boolean"==typeof t}function a(t){return null===t}function i(t){return null==t}function o(t){return"number"==typeof t}function s(t){return"string"==typeof t}function u(t){return"symbol"==typeof t}function f(t){return void 0===t}function l(t){return"[object RegExp]"===b(t)}function c(t){return"object"==typeof t&&null!==t}function h(t){return"[object Date]"===b(t)}function d(t){return"[object Error]"===b(t)||t instanceof Error}function p(t){return"function"==typeof t}function m(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function b(t){return Object.prototype.toString.call(t)}r.isArray=e,r.isBoolean=n,r.isNull=a,r.isNullOrUndefined=i,r.isNumber=o,r.isString=s,r.isSymbol=u,r.isUndefined=f,r.isRegExp=l,r.isObject=c,r.isDate=h,r.isError=d,r.isFunction=p,r.isPrimitive=m,r.isBuffer=t.isBuffer}).call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":27}],8:[function(t,e,r){"use strict";function n(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function a(t){var e=new n;e.pre=t.pre,e.body=t.body,e.post=t.post;var r=t.args.slice(0);e.argTypes=r;for(var a=0;a<r.length;++a){var o=r[a];if("array"===o||"object"==typeof o&&o.blockIndices){if(e.argTypes[a]="array",e.arrayArgs.push(a),e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),e.shimArgs.push("array"+a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array args");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)e.scalarArgs.push(a),e.shimArgs.push("scalar"+a);else if("index"===o){if(e.indexArgs.push(a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array index");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array index");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(e.shapeArgs.push(a),a<e.pre.args.length&&e.pre.args[a].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array shape");if(a<e.post.args.length&&e.post.args[a].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+r[a]);e.argTypes[a]="offset",e.offsetArgs.push({array:o.array,offset:o.offset}),e.offsetArgIndex.push(a)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,i(e)}var i=t("./lib/thunk.js");e.exports=a},{"./lib/thunk.js":10}],9:[function(t,e,r){"use strict";function n(t,e,r){var n,a,i=t.length,o=e.arrayArgs.length,s=e.indexArgs.length>0,u=[],f=[],l=0,c=0;for(n=0;n<i;++n)f.push(["i",n,"=0"].join(""));for(a=0;a<o;++a)for(n=0;n<i;++n)c=l,l=t[n],0===n?f.push(["d",a,"s",n,"=t",a,"p",l].join("")):f.push(["d",a,"s",n,"=(t",a,"p",l,"-s",c,"*t",a,"p",c,")"].join(""));for(u.push("var "+f.join(",")),n=i-1;n>=0;--n)l=t[n],u.push(["for(i",n,"=0;i",n,"<s",l,";++i",n,"){"].join(""));
for(u.push(r),n=0;n<i;++n){for(c=l,l=t[n],a=0;a<o;++a)u.push(["p",a,"+=d",a,"s",n].join(""));s&&(n>0&&u.push(["index[",c,"]-=s",c].join("")),u.push(["++index[",l,"]"].join(""))),u.push("}")}return u.join("\n")}function a(t,e,r,a){for(var i=e.length,o=r.arrayArgs.length,s=r.blockSize,u=r.indexArgs.length>0,f=[],l=0;l<o;++l)f.push(["var offset",l,"=p",l].join(""));for(var l=t;l<i;++l)f.push(["for(var j"+l+"=SS[",e[l],"]|0;j",l,">0;){"].join("")),f.push(["if(j",l,"<",s,"){"].join("")),f.push(["s",e[l],"=j",l].join("")),f.push(["j",l,"=0"].join("")),f.push(["}else{s",e[l],"=",s].join("")),f.push(["j",l,"-=",s,"}"].join("")),u&&f.push(["index[",e[l],"]=j",l].join(""));for(var l=0;l<o;++l){for(var c=["offset"+l],h=t;h<i;++h)c.push(["j",h,"*t",l,"p",e[h]].join(""));f.push(["p",l,"=(",c.join("+"),")"].join(""))}f.push(n(e,r,a));for(var l=t;l<i;++l)f.push("}");return f.join("\n")}function i(t){for(var e=0,r=t[0].length;e<r;){for(var n=1;n<t.length;++n)if(t[n][e]!==t[0][e])return e;++e}return e}function o(t,e,r){for(var n=t.body,a=[],i=[],o=0;o<t.args.length;++o){var s=t.args[o];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),f="",l=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var c=e.offsetArgIndex.indexOf(o),h=e.offsetArgs[c];l=h.array,f="+q"+c;case"array":f="p"+l+f;var d="l"+o,p="a"+l;if(0===e.arrayBlockIndices[l])1===s.count?"generic"===r[l]?s.lvalue?(a.push(["var ",d,"=",p,".get(",f,")"].join("")),n=n.replace(u,d),i.push([p,".set(",f,",",d,")"].join(""))):n=n.replace(u,[p,".get(",f,")"].join("")):n=n.replace(u,[p,"[",f,"]"].join("")):"generic"===r[l]?(a.push(["var ",d,"=",p,".get(",f,")"].join("")),n=n.replace(u,d),s.lvalue&&i.push([p,".set(",f,",",d,")"].join(""))):(a.push(["var ",d,"=",p,"[",f,"]"].join("")),n=n.replace(u,d),s.lvalue&&i.push([p,"[",f,"]=",d].join("")));else{for(var m=[s.name],b=[f],g=0;g<Math.abs(e.arrayBlockIndices[l]);g++)m.push("\\s*\\[([^\\]]+)\\]"),b.push("$"+(g+1)+"*t"+l+"b"+g);if(u=new RegExp(m.join(""),"g"),f=b.join("+"),"generic"===r[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(u,[p,"[",f,"]"].join(""))}break;case"scalar":n=n.replace(u,"Y"+e.scalarArgs.indexOf(o));break;case"index":n=n.replace(u,"index");break;case"shape":n=n.replace(u,"shape")}}}return[a.join("\n"),n,i.join("\n")].join("\n").trim()}function s(t){for(var e=new Array(t.length),r=!0,n=0;n<t.length;++n){var a=t[n],i=a.match(/\d+/);i=i?i[0]:"",0===a.charAt(0)?e[n]="u"+a.charAt(1)+i:e[n]=a.charAt(0)+i,n>0&&(r=r&&e[n]===e[n-1])}return r?e[0]:e.join("")}function u(t,e){for(var r=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,u=new Array(t.arrayArgs.length),l=new Array(t.arrayArgs.length),c=0;c<t.arrayArgs.length;++c)l[c]=e[2*c],u[c]=e[2*c+1];for(var h=[],d=[],p=[],m=[],b=[],c=0;c<t.arrayArgs.length;++c){t.arrayBlockIndices[c]<0?(p.push(0),m.push(r),h.push(r),d.push(r+t.arrayBlockIndices[c])):(p.push(t.arrayBlockIndices[c]),m.push(t.arrayBlockIndices[c]+r),h.push(0),d.push(t.arrayBlockIndices[c]));for(var g=[],v=0;v<u[c].length;v++)p[c]<=u[c][v]&&u[c][v]<m[c]&&g.push(u[c][v]-p[c]);b.push(g)}for(var y=["SS"],x=["'use strict'"],w=[],v=0;v<r;++v)w.push(["s",v,"=SS[",v,"]"].join(""));for(var c=0;c<t.arrayArgs.length;++c){y.push("a"+c),y.push("t"+c),y.push("p"+c);for(var v=0;v<r;++v)w.push(["t",c,"p",v,"=t",c,"[",p[c]+v,"]"].join(""));for(var v=0;v<Math.abs(t.arrayBlockIndices[c]);++v)w.push(["t",c,"b",v,"=t",c,"[",h[c]+v,"]"].join(""))}for(var c=0;c<t.scalarArgs.length;++c)y.push("Y"+c);if(t.shapeArgs.length>0&&w.push("shape=SS.slice(0)"),t.indexArgs.length>0){for(var M=new Array(r),c=0;c<r;++c)M[c]="0";w.push(["index=[",M.join(","),"]"].join(""))}for(var c=0;c<t.offsetArgs.length;++c){for(var S=t.offsetArgs[c],_=[],v=0;v<S.offset.length;++v)0!==S.offset[v]&&(1===S.offset[v]?_.push(["t",S.array,"p",v].join("")):_.push([S.offset[v],"*t",S.array,"p",v].join("")));0===_.length?w.push("q"+c+"=0"):w.push(["q",c,"=",_.join("+")].join(""))}var D=f([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));w=w.concat(D),x.push("var "+w.join(","));for(var c=0;c<t.arrayArgs.length;++c)x.push("p"+c+"|=0");t.pre.body.length>3&&x.push(o(t.pre,t,l));var A=o(t.body,t,l),I=i(b);I<r?x.push(a(I,b[0],t,A)):x.push(n(b[0],t,A)),t.post.body.length>3&&x.push(o(t.post,t,l)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+x.join("\n")+"\n----------");var E=[t.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",I,s(l)].join(""),F=new Function(["function ",E,"(",y.join(","),"){",x.join("\n"),"} return ",E].join(""));return F()}var f=t("uniq");e.exports=u},{uniq:83}],10:[function(t,e,r){"use strict";function n(t){var e=["'use strict'","var CACHED={}"],r=[],n=t.funcName+"_cwise_thunk";e.push(["return function ",n,"(",t.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],u=[],f=[],l=0;l<t.arrayArgs.length;++l){var c=t.arrayArgs[l];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),i.push("t"+c),i.push("r"+c),o.push("t"+c),o.push("r"+c+".join()"),s.push("array"+c+".data"),s.push("array"+c+".stride"),s.push("array"+c+".offset|0"),l>0&&(u.push("array"+t.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[l]))),f.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[l])+"]"))}t.arrayArgs.length>1&&(e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),e.push("if (!("+f.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(var l=0;l<t.scalarArgs.length;++l)s.push("scalar"+t.scalarArgs[l]);r.push(["type=[",o.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),e.push("var "+r.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");var h=new Function("compile",e.join("\n"));return h(a.bind(void 0,t))}var a=t("./compile.js");e.exports=n},{"./compile.js":9}],11:[function(t,e,r){(function(t){function r(e){if(!/^data\:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');e=e.replace(/\r?\n/g,"");var r=e.indexOf(",");if(-1===r||r<=4)throw new TypeError("malformed data: URI");for(var n=e.substring(5,r).split(";"),a=!1,i="US-ASCII",o=0;o<n.length;o++)"base64"==n[o]?a=!0:0==n[o].indexOf("charset=")&&(i=n[o].substring(8));var s=unescape(e.substring(r+1)),u=a?"base64":"ascii",f=new t(s,u);return f.type=n[0]||"text/plain",f.charset=i,f}e.exports=r}).call(this,t("buffer").Buffer)},{buffer:6}],12:[function(t,e,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,i,u,f;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(r=this._events[t],s(r))return!1;if(a(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(o(r))for(i=Array.prototype.slice.call(arguments,1),f=r.slice(),n=f.length,u=0;u<n;u++)f[u].apply(this,i);return!0},n.prototype.addListener=function(t,e){var r;if(!a(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,a(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!a(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var r,n,i,s;if(!a(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],i=r.length,n=-1,r===e||a(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(s=i;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],a(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?a(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(a(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},{}],13:[function(t,e,r){(function(r,n){"use strict";function a(t,e){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var n=t.getContext("2d");n.drawImage(r,0,0);var a=n.getImageData(0,0,r.width,r.height);e(null,l(new Uint8Array(a.data),[r.width,r.height,4],[4,4*r.width,1],0))},r.onerror=function(t){e(t)},r.src=t}function i(t,e){var r;try{r=new c(t)}catch(t){return void e(t)}if(r.numFrames()>0){var n=[r.numFrames(),r.height,r.width,4],a=new Uint8Array(n[0]*n[1]*n[2]*n[3]),i=l(a,n);try{for(var o=0;o<r.numFrames();++o)r.decodeAndBlitFrameRGBA(o,a.subarray(i.index(o,0,0,0),i.index(o+1,0,0,0)))}catch(t){return void e(t)}e(null,i.transpose(0,2,1))}else{var n=[r.height,r.width,4],a=new Uint8Array(n[0]*n[1]*n[2]),i=l(a,n);try{r.decodeAndBlitFrameRGBA(0,a)}catch(t){return void e(t)}e(null,i.transpose(1,0))}}function o(t,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.overrideMimeType&&r.overrideMimeType("application/binary"),r.onerror=function(t){e(t)},r.onload=function(){if(4===r.readyState){var t=new Uint8Array(r.response);i(t,e)}},r.send()}function s(t){if(void 0===t[0]){for(var e=t.length,r=new Uint8Array(e),n=0;n<e;++n)r[n]=t.get(n);return r}return new Uint8Array(t)}function u(t,e){n.nextTick(function(){try{var r=h(t);r?i(s(r),e):e(new Error("Error parsing data URI"))}catch(t){e(t)}})}var f=t("path"),l=t("ndarray"),c=t("omggif").GifReader,h=(t("ndarray-pack"),t("through"),t("data-uri-to-buffer"));e.exports=function(t,e,n){n||(n=e,e="");var i=f.extname(t);switch(e||i.toUpperCase()){case".GIF":o(t,n);break;default:r.isBuffer(t)&&(t="data:"+e+";base64,"+t.toString("base64")),0===t.indexOf("data:image/gif;")?u(t,n):a(t,n)}}}).call(this,{isBuffer:t("../is-buffer/index.js")},t("_process"))},{"../is-buffer/index.js":27,_process:35,"data-uri-to-buffer":11,ndarray:31,"ndarray-pack":29,omggif:32,path:33,through:82}],14:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":15,"./gl-matrix/mat2.js":16,"./gl-matrix/mat2d.js":17,"./gl-matrix/mat3.js":18,"./gl-matrix/mat4.js":19,"./gl-matrix/quat.js":20,"./gl-matrix/vec2.js":21,"./gl-matrix/vec3.js":22,"./gl-matrix/vec4.js":23}],15:[function(t,e,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=n},{}],16:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.fromValues=function(t,e,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=a,i},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*i-a*n;return o?(o=1/o,t[0]=i*o,t[1]=-n*o,t[2]=-a*o,t[3]=r*o,t):null},a.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],f=r[2],l=r[3];return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*f+i*l,t[3]=a*f+o*l,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=n*-s+i*u,t[3]=a*-s+o*u,t},a.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1];return t[0]=n*s,t[1]=a*s,t[2]=i*u,t[3]=o*u,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],f=e[2],l=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.exports=a},{"./common.js":15}],17:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,r,a,i,o){var s=new n.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=a,s[4]=i,s[5]=o,s},a.set=function(t,e,r,n,a,i,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=r*i-n*a;return u?(u=1/u,t[0]=i*u,t[1]=-n*u,t[2]=-a*u,t[3]=r*u,t[4]=(a*s-i*o)*u,t[5]=(n*o-r*s)*u,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=r[0],l=r[1],c=r[2],h=r[3],d=r[4],p=r[5];return t[0]=n*f+i*l,t[1]=a*f+o*l,t[2]=n*c+i*h,t[3]=a*c+o*h,t[4]=n*d+i*p+s,t[5]=a*d+o*p+u,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*f,t[1]=a*l+o*f,t[2]=n*-f+i*l,t[3]=a*-f+o*l,t[4]=s,t[5]=u,t},a.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=r[0],l=r[1];return t[0]=n*f,t[1]=a*f,t[2]=i*l,t[3]=o*l,t[4]=s,t[5]=u,t},a.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=r[0],l=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*f+i*l+s,t[5]=a*f+o*l+u,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],f=e[0],l=e[1],c=e[2],h=e[3],d=e[4],p=e[5];return Math.abs(r-f)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-h)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-d)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-p)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))},e.exports=a},{"./common.js":15}],18:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,r,a,i,o,s,u,f){var l=new n.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=r,l[3]=a,l[4]=i,l[5]=o,l[6]=s,l[7]=u,l[8]=f,l},a.set=function(t,e,r,n,a,i,o,s,u,f){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=f,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=l*o-s*f,h=-l*i+s*u,d=f*i-o*u,p=r*c+n*h+a*d;return p?(p=1/p,t[0]=c*p,t[1]=(-l*n+a*f)*p,t[2]=(s*n-a*o)*p,t[3]=h*p,t[4]=(l*r-a*u)*p,t[5]=(-s*r+a*i)*p,t[6]=d*p,t[7]=(-f*r+n*u)*p,t[8]=(o*r-n*i)*p,t):null},a.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8];return t[0]=o*l-s*f,t[1]=a*f-n*l,t[2]=n*s-a*o,t[3]=s*u-i*l,t[4]=r*l-a*u,t[5]=a*i-r*s,t[6]=i*f-o*u,t[7]=n*u-r*f,t[8]=r*o-n*i,t},a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],f=t[8];return e*(f*i-o*u)+r*(-f*a+o*s)+n*(u*a-i*s)},a.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],l=e[7],c=e[8],h=r[0],d=r[1],p=r[2],m=r[3],b=r[4],g=r[5],v=r[6],y=r[7],x=r[8];return t[0]=h*n+d*o+p*f,t[1]=h*a+d*s+p*l,t[2]=h*i+d*u+p*c,t[3]=m*n+b*o+g*f,t[4]=m*a+b*s+g*l,t[5]=m*i+b*u+g*c,t[6]=v*n+y*o+x*f,t[7]=v*a+y*s+x*l,t[8]=v*i+y*u+x*c,t},a.mul=a.multiply,a.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],l=e[7],c=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=h*n+d*o+f,t[7]=h*a+d*s+l,t[8]=h*i+d*u+c,t},a.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],l=e[7],c=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*o,t[1]=d*a+h*s,t[2]=d*i+h*u,t[3]=d*o-h*n,t[4]=d*s-h*a,t[5]=d*u-h*i,t[6]=f,t[7]=l,t[8]=c,t},a.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,f=r*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,m=i*o,b=i*s,g=i*u;return t[0]=1-c-p,t[3]=l-g,t[6]=h+b,t[1]=l+g,t[4]=1-f-p,t[7]=d-m,t[2]=h-b,t[5]=d+m,t[8]=1-f-c,t},a.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],m=e[13],b=e[14],g=e[15],v=r*s-n*o,y=r*u-a*o,x=r*f-i*o,w=n*u-a*s,M=n*f-i*s,S=a*f-i*u,_=l*m-c*p,D=l*b-h*p,A=l*g-d*p,I=c*b-h*m,E=c*g-d*m,F=h*g-d*b,k=v*F-y*E+x*I+w*A-M*D+S*_;return k?(k=1/k,t[0]=(s*F-u*E+f*I)*k,t[1]=(u*A-o*F-f*D)*k,t[2]=(o*E-s*A+f*_)*k,t[3]=(a*E-n*F-i*I)*k,t[4]=(r*F-a*A+i*D)*k,t[5]=(n*A-r*E-i*_)*k,t[6]=(m*S-b*M+g*w)*k,t[7]=(b*x-p*S-g*y)*k,t[8]=(p*M-m*x+g*v)*k,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],f=t[6],l=t[7],c=t[8],h=e[0],d=e[1],p=e[2],m=e[3],b=e[4],g=e[5],v=t[6],y=e[7],x=e[8];return Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-d)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-p)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-m)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-b)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-g)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(f-v)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(l-y)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-x)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))},e.exports=a},{"./common.js":15}],19:[function(t,e,r){var n=t("./common.js"),a={scalar:{},SIMD:{}};a.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,r,a,i,o,s,u,f,l,c,h,d,p,m,b){var g=new n.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=a,g[4]=i,g[5]=o,g[6]=s,g[7]=u,g[8]=f,g[9]=l,g[10]=c,g[11]=h,g[12]=d,g[13]=p,g[14]=m,g[15]=b,g},a.set=function(t,e,r,n,a,i,o,s,u,f,l,c,h,d,p,m,b){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=f,t[9]=l,t[10]=c,t[11]=h,t[12]=d,t[13]=p,t[14]=m,t[15]=b,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var r,n,a,i,o,s,u,f,l,c;return r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),f=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,f),o=SIMD.Float32x4.shuffle(r,n,2,3,6,7),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),l=SIMD.Float32x4.shuffle(o,s,0,2,4,6),c=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,8,l),SIMD.Float32x4.store(t,12,c),t},a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],m=e[13],b=e[14],g=e[15],v=r*s-n*o,y=r*u-a*o,x=r*f-i*o,w=n*u-a*s,M=n*f-i*s,S=a*f-i*u,_=l*m-c*p,D=l*b-h*p,A=l*g-d*p,I=c*b-h*m,E=c*g-d*m,F=h*g-d*b,k=v*F-y*E+x*I+w*A-M*D+S*_;return k?(k=1/k,t[0]=(s*F-u*E+f*I)*k,t[1]=(a*E-n*F-i*I)*k,t[2]=(m*S-b*M+g*w)*k,t[3]=(h*M-c*S-d*w)*k,t[4]=(u*A-o*F-f*D)*k,t[5]=(r*F-a*A+i*D)*k,t[6]=(b*x-p*S-g*y)*k,t[7]=(l*S-h*x+d*y)*k,t[8]=(o*E-s*A+f*_)*k,t[9]=(n*A-r*E-i*_)*k,t[10]=(p*M-m*x+g*v)*k,t[11]=(c*x-l*M-d*v)*k,t[12]=(s*D-o*I-u*_)*k,t[13]=(r*I-n*D+a*_)*k,t[14]=(m*y-p*w-b*v)*k,t[15]=(l*w-c*y+h*v)*k,t):null},a.SIMD.invert=function(t,e){var r,n,a,i,o,s,u,f,l,c,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),p=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(h,d,0,1,4,5),n=SIMD.Float32x4.shuffle(p,m,0,1,4,5),r=SIMD.Float32x4.shuffle(o,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,o,1,3,5,7),o=SIMD.Float32x4.shuffle(h,d,2,3,6,7),i=SIMD.Float32x4.shuffle(p,m,2,3,6,7),a=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(n,o),u=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),l=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),f=SIMD.Float32x4.mul(r,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),o=SIMD.Float32x4.mul(r,n),o=SIMD.Float32x4.swizzle(o,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),f),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),f),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(r,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),f),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,o),l),c=SIMD.Float32x4.mul(r,s),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),o=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(o,o))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,f)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,l)),t):null},a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=e[8],c=e[9],h=e[10],d=e[11],p=e[12],m=e[13],b=e[14],g=e[15];return t[0]=s*(h*g-d*b)-c*(u*g-f*b)+m*(u*d-f*h),t[1]=-(n*(h*g-d*b)-c*(a*g-i*b)+m*(a*d-i*h)),t[2]=n*(u*g-f*b)-s*(a*g-i*b)+m*(a*f-i*u),t[3]=-(n*(u*d-f*h)-s*(a*d-i*h)+c*(a*f-i*u)),t[4]=-(o*(h*g-d*b)-l*(u*g-f*b)+p*(u*d-f*h)),t[5]=r*(h*g-d*b)-l*(a*g-i*b)+p*(a*d-i*h),t[6]=-(r*(u*g-f*b)-o*(a*g-i*b)+p*(a*f-i*u)),t[7]=r*(u*d-f*h)-o*(a*d-i*h)+l*(a*f-i*u),t[8]=o*(c*g-d*m)-l*(s*g-f*m)+p*(s*d-f*c),t[9]=-(r*(c*g-d*m)-l*(n*g-i*m)+p*(n*d-i*c)),t[10]=r*(s*g-f*m)-o*(n*g-i*m)+p*(n*f-i*s),t[11]=-(r*(s*d-f*c)-o*(n*d-i*c)+l*(n*f-i*s)),t[12]=-(o*(c*b-h*m)-l*(s*b-u*m)+p*(s*h-u*c)),t[13]=r*(c*b-h*m)-l*(n*b-a*m)+p*(n*h-a*c),t[14]=-(r*(s*b-u*m)-o*(n*b-a*m)+p*(n*u-a*s)),t[15]=r*(s*h-u*c)-o*(n*h-a*c)+l*(n*u-a*s),t},a.SIMD.adjoint=function(t,e){var r,n,a,i,o,s,u,f,l,c,h,d,p,r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12);
return l=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),o=SIMD.Float32x4.shuffle(l,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,l,1,3,5,7),l=SIMD.Float32x4.shuffle(r,n,2,3,6,7),f=SIMD.Float32x4.shuffle(a,i,2,3,6,7),u=SIMD.Float32x4.shuffle(l,f,0,2,4,6),f=SIMD.Float32x4.shuffle(f,l,1,3,5,7),l=SIMD.Float32x4.mul(u,f),l=SIMD.Float32x4.swizzle(l,1,0,3,2),c=SIMD.Float32x4.mul(s,l),h=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,l),c),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),l=SIMD.Float32x4.mul(s,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,l),c),p=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(f,l)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),l=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),f),l=SIMD.Float32x4.swizzle(l,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),c),d=SIMD.Float32x4.mul(o,l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(u,l)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,l),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),l=SIMD.Float32x4.mul(o,s),l=SIMD.Float32x4.swizzle(l,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,l),d),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,l),p),l=SIMD.Float32x4.swizzle(l,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,l),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,l)),l=SIMD.Float32x4.mul(o,f),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,l)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),d),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,l),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.mul(o,u),l=SIMD.Float32x4.swizzle(l,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,l),h),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,l)),l=SIMD.Float32x4.swizzle(l,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(f,l)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,l),p),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,p),t},a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],f=t[8],l=t[9],c=t[10],h=t[11],d=t[12],p=t[13],m=t[14],b=t[15],g=e*o-r*i,v=e*s-n*i,y=e*u-a*i,x=r*s-n*o,w=r*u-a*o,M=n*u-a*s,S=f*p-l*d,_=f*m-c*d,D=f*b-h*d,A=l*m-c*p,I=l*b-h*p,E=c*b-h*m;return g*E-v*I+y*A+x*D-w*_+M*S},a.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(r,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(t,0,u);var f=SIMD.Float32x4.load(r,4),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),o))));SIMD.Float32x4.store(t,4,l);var c=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),o))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(r,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,p),t},a.scalar.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],m=e[12],b=e[13],g=e[14],v=e[15],y=r[0],x=r[1],w=r[2],M=r[3];return t[0]=y*n+x*s+w*c+M*m,t[1]=y*a+x*u+w*h+M*b,t[2]=y*i+x*f+w*d+M*g,t[3]=y*o+x*l+w*p+M*v,y=r[4],x=r[5],w=r[6],M=r[7],t[4]=y*n+x*s+w*c+M*m,t[5]=y*a+x*u+w*h+M*b,t[6]=y*i+x*f+w*d+M*g,t[7]=y*o+x*l+w*p+M*v,y=r[8],x=r[9],w=r[10],M=r[11],t[8]=y*n+x*s+w*c+M*m,t[9]=y*a+x*u+w*h+M*b,t[10]=y*i+x*f+w*d+M*g,t[11]=y*o+x*l+w*p+M*v,y=r[12],x=r[13],w=r[14],M=r[15],t[12]=y*n+x*s+w*c+M*m,t[13]=y*a+x*u+w*h+M*b,t[14]=y*i+x*f+w*d+M*g,t[15]=y*o+x*l+w*p+M*v,t},a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,r){var n,a,i,o,s,u,f,l,c,h,d,p,m=r[0],b=r[1],g=r[2];return e===t?(t[12]=e[0]*m+e[4]*b+e[8]*g+e[12],t[13]=e[1]*m+e[5]*b+e[9]*g+e[13],t[14]=e[2]*m+e[6]*b+e[10]*g+e[14],t[15]=e[3]*m+e[7]*b+e[11]*g+e[15]):(n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],f=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=f,t[7]=l,t[8]=c,t[9]=h,t[10]=d,t[11]=p,t[12]=n*m+s*b+c*g+e[12],t[13]=a*m+u*b+h*g+e[13],t[14]=i*m+f*b+d*g+e[14],t[15]=o*m+l*b+p*g+e[15]),t},a.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(t,12,u),t},a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,r){var n,a,i,o=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,r,a){var i,o,s,u,f,l,c,h,d,p,m,b,g,v,y,x,w,M,S,_,D,A,I,E,F=a[0],k=a[1],j=a[2],T=Math.sqrt(F*F+k*k+j*j);return Math.abs(T)<n.EPSILON?null:(T=1/T,F*=T,k*=T,j*=T,i=Math.sin(r),o=Math.cos(r),s=1-o,u=e[0],f=e[1],l=e[2],c=e[3],h=e[4],d=e[5],p=e[6],m=e[7],b=e[8],g=e[9],v=e[10],y=e[11],x=F*F*s+o,w=k*F*s+j*i,M=j*F*s-k*i,S=F*k*s-j*i,_=k*k*s+o,D=j*k*s+F*i,A=F*j*s+k*i,I=k*j*s-F*i,E=j*j*s+o,t[0]=u*x+h*w+b*M,t[1]=f*x+d*w+g*M,t[2]=l*x+p*w+v*M,t[3]=c*x+m*w+y*M,t[4]=u*S+h*_+b*D,t[5]=f*S+d*_+g*D,t[6]=l*S+p*_+v*D,t[7]=c*S+m*_+y*D,t[8]=u*A+h*I+b*E,t[9]=f*A+d*I+g*E,t[10]=l*A+p*I+v*E,t[11]=c*A+m*I+y*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],u=e[7],f=e[8],l=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+f*n,t[5]=o*a+l*n,t[6]=s*a+c*n,t[7]=u*a+h*n,t[8]=f*a-i*n,t[9]=l*a-o*n,t[10]=c*a-s*n,t[11]=h*a-u*n,t},a.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),t},a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],f=e[8],l=e[9],c=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-f*n,t[1]=o*a-l*n,t[2]=s*a-c*n,t[3]=u*a-h*n,t[8]=i*n+f*a,t[9]=o*n+l*a,t[10]=s*n+c*a,t[11]=u*n+h*a,t},a.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,n),SIMD.Float32x4.mul(o,a))),t},a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],f=e[4],l=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+f*n,t[1]=o*a+l*n,t[2]=s*a+c*n,t[3]=u*a+h*n,t[4]=f*a-i*n,t[5]=l*a-o*n,t[6]=c*a-s*n,t[7]=h*a-u*n,t},a.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),t},a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,r){var a,i,o,s=r[0],u=r[1],f=r[2],l=Math.sqrt(s*s+u*u+f*f);return Math.abs(l)<n.EPSILON?null:(l=1/l,s*=l,u*=l,f*=l,a=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=s*s*o+i,t[1]=u*s*o+f*a,t[2]=f*s*o-u*a,t[3]=0,t[4]=s*u*o-f*a,t[5]=u*u*o+i,t[6]=f*u*o+s*a,t[7]=0,t[8]=s*f*o+u*a,t[9]=u*f*o-s*a,t[10]=f*f*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,u=a+a,f=i+i,l=n*s,c=n*u,h=n*f,d=a*u,p=a*f,m=i*f,b=o*s,g=o*u,v=o*f;return t[0]=1-(d+m),t[1]=c+v,t[2]=h-g,t[3]=0,t[4]=c-v,t[5]=1-(l+m),t[6]=p+b,t[7]=0,t[8]=h+g,t[9]=p-b,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},a.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3],u=a+a,f=i+i,l=o+o,c=a*u,h=a*f,d=a*l,p=i*f,m=i*l,b=o*l,g=s*u,v=s*f,y=s*l,x=n[0],w=n[1],M=n[2];return t[0]=(1-(p+b))*x,t[1]=(h+y)*x,t[2]=(d-v)*x,t[3]=0,t[4]=(h-y)*w,t[5]=(1-(c+b))*w,t[6]=(m+g)*w,t[7]=0,t[8]=(d+v)*M,t[9]=(m-g)*M,t[10]=(1-(c+p))*M,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var i=e[0],o=e[1],s=e[2],u=e[3],f=i+i,l=o+o,c=s+s,h=i*f,d=i*l,p=i*c,m=o*l,b=o*c,g=s*c,v=u*f,y=u*l,x=u*c,w=n[0],M=n[1],S=n[2],_=a[0],D=a[1],A=a[2];return t[0]=(1-(m+g))*w,t[1]=(d+x)*w,t[2]=(p-y)*w,t[3]=0,t[4]=(d-x)*M,t[5]=(1-(h+g))*M,t[6]=(b+v)*M,t[7]=0,t[8]=(p+y)*S,t[9]=(b-v)*S,t[10]=(1-(h+m))*S,t[11]=0,t[12]=r[0]+_-(t[0]*_+t[4]*D+t[8]*A),t[13]=r[1]+D-(t[1]*_+t[5]*D+t[9]*A),t[14]=r[2]+A-(t[2]*_+t[6]*D+t[10]*A),t[15]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,f=r*o,l=n*o,c=n*s,h=a*o,d=a*s,p=a*u,m=i*o,b=i*s,g=i*u;return t[0]=1-c-p,t[1]=l+g,t[2]=h-b,t[3]=0,t[4]=l-g,t[5]=1-f-p,t[6]=d+m,t[7]=0,t[8]=h+b,t[9]=d-m,t[10]=1-f-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,r,n,a,i,o){var s=1/(r-e),u=1/(a-n),f=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*u,t[10]=(o+i)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*f,t[15]=0,t},a.perspective=function(t,e,r,n,a){var i=1/Math.tan(e/2),o=1/(n-a);return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*o,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),f=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=f,t[6]=0,t[7]=0,t[8]=-((o-s)*u*.5),t[9]=(a-i)*f*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},a.ortho=function(t,e,r,n,a,i,o){var s=1/(e-r),u=1/(n-a),f=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=(o+i)*f,t[15]=1,t},a.lookAt=function(t,e,r,i){var o,s,u,f,l,c,h,d,p,m,b=e[0],g=e[1],v=e[2],y=i[0],x=i[1],w=i[2],M=r[0],S=r[1],_=r[2];return Math.abs(b-M)<n.EPSILON&&Math.abs(g-S)<n.EPSILON&&Math.abs(v-_)<n.EPSILON?a.identity(t):(h=b-M,d=g-S,p=v-_,m=1/Math.sqrt(h*h+d*d+p*p),h*=m,d*=m,p*=m,o=x*p-w*d,s=w*h-y*p,u=y*d-x*h,m=Math.sqrt(o*o+s*s+u*u),m?(m=1/m,o*=m,s*=m,u*=m):(o=0,s=0,u=0),f=d*u-p*s,l=p*o-h*u,c=h*s-d*o,m=Math.sqrt(f*f+l*l+c*c),m?(m=1/m,f*=m,l*=m,c*=m):(f=0,l=0,c=0),t[0]=o,t[1]=f,t[2]=h,t[3]=0,t[4]=s,t[5]=l,t[6]=d,t[7]=0,t[8]=u,t[9]=c,t[10]=p,t[11]=0,t[12]=-(o*b+s*g+u*v),t[13]=-(f*b+l*g+c*v),t[14]=-(h*b+d*g+p*v),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],f=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],m=t[12],b=t[13],g=t[14],v=t[15],y=e[0],x=e[1],w=e[2],M=e[3],S=e[4],_=e[5],D=e[6],A=e[7],I=e[8],E=e[9],F=e[10],k=e[11],j=e[12],T=e[13],R=e[14],O=e[15];return Math.abs(r-y)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-x)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(i-w)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-M)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(s-S)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-_)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(f-D)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(l-A)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-I)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-E)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-F)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(p-k)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(m-j)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(b-T)<=n.EPSILON*Math.max(1,Math.abs(b),Math.abs(T))&&Math.abs(g-R)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(v-O)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))},e.exports=a},{"./common.js":15}],20:[function(t,e,r){var n=t("./common.js"),a=t("./mat3.js"),i=t("./vec3.js"),o=t("./vec4.js"),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=i.create(),e=i.fromValues(1,0,0),r=i.fromValues(0,1,0);return function(n,a,o){var u=i.dot(a,o);return u<-.999999?(i.cross(t,e,a),i.length(t)<1e-6&&i.cross(t,r,a),i.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):u>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(i.cross(t,a,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+u,s.normalize(n,n))}}(),s.setAxes=function(){var t=a.create();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},s.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},s.add=o.add,s.multiply=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],f=r[2],l=r[3];return t[0]=n*l+o*s+a*f-i*u,t[1]=a*l+o*u+i*s-n*f,t[2]=i*l+o*f+n*u-a*s,t[3]=o*l-n*s-a*u-i*f,t},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-n*s,t},s.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u-i*s,t[1]=a*u+o*s,t[2]=i*u+n*s,t[3]=o*u-a*s,t},s.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*s,t[1]=a*u-n*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t},s.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(t,e,r,n){var a,i,o,s,u,f=e[0],l=e[1],c=e[2],h=e[3],d=r[0],p=r[1],m=r[2],b=r[3];return i=f*d+l*p+c*m+h*b,i<0&&(i=-i,d=-d,p=-p,m=-m,b=-b),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-n)*a)/o,u=Math.sin(n*a)/o):(s=1-n,u=n),t[0]=s*f+u*d,t[1]=s*l+u*p,t[2]=s*c+u*m,t[3]=s*h+u*b,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(r,n,a,i,o,u){return s.slerp(t,n,o,u),s.slerp(e,a,i,u),s.slerp(r,t,e,2*u*(1-u)),r}}(),s.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-a*s,t[3]=i*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+a]+e[3*a+i])*r,t[o]=(e[3*o+a]+e[3*a+o])*r}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,e.exports=s},{"./common.js":15,"./mat3.js":18,"./vec3.js":22,"./vec4.js":23}],21:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,r){return t[0]=e,t[1]=r,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},a.lerp=function(t,e,r,n){var a=e[0],i=e[1];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},a.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},a.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=2),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],i(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var r=t[0],a=t[1],i=e[0],o=e[1];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-o)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},e.exports=a},{"./common.js":15}],22:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,r){var a=new n.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=r,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2];return t[0]=a*u-i*s,t[1]=i*o-n*u,t[2]=n*s-a*o,t},a.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t},a.hermite=function(t,e,r,n,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,f=o*(i-1),l=o*(3-2*i);return t[0]=e[0]*s+r[0]*u+n[0]*f+a[0]*l,t[1]=e[1]*s+r[1]*u+n[1]*f+a[1]*l,t[2]=e[2]*s+r[2]*u+n[2]*f+a[2]*l,t},a.bezier=function(t,e,r,n,a,i){var o=1-i,s=o*o,u=i*i,f=s*o,l=3*i*s,c=3*u*o,h=u*i;return t[0]=e[0]*f+r[0]*l+n[0]*c+a[0]*h,t[1]=e[1]*f+r[1]*l+n[1]*c+a[1]*h,t[2]=e[2]*f+r[2]*l+n[2]*c+a[2]*h,t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,a=2*n.RANDOM()-1,i=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=a*e,t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1],i=e[2];return t[0]=n*r[0]+a*r[3]+i*r[6],t[1]=n*r[1]+a*r[4]+i*r[7],t[2]=n*r[2]+a*r[5]+i*r[8],t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],f=r[3],l=f*n+s*i-u*a,c=f*a+u*n-o*i,h=f*i+o*a-s*n,d=-o*n-s*a-u*i;return t[0]=l*f+d*-o+c*-u-h*-s,t[1]=c*f+d*-s+h*-o-l*-u,t[2]=h*f+d*-u+l*-s-c*-o,t},a.rotateX=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.rotateY=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.rotateZ=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=3),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),a.angle=function(t,e){var r=a.fromValues(t[0],t[1],t[2]),n=a.fromValues(e[0],e[1],e[2]);a.normalize(r,r),a.normalize(n,n);var i=a.dot(r,n);return i>1?0:Math.acos(i)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=e[0],s=e[1],u=e[2];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-u)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))},e.exports=a},{"./common.js":15}],23:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,r,a){var i=new n.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=a,i},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return r*r+n*n+a*a+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],
t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=a*o,t[3]=i*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t[3]=s+n*(r[3]-s),t},a.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],f=r[3],l=f*n+s*i-u*a,c=f*a+u*n-o*i,h=f*i+o*a-s*n,d=-o*n-s*a-u*i;return t[0]=l*f+d*-o+c*-u-h*-s,t[1]=c*f+d*-s+h*-o-l*-u,t[2]=h*f+d*-u+l*-s-c*-o,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,i,o){var s,u;for(r||(r=4),n||(n=0),u=a?Math.min(a*r+n,e.length):e.length,s=n;s<u;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],f=e[2],l=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-f)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},e.exports=a},{"./common.js":15}],24:[function(t,e,r){r.read=function(t,e,r,n,a){var i,o,s=8*a-n-1,u=(1<<s)-1,f=u>>1,l=-7,c=r?a-1:0,h=r?-1:1,d=t[e+c];for(c+=h,i=d&(1<<-l)-1,d>>=-l,l+=s;l>0;i=256*i+t[e+c],c+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+t[e+c],c+=h,l-=8);if(0===i)i=1-f;else{if(i===u)return o?NaN:(d?-1:1)*(1/0);o+=Math.pow(2,n),i-=f}return(d?-1:1)*o*Math.pow(2,i-n)},r.write=function(t,e,r,n,a,i){var o,s,u,f=8*i-a-1,l=(1<<f)-1,c=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:i-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),e+=o+c>=1?h/u:h*Math.pow(2,1-c),e*u>=2&&(o++,u/=2),o+c>=l?(s=0,o=l):o+c>=1?(s=(e*u-1)*Math.pow(2,a),o+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;t[r+d]=255&s,d+=p,s/=256,a-=8);for(o=o<<a|s,f+=a;f>0;t[r+d]=255&o,d+=p,o/=256,f-=8);t[r+d-p]|=128*m}},{}],25:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],26:[function(t,e,r){"use strict";function n(t){for(var e=new Array(t),r=0;r<t;++r)e[r]=r;return e}e.exports=n},{}],27:[function(t,e,r){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function a(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}e.exports=function(t){return null!=t&&(n(t)||a(t)||!!t._isBuffer)}},{}],28:[function(t,e,r){var n={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},{}],29:[function(t,e,r){"use strict";var n=t("ndarray"),a=t("./doConvert.js");e.exports=function(t,e){for(var r=[],i=t,o=1;Array.isArray(i);)r.push(i.length),o*=i.length,i=i[0];return 0===r.length?n():(e||(e=n(new Float64Array(o),r)),a(e,t),e)}},{"./doConvert.js":30,ndarray:31}],30:[function(t,e,r){e.exports=t("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":8}],31:[function(t,e,r){function n(t,e){return t[0]-e[0]}function a(){var t,e=this.stride,r=new Array(e.length);for(t=0;t<r.length;++t)r[t]=[Math.abs(e[t]),t];r.sort(n);var a=new Array(r.length);for(t=0;t<a.length;++t)a[t]=r[t][1];return a}function i(t,e){var r=["View",e,"d",t].join("");e<0&&(r="View_Nil"+t);var n="generic"===t;if(e===-1){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",o=new Function(i);return o()}if(0===e){var i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",o=new Function("TrivialArray",i);return o(c[t][0])}var i=["'use strict'"],s=u(e),f=s.map(function(t){return"i"+t}),l="this.offset+"+s.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),h=s.map(function(t){return"b"+t}).join(","),d=s.map(function(t){return"c"+t}).join(",");i.push("function "+r+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+s.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),e<4?(i.push("function "+r+"_order(){"),2===e?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+r+"_set("+f.join(",")+",v){"),n?i.push("return this.data.set("+l+",v)}"):i.push("return this.data["+l+"]=v}"),i.push("proto.get=function "+r+"_get("+f.join(",")+"){"),n?i.push("return this.data.get("+l+")}"):i.push("return this.data["+l+"]}"),i.push("proto.index=function "+r+"_index(",f.join(),"){return "+l+"}"),i.push("proto.hi=function "+r+"_hi("+f.join(",")+"){return new "+r+"(this.data,"+s.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+s.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var p=s.map(function(t){return"a"+t+"=this.shape["+t+"]"}),m=s.map(function(t){return"c"+t+"=this.stride["+t+"]"});i.push("proto.lo=function "+r+"_lo("+f.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+m.join(","));for(var b=0;b<e;++b)i.push("if(typeof i"+b+"==='number'&&i"+b+">=0){d=i"+b+"|0;b+=c"+b+"*d;a"+b+"-=d}");i.push("return new "+r+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"c"+t}).join(",")+",b)}"),i.push("proto.step=function "+r+"_step("+f.join(",")+"){var "+s.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+s.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var b=0;b<e;++b)i.push("if(typeof i"+b+"==='number'){d=i"+b+"|0;if(d<0){c+=b"+b+"*(a"+b+"-1);a"+b+"=ceil(-a"+b+"/d)}else{a"+b+"=ceil(a"+b+"/d)}b"+b+"*=d}");i.push("return new "+r+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"b"+t}).join(",")+",c)}");for(var g=new Array(e),v=new Array(e),b=0;b<e;++b)g[b]="a[i"+b+"]",v[b]="b[i"+b+"]";i.push("proto.transpose=function "+r+"_transpose("+f+"){"+f.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+g.join(",")+","+v.join(",")+",this.offset)}"),i.push("proto.pick=function "+r+"_pick("+f+"){var a=[],b=[],c=this.offset");for(var b=0;b<e;++b)i.push("if(typeof i"+b+"==='number'&&i"+b+">=0){c=(c+this.stride["+b+"]*i"+b+")|0}else{a.push(this.shape["+b+"]);b.push(this.stride["+b+"])}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+s.map(function(t){return"shape["+t+"]"}).join(",")+","+s.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(c[t],a)}function o(t){if(f(t))return"buffer";if(l)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function s(t,e,r,n){if(void 0===t){var a=c.array[0];return a([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===r){r=new Array(s);for(var u=s-1,f=1;u>=0;--u)r[u]=f,f*=e[u]}if(void 0===n){n=0;for(var u=0;u<s;++u)r[u]<0&&(n-=(e[u]-1)*r[u])}for(var l=o(t),h=c[l];h.length<=s+1;)h.push(i(l,h.length-1));var a=h[s+1];return a(t,e,r,n)}var u=t("iota-array"),f=t("is-buffer"),l="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=s},{"iota-array":26,"is-buffer":27}],32:[function(t,e,r){function n(t,e,r,n){function i(t){var e=t.length;if(e<2||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}var o=0,n=void 0===n?{}:n,s=void 0===n.loop?null:n.loop,u=void 0===n.palette?null:n.palette;if(e<=0||r<=0||e>65535||r>65535)throw"Width/Height invalid.";t[o++]=71,t[o++]=73,t[o++]=70,t[o++]=56,t[o++]=57,t[o++]=97;var f=0,l=0;if(null!==u){for(var c=i(u);c>>=1;)++f;if(c=1<<f,--f,void 0!==n.background){if(l=n.background,l>=c)throw"Background index out of range.";if(0===l)throw"Background index explicitly passed as 0."}}if(t[o++]=255&e,t[o++]=e>>8&255,t[o++]=255&r,t[o++]=r>>8&255,t[o++]=(null!==u?128:0)|f,t[o++]=l,t[o++]=0,null!==u)for(var h=0,d=u.length;h<d;++h){var p=u[h];t[o++]=p>>16&255,t[o++]=p>>8&255,t[o++]=255&p}if(null!==s){if(s<0||s>65535)throw"Loop count invalid.";t[o++]=33,t[o++]=255,t[o++]=11,t[o++]=78,t[o++]=69,t[o++]=84,t[o++]=83,t[o++]=67,t[o++]=65,t[o++]=80,t[o++]=69,t[o++]=50,t[o++]=46,t[o++]=48,t[o++]=3,t[o++]=1,t[o++]=255&s,t[o++]=s>>8&255,t[o++]=0}var m=!1;this.addFrame=function(e,r,n,s,f,l){if(m===!0&&(--o,m=!1),l=void 0===l?{}:l,e<0||r<0||e>65535||r>65535)throw"x/y invalid.";if(n<=0||s<=0||n>65535||s>65535)throw"Width/Height invalid.";if(f.length<n*s)throw"Not enough pixels for the frame size.";var c=!0,h=l.palette;if(void 0!==h&&null!==h||(c=!1,h=u),void 0===h||null===h)throw"Must supply either a local or global palette.";for(var d=i(h),p=0;d>>=1;)++p;d=1<<p;var b=void 0===l.delay?0:l.delay,g=void 0===l.disposal?0:l.disposal;if(g<0||g>3)throw"Disposal out of range.";var v=!1,y=0;if(void 0!==l.transparent&&null!==l.transparent&&(v=!0,y=l.transparent,y<0||y>=d))throw"Transparent color index.";if((0!==g||v||0!==b)&&(t[o++]=33,t[o++]=249,t[o++]=4,t[o++]=g<<2|(v===!0?1:0),t[o++]=255&b,t[o++]=b>>8&255,t[o++]=y,t[o++]=0),t[o++]=44,t[o++]=255&e,t[o++]=e>>8&255,t[o++]=255&r,t[o++]=r>>8&255,t[o++]=255&n,t[o++]=n>>8&255,t[o++]=255&s,t[o++]=s>>8&255,t[o++]=c===!0?128|p-1:0,c===!0)for(var x=0,w=h.length;x<w;++x){var M=h[x];t[o++]=M>>16&255,t[o++]=M>>8&255,t[o++]=255&M}o=a(t,o,p<2?2:p,f)},this.end=function(){return m===!1&&(t[o++]=59,m=!0),o}}function a(t,e,r,n){function a(r){for(;h>=r;)t[e++]=255&d,d>>=8,h-=8,e===o+256&&(t[o]=255,o=e++)}function i(t){d|=t<<h,h+=c,a(8)}t[e++]=r;var o=e++,s=1<<r,u=s-1,f=s+1,l=f+1,c=r+1,h=0,d=0,p=n[0]&u,m={};i(s);for(var b=1,g=n.length;b<g;++b){var v=n[b]&u,y=p<<8|v,x=m[y];if(void 0===x){for(d|=p<<h,h+=c;h>=8;)t[e++]=255&d,d>>=8,h-=8,e===o+256&&(t[o]=255,o=e++);4096===l?(i(s),l=f+1,c=r+1,m={}):(l>=1<<c&&++c,m[y]=l++),p=v}else p=x}return i(p),i(f),a(1),o+1===e?t[o]=0:(t[o]=e-o-1,t[e++]=0),e}function i(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!==(t[e++]+1&253)||97!==t[e++])throw"Invalid GIF 87a/89a header.";var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,a=t[e++],i=a>>7,s=7&a,u=1<<s+1;t[e++];t[e++];var f=null;i&&(f=e,e+=3*u);var l=!0,c=[],h=0,d=null,p=0,m=null;for(this.width=r,this.height=n;l&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){var b=t[e++];if(0===b)break;e+=b}break;case 249:if(4!==t[e++]||0!==t[e+4])throw"Invalid graphics extension block.";var g=t[e++];h=t[e++]|t[e++]<<8,d=t[e++],0===(1&g)&&(d=null),p=g>>2&7,e++;break;case 254:for(;;){var b=t[e++];if(0===b)break;e+=b}break;default:throw"Unknown graphic control label: 0x"+t[e-1].toString(16)}break;case 44:var v=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,M=t[e++],S=M>>7,_=M>>6&1,D=7&M,A=1<<D+1,I=f,E=!1;if(S){var E=!0;I=e,e+=3*A}var F=e;for(e++;;){var b=t[e++];if(0===b)break;e+=b}c.push({x:v,y:y,width:x,height:w,has_local_palette:E,palette_offset:I,data_offset:F,data_length:e-F,transparent_index:d,interlaced:!!_,delay:h,disposal:p});break;case 59:l=!1;break;default:throw"Unknown gif block: 0x"+t[e-1].toString(16)}this.numFrames=function(){return c.length},this.loopCount=function(){return m},this.frameInfo=function(t){if(t<0||t>=c.length)throw"Frame index out of range.";return c[t]},this.decodeAndBlitFrameBGRA=function(e,n){var a=this.frameInfo(e),i=a.width*a.height,s=new Uint8Array(i);o(t,a.data_offset,s,i);var u=a.palette_offset,f=a.transparent_index;null===f&&(f=256);var l=a.width,c=r-l,h=l,d=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),m=d,b=4*c;a.interlaced===!0&&(b+=4*r*7);for(var g=8,v=0,y=s.length;v<y;++v){var x=s[v];if(0===h&&(m+=b,h=l,m>=p&&(b=4*c+4*r*(g-1),m=d+(l+c)*(g<<1),g>>=1)),x===f)m+=4;else{var w=t[u+3*x],M=t[u+3*x+1],S=t[u+3*x+2];n[m++]=S,n[m++]=M,n[m++]=w,n[m++]=255}--h}},this.decodeAndBlitFrameRGBA=function(e,n){var a=this.frameInfo(e),i=a.width*a.height,s=new Uint8Array(i);o(t,a.data_offset,s,i);var u=a.palette_offset,f=a.transparent_index;null===f&&(f=256);var l=a.width,c=r-l,h=l,d=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),m=d,b=4*c;a.interlaced===!0&&(b+=4*r*7);for(var g=8,v=0,y=s.length;v<y;++v){var x=s[v];if(0===h&&(m+=b,h=l,m>=p&&(b=4*c+4*r*(g-1),m=d+(l+c)*(g<<1),g>>=1)),x===f)m+=4;else{var w=t[u+3*x],M=t[u+3*x+1],S=t[u+3*x+2];n[m++]=w,n[m++]=M,n[m++]=S,n[m++]=255}--h}}}function o(t,e,r,n){for(var a=t[e++],i=1<<a,o=i+1,s=o+1,u=a+1,f=(1<<u)-1,l=0,c=0,h=0,d=t[e++],p=new Int32Array(4096),m=null;;){for(;l<16&&0!==d;)c|=t[e++]<<l,l+=8,1===d?d=t[e++]:--d;if(l<u)break;var b=c&f;if(c>>=u,l-=u,b!==i){if(b===o)break;for(var g=b<s?b:m,v=0,y=g;y>i;)y=p[y]>>8,++v;var x=y,w=h+v+(g!==b?1:0);if(w>n)return void console.log("Warning, gif stream longer than expected.");r[h++]=x,h+=v;var M=h;for(g!==b&&(r[h++]=x),y=g;v--;)y=p[y],r[--M]=255&y,y>>=8;null!==m&&s<4096&&(p[s++]=m<<8|x,s>=f+1&&u<12&&(++u,f=f<<1|1)),m=b}else s=o+1,u=a+1,f=(1<<u)-1,m=null}return h!==n&&console.log("Warning, gif stream shorter than expected."),r}try{r.GifWriter=n,r.GifReader=i}catch(t){}},{}],33:[function(t,e,r){(function(t){function e(t,e){for(var r=0,n=t.length-1;n>=0;n--){var a=t[n];"."===a?t.splice(n,1):".."===a?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return a.exec(t).slice(1)};r.resolve=function(){for(var r="",a=!1,i=arguments.length-1;i>=-1&&!a;i--){var o=i>=0?arguments[i]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(r=o+"/"+r,a="/"===o.charAt(0))}return r=e(n(r.split("/"),function(t){return!!t}),!a).join("/"),(a?"/":"")+r||"."},r.normalize=function(t){var a=r.isAbsolute(t),i="/"===o(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!a).join("/"),t||a||(t="."),t&&i&&(t+="/"),(a?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var a=n(t.split("/")),i=n(e.split("/")),o=Math.min(a.length,i.length),s=o,u=0;u<o;u++)if(a[u]!==i[u]){s=u;break}for(var f=[],u=s;u<a.length;u++)f.push("..");return f=f.concat(i.slice(s)),f.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var e=i(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(t,e){var r=i(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},r.extname=function(t){return i(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:35}],34:[function(t,e,r){(function(t){"use strict";function r(e,r,n,a){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,r)});case 3:return t.nextTick(function(){e.call(null,r,n)});case 4:return t.nextTick(function(){e.call(null,r,n,a)});default:for(i=new Array(s-1),o=0;o<i.length;)i[o++]=arguments[o];return t.nextTick(function(){e.apply(null,i)})}}!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=r:e.exports=t.nextTick}).call(this,t("_process"))},{_process:35}],35:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===a||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){b&&p&&(b=!1,p.length?m=p.concat(m):g=-1,m.length&&u())}function u(){if(!b){var t=i(s);b=!0;for(var e=m.length;e;){for(p=m,m=[];++g<e;)p&&p[g].run();g=-1,e=m.length}p=null,b=!1,o(t)}}function f(t,e){this.fun=t,this.array=e}function l(){}var c,h,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:a}catch(t){h=a}}();var p,m=[],b=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];m.push(new f(t,e)),1!==m.length||b||i(u)},f.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],36:[function(t,e,r){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":37}],37:[function(t,e,r){"use strict";function n(t){return this instanceof n?(f.call(this,t),l.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",a)):new n(t)}function a(){this.allowHalfOpen||this._writableState.ended||s(i,this)}function i(t){t.end()}var o=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};e.exports=n;var s=t("process-nextick-args"),u=t("core-util-is");u.inherits=t("inherits");var f=t("./_stream_readable"),l=t("./_stream_writable");u.inherits(n,f);for(var c=o(l.prototype),h=0;h<c.length;h++){var d=c[h];n.prototype[d]||(n.prototype[d]=l.prototype[d])}},{"./_stream_readable":39,"./_stream_writable":41,"core-util-is":7,inherits:25,"process-nextick-args":34}],38:[function(t,e,r){"use strict";function n(t){return this instanceof n?void a.call(this,t):new n(t)}e.exports=n;var a=t("./_stream_transform"),i=t("core-util-is");i.inherits=t("inherits"),i.inherits(n,a),n.prototype._transform=function(t,e,r){r(null,t)}},{"./_stream_transform":40,"core-util-is":7,inherits:25}],39:[function(t,e,r){(function(r){"use strict";function n(t,e,r){return"function"==typeof t.prependListener?t.prependListener(e,r):void(t._events&&t._events[e]?k(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r))}function a(e,r){U=U||t("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,r instanceof U&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,a=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:a,this.highWaterMark=~~this.highWaterMark,this.buffer=new C,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(P||(P=t("string_decoder/").StringDecoder),this.decoder=new P(e.encoding),this.encoding=e.encoding)}function i(e){return U=U||t("./_stream_duplex"),this instanceof i?(this._readableState=new a(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),void j.call(this)):new i(e)}function o(t,e,r,n,a){var i=l(e,r);if(i)t.emit("error",i);else if(null===r)e.reading=!1,c(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!a){var o=new Error("stream.push() after EOF");t.emit("error",o)}else if(e.endEmitted&&a){var u=new Error("stream.unshift() after end event");t.emit("error",u)}else{var f;!e.decoder||a||n||(r=e.decoder.write(r),f=!e.objectMode&&0===r.length),a||(e.reading=!1),f||(e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,a?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&h(t))),p(t,e)}else a||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function u(t){return t>=q?t=q:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function f(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=u(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function l(t,e){var r=null;return R.isBuffer(e)||"string"==typeof e||null===e||void 0===e||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function c(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,h(t)}}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(B("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?F(d,t):d(t))}function d(t){B("emit readable"),t.emit("readable"),x(t)}function p(t,e){e.readingMore||(e.readingMore=!0,F(m,t,e))}function m(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(B("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function b(t){return function(){var e=t._readableState;B("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&T(t,"data")&&(e.flowing=!0,x(t))}}function g(t){B("readable nexttick read 0"),t.read(0)}function v(t,e){e.resumeScheduled||(e.resumeScheduled=!0,F(y,t,e))}function y(t,e){e.reading||(B("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),x(t),e.flowing&&!e.reading&&t.read(0)}function x(t){var e=t._readableState;for(B("flow",e.flowing);e.flowing&&null!==t.read(););}function w(t,e){if(0===e.length)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):r=M(t,e.buffer,e.decoder),r}function M(t,e,r){var n;return t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():r?S(t,e):_(t,e),n}function S(t,e){var r=e.head,n=1,a=r.data;for(t-=a.length;r=r.next;){var i=r.data,o=t>i.length?i.length:t;if(a+=o===i.length?i:i.slice(0,t),t-=o,0===t){o===i.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=i.slice(o));break}++n}return e.length-=n,a}function _(t,e){var r=O.allocUnsafe(t),n=e.head,a=1;for(n.data.copy(r),t-=n.data.length;n=n.next;){var i=n.data,o=t>i.length?i.length:t;if(i.copy(r,r.length-t,0,o),t-=o,0===t){o===i.length?(++a,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=i.slice(o));break}++a}return e.length-=a,r}function D(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,F(A,e,t))}function A(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function I(t,e){for(var r=0,n=t.length;r<n;r++)e(t[r],r)}function E(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}e.exports=i;var F=t("process-nextick-args"),k=t("isarray");i.ReadableState=a;var j,T=(t("events").EventEmitter,function(t,e){return t.listeners(e).length});!function(){try{j=t("stream")}catch(t){}finally{j||(j=t("events").EventEmitter)}}();var R=t("buffer").Buffer,O=t("buffer-shims"),z=t("core-util-is");z.inherits=t("inherits");var L=t("util"),B=void 0;B=L&&L.debuglog?L.debuglog("stream"):function(){};var P,C=t("./internal/streams/BufferList");z.inherits(i,j);var U,U;i.prototype.push=function(t,e){var r=this._readableState;return r.objectMode||"string"!=typeof t||(e=e||r.defaultEncoding,e!==r.encoding&&(t=O.from(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.isPaused=function(){return this._readableState.flowing===!1},i.prototype.setEncoding=function(e){return P||(P=t("string_decoder/").StringDecoder),this._readableState.decoder=new P(e),this._readableState.encoding=e,this};var q=8388608;i.prototype.read=function(t){B("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return B("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?D(this):h(this),null;if(t=f(t,e),0===t&&e.ended)return 0===e.length&&D(this),null;var n=e.needReadable;B("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&(n=!0,B("length less than watermark",n)),e.ended||e.reading?(n=!1,B("reading or ended",n)):n&&(B("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=f(r,e)));var a;return a=t>0?w(t,e):null,null===a?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&D(this)),null!==a&&this.emit("data",a),a},i.prototype._read=function(t){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function a(t){B("onunpipe"),t===h&&o()}function i(){B("onend"),t.end()}function o(){B("cleanup"),t.removeListener("close",f),t.removeListener("finish",l),t.removeListener("drain",g),t.removeListener("error",u),t.removeListener("unpipe",a),h.removeListener("end",i),h.removeListener("end",o),h.removeListener("data",s),v=!0,!d.awaitDrain||t._writableState&&!t._writableState.needDrain||g()}function s(e){B("ondata"),y=!1;var r=t.write(e);!1!==r||y||((1===d.pipesCount&&d.pipes===t||d.pipesCount>1&&E(d.pipes,t)!==-1)&&!v&&(B("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,y=!0),h.pause())}function u(e){B("onerror",e),c(),t.removeListener("error",u),0===T(t,"error")&&t.emit("error",e)}function f(){t.removeListener("finish",l),c()}function l(){B("onfinish"),t.removeListener("close",f),c()}function c(){B("unpipe"),h.unpipe(t)}var h=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=t;break;case 1:d.pipes=[d.pipes,t];break;default:d.pipes.push(t)}d.pipesCount+=1,B("pipe count=%d opts=%j",d.pipesCount,e);var p=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,m=p?i:o;d.endEmitted?F(m):h.once("end",m),t.on("unpipe",a);var g=b(h);t.on("drain",g);var v=!1,y=!1;return h.on("data",s),n(t,"error",u),t.once("close",f),t.once("finish",l),t.emit("pipe",h),d.flowing||(B("pipe resume"),h.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this);return this}var i=E(e.pipes,t);return i===-1?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var r=j.prototype.on.call(this,t,e);if("data"===t)this._readableState.flowing!==!1&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&h(this,n):F(g,this))}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(B("resume"),t.flowing=!0,v(this,t)),this},i.prototype.pause=function(){return B("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(B("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(B("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(a){if(B("wrapped data"),e.decoder&&(a=e.decoder.write(a)),(!e.objectMode||null!==a&&void 0!==a)&&(e.objectMode||a&&a.length)){var i=n.push(a);i||(r=!0,t.pause())}});for(var a in t)void 0===this[a]&&"function"==typeof t[a]&&(this[a]=function(e){return function(){return t[e].apply(t,arguments)}}(a));var i=["error","close","destroy","pause","resume"];
return I(i,function(e){t.on(e,n.emit.bind(n,e))}),n._read=function(e){B("wrapped _read",e),r&&(r=!1,t.resume())},n},i._fromList=w}).call(this,t("_process"))},{"./_stream_duplex":37,"./internal/streams/BufferList":42,_process:35,buffer:6,"buffer-shims":5,"core-util-is":7,events:12,inherits:25,isarray:28,"process-nextick-args":34,"string_decoder/":81,util:4}],40:[function(t,e,r){"use strict";function n(t){this.afterTransform=function(e,r){return a(t,e,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function a(t,e,r){var n=t._transformState;n.transforming=!1;var a=n.writecb;if(!a)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&t.push(r),a(e);var i=t._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&t._read(i.highWaterMark)}function i(t){if(!(this instanceof i))return new i(t);s.call(this,t),this._transformState=new n(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(t){o(e,t)}):o(e)})}function o(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(n.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}e.exports=i;var s=t("./_stream_duplex"),u=t("core-util-is");u.inherits=t("inherits"),u.inherits(i,s),i.prototype.push=function(t,e){return this._transformState.needTransform=!1,s.prototype.push.call(this,t,e)},i.prototype._transform=function(t,e,r){throw new Error("Not implemented")},i.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},i.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0}},{"./_stream_duplex":37,"core-util-is":7,inherits:25}],41:[function(t,e,r){(function(r){"use strict";function n(){}function a(t,e,r){this.chunk=t,this.encoding=e,this.callback=r,this.next=null}function i(e,r){k=k||t("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,r instanceof k&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,a=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:a,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=e.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(r,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new M(this)}function o(e){return k=k||t("./_stream_duplex"),this instanceof o||this instanceof k?(this._writableState=new i(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),void A.call(this)):new o(e)}function s(t,e){var r=new Error("write after end");t.emit("error",r),S(e,r)}function u(t,e,r,n){var a=!0,i=!1;return null===r?i=new TypeError("May not write null values to stream"):E.isBuffer(r)||"string"==typeof r||void 0===r||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(t.emit("error",i),S(n,i),a=!1),a}function f(t,e,r){return t.objectMode||t.decodeStrings===!1||"string"!=typeof e||(e=F.from(e,r)),e}function l(t,e,r,n,i){r=f(e,r,n),E.isBuffer(r)&&(n="buffer");var o=e.objectMode?1:r.length;e.length+=o;var s=e.length<e.highWaterMark;if(s||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest=new a(r,n,i),u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else c(t,e,!1,o,r,n,i);return s}function c(t,e,r,n,a,i,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,r?t._writev(a,e.onwrite):t._write(a,i,e.onwrite),e.sync=!1}function h(t,e,r,n,a){--e.pendingcb,r?S(a,n):a(n),t._writableState.errorEmitted=!0,t.emit("error",n)}function d(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var r=t._writableState,n=r.sync,a=r.writecb;if(d(r),e)h(t,r,n,e,a);else{var i=v(r);i||r.corked||r.bufferProcessing||!r.bufferedRequest||g(t,r),n?_(m,t,r,i,a):m(t,r,i,a)}}function m(t,e,r,n){r||b(t,e),e.pendingcb--,n(),x(t,e)}function b(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function g(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,a=new Array(n),i=e.corkedRequestsFree;i.entry=r;for(var o=0;r;)a[o]=r,r=r.next,o+=1;c(t,e,!0,e.length,a,"",i.finish),e.pendingcb++,e.lastBufferedRequest=null,i.next?(e.corkedRequestsFree=i.next,i.next=null):e.corkedRequestsFree=new M(e)}else{for(;r;){var s=r.chunk,u=r.encoding,f=r.callback,l=e.objectMode?1:s.length;if(c(t,e,!1,l,s,u,f),r=r.next,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=r,e.bufferProcessing=!1}function v(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function y(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function x(t,e){var r=v(e);return r&&(0===e.pendingcb?(y(t,e),e.finished=!0,t.emit("finish")):y(t,e)),r}function w(t,e,r){e.ending=!0,x(t,e),r&&(e.finished?S(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function M(t){var e=this;this.next=null,this.entry=null,this.finish=function(r){var n=e.entry;for(e.entry=null;n;){var a=n.callback;t.pendingcb--,a(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}e.exports=o;var S=t("process-nextick-args"),_=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?setImmediate:S;o.WritableState=i;var D=t("core-util-is");D.inherits=t("inherits");var A,I={deprecate:t("util-deprecate")};!function(){try{A=t("stream")}catch(t){}finally{A||(A=t("events").EventEmitter)}}();var E=t("buffer").Buffer,F=t("buffer-shims");D.inherits(o,A);var k;i.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(i.prototype,"buffer",{get:I.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(t){}}();var k;o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},o.prototype.write=function(t,e,r){var a=this._writableState,i=!1;return"function"==typeof e&&(r=e,e=null),E.isBuffer(t)?e="buffer":e||(e=a.defaultEncoding),"function"!=typeof r&&(r=n),a.ended?s(this,r):u(this,a,t,r)&&(a.pendingcb++,i=l(this,a,t,e,r)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||g(this,t))},o.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,r){var n=this._writableState;"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!==t&&void 0!==t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||w(this,n,r)}}).call(this,t("_process"))},{"./_stream_duplex":37,_process:35,buffer:6,"buffer-shims":5,"core-util-is":7,events:12,inherits:25,"process-nextick-args":34,"util-deprecate":84}],42:[function(t,e,r){"use strict";function n(){this.head=null,this.tail=null,this.length=0}var a=(t("buffer").Buffer,t("buffer-shims"));e.exports=n,n.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},n.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},n.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},n.prototype.clear=function(){this.head=this.tail=null,this.length=0},n.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,r=""+e.data;e=e.next;)r+=t+e.data;return r},n.prototype.concat=function(t){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var e=a.allocUnsafe(t>>>0),r=this.head,n=0;r;)r.data.copy(e,n),n+=r.data.length,r=r.next;return e}},{buffer:6,"buffer-shims":5}],43:[function(t,e,r){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":38}],44:[function(t,e,r){(function(n){var a=function(){try{return t("stream")}catch(t){}}();r=e.exports=t("./lib/_stream_readable.js"),r.Stream=a||r,r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js"),!n.browser&&"disable"===n.env.READABLE_STREAM&&a&&(e.exports=a)}).call(this,t("_process"))},{"./lib/_stream_duplex.js":37,"./lib/_stream_passthrough.js":38,"./lib/_stream_readable.js":39,"./lib/_stream_transform.js":40,"./lib/_stream_writable.js":41,_process:35}],45:[function(t,e,r){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":40}],46:[function(t,e,r){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":41}],47:[function(t,e,r){function n(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=a,this.offset=0,this.stride=0,this.divisor=0}var a=5126;e.exports=function(t,e,r,a,i){for(var o=r.maxAttributes,s=new Array(o),u=0;u<o;++u)s[u]=new n;return{Record:n,scope:{},state:s}}},{}],48:[function(t,e,r){function n(t){return 0|h[Object.prototype.toString.call(t)]}function a(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function i(t,e,r,n,a,i,o){for(var s=0,u=0;u<r;++u)for(var f=0;f<n;++f)t[s++]=e[a*u+i*f+o]}function o(t,e,r){for(var n=0,a=0;a<e.length;++a)for(var i=e[a],o=0;o<r;++o)t[n++]=i[o]}var s=t("./util/check"),u=t("./util/is-typed-array"),f=t("./util/is-ndarray"),l=t("./util/values"),c=t("./util/pool"),h=t("./constants/arraytypes.json"),d=t("./constants/dtypes.json"),p=t("./constants/usage.json"),m=35044,b=35040,g=5121,v=5126,y=[];y[5120]=1,y[5122]=2,y[5124]=4,y[5121]=1,y[5123]=2,y[5125]=4,y[5126]=4,e.exports=function(t,e,r){function h(e){this.id=I++,this.buffer=t.createBuffer(),this.type=e,this.usage=m,this.byteLength=0,this.dimension=1,this.dtype=g,this.persistentData=null,r.profile&&(this.stats={size:0})}function x(t,e){var r=F.pop();return r||(r=new h(t)),r.bind(),S(r,e,b,0,1,!1),r}function w(t){F.push(t)}function M(e,r,n){e.byteLength=r.byteLength,t.bufferData(e.type,r,n)}function S(t,e,r,l,h,d){if(t.usage=r,Array.isArray(e)){if(t.dtype=l||v,e.length>0){var p;if(Array.isArray(e[0]))t.dimension=e[0].length,p=c.allocType(t.dtype,e.length*t.dimension),o(p,e,t.dimension),M(t,p,r),d?t.persistentData=p:c.freeType(p);else if("number"==typeof e[0]){t.dimension=h;var m=c.allocType(t.dtype,e.length);a(m,e),M(t,m,r),d?t.persistentData=m:c.freeType(m)}else u(e[0])?(t.dimension=e[0].length,t.dtype=l||n(e[0])||v,p=c.allocType(t.dtype,e.length*t.dimension),o(p,e,t.dimension),M(t,p,r),d?t.persistentData=p:c.freeType(p)):s.raise("invalid buffer data")}}else if(u(e))t.dtype=l||n(e),t.dimension=h,M(t,e,r),d&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(f(e)){var b=e.shape,g=e.stride,y=e.offset,x=0,w=0,S=0,_=0;1===b.length?(x=b[0],w=1,S=g[0],_=0):2===b.length?(x=b[0],w=b[1],S=g[0],_=g[1]):s.raise("invalid shape"),t.dtype=l||n(e.data)||v,t.dimension=w;var D=c.allocType(t.dtype,x*w);i(D,e.data,x,w,S,_,y),M(t,D,r),d?t.persistentData=D:c.freeType(D)}else s.raise("invalid buffer data")}function _(r){e.bufferCount--;var n=r.buffer;s(n,"buffer must not be deleted already"),t.deleteBuffer(n),r.buffer=null,delete E[r.id]}function D(l,b,v,x){function w(e){var n=m,a=null,i=0,o=0,l=1;return Array.isArray(e)||u(e)||f(e)?a=e:"number"==typeof e?i=0|e:e&&(s.type(e,"object","buffer arguments must be an object, a number or an array"),"data"in e&&(s(null===a||Array.isArray(a)||u(a)||f(a),"invalid data for buffer"),a=e.data),"usage"in e&&(s.parameter(e.usage,p,"invalid buffer usage"),n=p[e.usage]),"type"in e&&(s.parameter(e.type,d,"invalid buffer type"),o=d[e.type]),"dimension"in e&&(s.type(e.dimension,"number","invalid dimension"),l=0|e.dimension),"length"in e&&(s.nni(i,"buffer length must be a nonnegative integer"),i=0|e.length)),A.bind(),a?S(A,a,n,o,l,x):(t.bufferData(A.type,i,n),A.dtype=o||g,A.usage=n,A.dimension=l,A.byteLength=i),r.profile&&(A.stats.size=A.byteLength*y[A.dtype]),w}function M(e,r){s(r+e.byteLength<=A.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+r+" to a buffer of size "+A.byteLength),t.bufferSubData(A.type,r,e)}function D(t,e){var r=0|(e||0);if(A.bind(),Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var l=c.allocType(A.dtype,t.length);a(l,t),M(l,r),c.freeType(l)}else if(Array.isArray(t[0])||u(t[0])){var h=t[0].length,d=c.allocType(A.dtype,t.length*h);o(d,t,h),M(d,r),c.freeType(d)}else s.raise("invalid buffer data")}else if(u(t))M(t,r);else if(f(t)){var p=t.shape,m=t.stride,b=0,g=0,v=0,y=0;1===p.length?(b=p[0],g=1,v=m[0],y=0):2===p.length?(b=p[0],g=p[1],v=m[0],y=m[1]):s.raise("invalid shape");var x=Array.isArray(t.data)?A.dtype:n(t.data),S=c.allocType(x,b*g);i(S,t.data,b,g,v,y,t.offset),M(S,r),c.freeType(S)}else s.raise("invalid data for buffer subdata");return w}e.bufferCount++;var A=new h(b);return E[A.id]=A,v||w(l),w._reglType="buffer",w._buffer=A,w.subdata=D,r.profile&&(w.stats=A.stats),w.destroy=function(){_(A)},w}function A(){l(E).forEach(function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})}var I=0,E={};h.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},h.prototype.destroy=function(){_(this)};var F=[];return r.profile&&(e.getTotalBufferSize=function(){var t=0;return Object.keys(E).forEach(function(e){t+=E[e].stats.size}),t}),{create:D,createStream:x,destroyStream:w,clear:function(){l(E).forEach(_),F.forEach(_)},getBuffer:function(t){return t&&t._buffer instanceof h?t._buffer:null},restore:A,_initBuffer:S}}},{"./constants/arraytypes.json":49,"./constants/dtypes.json":50,"./constants/usage.json":52,"./util/check":66,"./util/is-ndarray":71,"./util/is-typed-array":72,"./util/pool":74,"./util/values":77}],49:[function(t,e,r){e.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],50:[function(t,e,r){e.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126}},{}],51:[function(t,e,r){e.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],52:[function(t,e,r){e.exports={static:35044,dynamic:35048,stream:35040}},{}],53:[function(t,e,r){function n(t){return Array.isArray(t)||h(t)||d(t)}function a(t){return t.sort(function(t,e){return t===K?-1:e===K?1:t<e?-1:1})}function i(t,e,r,n){this.thisDep=t,this.contextDep=e,this.propDep=r,this.append=n}function o(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function s(t){return new i(!1,!1,!1,t)}function u(t,e){var r=t.type;if(r===M){var n=t.data.length;return new i(!0,n>=1,n>=2,e)}if(r===A){var a=t.data;return new i(a.thisDep,a.contextDep,a.propDep,e)}return new i(r===D,r===_,r===S,e)}var f=t("./util/check"),l=t("./util/codegen"),c=t("./util/loop"),h=t("./util/is-typed-array"),d=t("./util/is-ndarray"),p=t("./util/is-array-like"),m=t("./dynamic"),b=t("./constants/primitives.json"),g=t("./constants/dtypes.json"),v="xyzw".split(""),y=5121,x=1,w=2,M=0,S=1,_=2,D=3,A=4,I="dither",E="blend.enable",F="blend.color",k="blend.equation",j="blend.func",T="depth.enable",R="depth.func",O="depth.range",z="depth.mask",L="colorMask",B="cull.enable",P="cull.face",C="frontFace",U="lineWidth",q="polygonOffset.enable",N="polygonOffset.offset",Y="sample.alpha",W="sample.enable",V="sample.coverage",H="stencil.enable",G="stencil.mask",Q="stencil.func",X="stencil.opFront",Z="stencil.opBack",$="scissor.enable",J="scissor.box",K="viewport",tt="profile",et="framebuffer",rt="vert",nt="frag",at="elements",it="primitive",ot="count",st="offset",ut="instances",ft="Width",lt="Height",ct=et+ft,ht=et+lt,dt=K+ft,pt=K+lt,mt="drawingBuffer",bt=mt+ft,gt=mt+lt,vt=[j,k,Q,X,Z,V,K,J,N],yt=34962,xt=34963,wt=35632,Mt=35633,St=3553,_t=34067,Dt=2884,At=3042,It=3024,Et=2960,Ft=2929,kt=3089,jt=32823,Tt=32926,Rt=32928,Ot=5126,zt=35664,Lt=35665,Bt=35666,Pt=5124,Ct=35667,Ut=35668,qt=35669,Nt=35670,Yt=35671,Wt=35672,Vt=35673,Ht=35674,Gt=35675,Qt=35676,Xt=35678,Zt=35680,$t=4,Jt=1028,Kt=1029,te=2304,ee=2305,re=32775,ne=32776,ae=519,ie=7680,oe=0,se=1,ue=32774,fe=513,le=36160,ce=36064,he={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},de=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],pe={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},me={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},be={frag:wt,vert:Mt},ge={cw:te,ccw:ee},ve=new i(!1,!1,!1,function(){});e.exports=function(t,e,r,h,d,ft,lt,mt,wt,Mt,ye,xe,we,Me,Se){function _e(t){return t.replace(".","_")}function De(t,e,r){var n=_e(t);fr.push(t),ur[n]=sr[n]=!!r,lr[n]=e}function Ae(t,e,r){var n=_e(t);fr.push(t),Array.isArray(r)?(sr[n]=r.slice(),ur[n]=r.slice()):sr[n]=ur[n]=r,cr[n]=e}function Ie(){var t=l(),r=t.link,n=t.global;t.id=pr++,t.batchId="0";var a=r(hr),i=t.shared={props:"a0"};Object.keys(hr).forEach(function(t){i[t]=n.def(a,".",t)}),f.optional(function(){t.CHECK=r(f),t.commandStr=f.guessCommand(),t.command=r(t.commandStr),t.assert=function(t,e,n){t("if(!(",e,"))",this.CHECK,".commandRaise(",r(n),",",this.command,");")},dr.invalidBlendCombinations=de});var o=t.next={},s=t.current={};Object.keys(cr).forEach(function(t){Array.isArray(sr[t])&&(o[t]=n.def(i.next,".",t),s[t]=n.def(i.current,".",t))});var u=t.constants={};Object.keys(dr).forEach(function(t){u[t]=n.def(JSON.stringify(dr[t]))}),t.invoke=function(e,n){switch(n.type){case M:var a=["this",i.context,i.props,t.batchId];return e.def(r(n.data),".call(",a.slice(0,Math.max(n.data.length+1,4)),")");case S:return e.def(i.props,n.data);case _:return e.def(i.context,n.data);case D:return e.def("this",n.data);case A:return n.data.append(t,e),n.data.ref}},t.attribCache={};var c={};return t.scopeAttrib=function(t){var n=e.id(t);if(n in c)return c[n];var a=Mt.scope[n];a||(a=Mt.scope[n]=new nr);var i=c[n]=r(a);return i},t}function Ee(t){var e,r=t.static,n=t.dynamic;if(tt in r){var a=!!r[tt];e=s(function(t,e){return a}),e.enable=a}else if(tt in n){var i=n[tt];e=u(i,function(t,e){return t.invoke(e,i)})}return e}function Fe(t,e){var r=t.static,n=t.dynamic;if(et in r){var a=r[et];return a?(a=mt.getFramebuffer(a),f.command(a,"invalid framebuffer object"),s(function(t,e){var r=t.link(a),n=t.shared;e.set(n.framebuffer,".next",r);var i=n.context;return e.set(i,"."+ct,r+".width"),e.set(i,"."+ht,r+".height"),r})):s(function(t,e){var r=t.shared;e.set(r.framebuffer,".next","null");var n=r.context;return e.set(n,"."+ct,n+"."+bt),e.set(n,"."+ht,n+"."+gt),"null"})}if(et in n){var i=n[et];return u(i,function(t,e){var r=t.invoke(e,i),n=t.shared,a=n.framebuffer,o=e.def(a,".getFramebuffer(",r,")");f.optional(function(){t.assert(e,"!"+r+"||"+o,"invalid framebuffer object")}),e.set(a,".next",o);var s=n.context;return e.set(s,"."+ct,o+"?"+o+".width:"+s+"."+bt),e.set(s,"."+ht,o+"?"+o+".height:"+s+"."+gt),o})}return null}function ke(t,e,r){function n(t){if(t in a){var n=a[t];f.commandType(n,"object","invalid "+t,r.commandStr);var s=!0,l=0|n.x,c=0|n.y;f.command(l>=0&&c>=0,"invalid "+t,r.commandStr);var h,d;return"width"in n?(h=0|n.width,f.command(h>0,"invalid "+t,r.commandStr)):s=!1,"height"in n?(d=0|n.height,f.command(d>0,"invalid "+t,r.commandStr)):s=!1,new i(!s&&e&&e.thisDep,!s&&e&&e.contextDep,!s&&e&&e.propDep,function(e,r){var a=e.shared.context,i=h;"width"in n?f.command(h>0,"invalid "+t,e.commandStr):i=r.def(a,".",ct,"-",l);var o=d;return"height"in n?f.command(d>0,"invalid "+t,e.commandStr):o=r.def(a,".",ht,"-",c),[l,c,i,o]})}if(t in o){var p=o[t],m=u(p,function(e,r){var n=e.invoke(r,p);f.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)});var a=e.shared.context,i=r.def(n,".x|0"),o=r.def(n,".y|0"),s=r.def('"width" in ',n,"?",n,".width|0:","(",a,".",ct,"-",i,")"),u=r.def('"height" in ',n,"?",n,".height|0:","(",a,".",ht,"-",o,")");return f.optional(function(){e.assert(r,i+">=0&&"+o+">=0&&"+s+">0&&"+u+">0","invalid "+t)}),[i,o,s,u]});return e&&(m.thisDep=m.thisDep||e.thisDep,m.contextDep=m.contextDep||e.contextDep,m.propDep=m.propDep||e.propDep),m}return e?new i(e.thisDep,e.contextDep,e.propDep,function(t,e){var r=t.shared.context;return[0,0,e.def(r,".",ct),e.def(r,".",ht)]}):null}var a=t.static,o=t.dynamic,s=n(K);if(s){var l=s;s=new i(s.thisDep,s.contextDep,s.propDep,function(t,e){var r=l.append(t,e),n=t.shared.context;return e.set(n,"."+dt,r[2]),e.set(n,"."+pt,r[3]),r})}return{viewport:s,scissor_box:n(J)}}function je(t){function r(t){if(t in a){var r=e.id(a[t]);f.optional(function(){ye.shader(be[t],r,f.guessCommand())});var n=s(function(){return r});return n.id=r,n}if(t in l){var i=l[t];return u(i,function(e,r){var n=e.invoke(r,i),a=r.def(e.shared.strings,".id(",n,")");return f.optional(function(){r(e.shared.shader,".shader(",be[t],",",a,",",e.command,");")}),a})}return null}var n,a=t.static,l=t.dynamic,c=r(nt),h=r(rt),d=null;return o(c)&&o(h)?(d=ye.program(h.id,c.id),n=s(function(t,e){return t.link(d)})):n=new i(c&&c.thisDep||h&&h.thisDep,c&&c.contextDep||h&&h.contextDep,c&&c.propDep||h&&h.propDep,function(t,e){var r,n=t.shared.shader;r=c?c.append(t,e):e.def(n,".",nt);var a;a=h?h.append(t,e):e.def(n,".",rt);var i=n+".program("+a+","+r;return f.optional(function(){i+=","+t.command}),e.def(i+")")}),{frag:c,vert:h,progVar:n,program:d}}function Te(t,e){function r(){if(at in h){var t=h[at];n(t)?t=ft.getElements(ft.create(t,!0)):t&&(t=ft.getElements(t),f.command(t,"invalid elements",e.commandStr));var r=s(function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n,n}return e.ELEMENTS=null,null});return r.value=t,r}if(at in d){var a=d[at];return u(a,function(t,e){var r=t.shared,n=r.isBufferArgs,i=r.elements,o=t.invoke(e,a),s=e.def("null"),u=e.def(n,"(",o,")"),l=t.cond(u).then(s,"=",i,".createStream(",o,");").else(s,"=",i,".getElements(",o,");");return f.optional(function(){t.assert(l.else,"!"+o+"||"+s,"invalid elements")}),e.entry(l),e.exit(t.cond(u).then(i,".destroyStream(",s,");")),t.ELEMENTS=s,s})}return null}function a(){if(it in h){var t=h[it];return f.commandParameter(t,b,"invalid primitve",e.commandStr),s(function(e,r){return b[t]})}if(it in d){var r=d[it];return u(r,function(t,e){var n=t.constants.primTypes,a=t.invoke(e,r);return f.optional(function(){t.assert(e,a+" in "+n,"invalid primitive, must be one of "+Object.keys(b))}),e.def(n,"[",a,"]")})}return p?o(p)?s(p.value?function(t,e){return e.def(t.ELEMENTS,".primType")}:function(){return $t}):new i(p.thisDep,p.contextDep,p.propDep,function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",$t)}):null}function l(t,r){if(t in h){var n=0|h[t];return f.command(!r||n>=0,"invalid "+t,e.commandStr),s(function(t,e){return r&&(t.OFFSET=n),n})}if(t in d){var a=d[t];return u(a,function(e,n){var i=e.invoke(n,a);return r&&(e.OFFSET=i,f.optional(function(){e.assert(n,i+">=0","invalid "+t)})),i})}return r&&p?s(function(t,e){return t.OFFSET="0",0}):null}function c(){if(ot in h){var t=0|h[ot];return f.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),s(function(){return t})}if(ot in d){var r=d[ot];return u(r,function(t,e){var n=t.invoke(e,r);return f.optional(function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")}),n})}if(p){if(o(p)){if(p)return m?new i(m.thisDep,m.contextDep,m.propDep,function(t,e){var r=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return f.optional(function(){t.assert(e,r+">=0","invalid vertex offset/element buffer too small")}),r}):s(function(t,e){return e.def(t.ELEMENTS,".vertCount")});var n=s(function(){return-1});return f.optional(function(){n.MISSING=!0}),n}var a=new i(p.thisDep||m.thisDep,p.contextDep||m.contextDep,p.propDep||m.propDep,function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")});return f.optional(function(){a.DYNAMIC=!0}),a}return null}var h=t.static,d=t.dynamic,p=r(),m=l(st,!0);return{elements:p,primitive:a(),count:c(),instances:l(ut,!1),offset:m}}function Re(t,e){var r=t.static,n=t.dynamic,a={};return fr.forEach(function(t){function i(e,i){if(t in r){var f=e(r[t]);a[o]=s(function(){return f})}else if(t in n){var l=n[t];a[o]=u(l,function(t,e){return i(t,e,t.invoke(e,l))})}}var o=_e(t);switch(t){case B:case E:case I:case H:case T:case $:case q:case Y:case W:case z:return i(function(r){return f.commandType(r,"boolean",t,e.commandStr),r},function(e,r,n){return f.optional(function(){e.assert(r,"typeof "+n+'==="boolean"',"invalid flag "+t,e.commandStr)}),n});case R:return i(function(r){return f.commandParameter(r,pe,"invalid "+t,e.commandStr),pe[r]},function(e,r,n){var a=e.constants.compareFuncs;return f.optional(function(){e.assert(r,n+" in "+a,"invalid "+t+", must be one of "+Object.keys(pe))}),r.def(a,"[",n,"]")});case O:return i(function(t){return f.command(p(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t},function(t,e,r){f.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")});var n=e.def("+",r,"[0]"),a=e.def("+",r,"[1]");return[n,a]});case j:return i(function(t){f.commandType(t,"object","blend.func",e.commandStr);var r="srcRGB"in t?t.srcRGB:t.src,n="srcAlpha"in t?t.srcAlpha:t.src,a="dstRGB"in t?t.dstRGB:t.dst,i="dstAlpha"in t?t.dstAlpha:t.dst;return f.commandParameter(r,he,o+".srcRGB",e.commandStr),f.commandParameter(n,he,o+".srcAlpha",e.commandStr),f.commandParameter(a,he,o+".dstRGB",e.commandStr),f.commandParameter(i,he,o+".dstAlpha",e.commandStr),f.command(de.indexOf(r+", "+a)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+r+", "+a+")",e.commandStr),[he[r],he[a],he[n],he[i]]},function(e,r,n){function a(a,o){var s=r.def('"',a,o,'" in ',n,"?",n,".",a,o,":",n,".",a);return f.optional(function(){e.assert(r,s+" in "+i,"invalid "+t+"."+a+o+", must be one of "+Object.keys(he))}),s}var i=e.constants.blendFuncs;f.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid blend func, must be an object")});var o=a("src","RGB"),s=a("dst","RGB");f.optional(function(){var t=e.constants.invalidBlendCombinations;e.assert(r,t+".indexOf("+o+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var u=r.def(i,"[",o,"]"),l=r.def(i,"[",a("src","Alpha"),"]"),c=r.def(i,"[",s,"]"),h=r.def(i,"[",a("dst","Alpha"),"]");return[u,c,l,h]});case k:return i(function(r){return"string"==typeof r?(f.commandParameter(r,ar,"invalid "+t,e.commandStr),[ar[r],ar[r]]):"object"==typeof r?(f.commandParameter(r.rgb,ar,t+".rgb",e.commandStr),f.commandParameter(r.alpha,ar,t+".alpha",e.commandStr),[ar[r.rgb],ar[r.alpha]]):void f.commandRaise("invalid blend.equation",e.commandStr)},function(e,r,n){var a=e.constants.blendEquations,i=r.def(),o=r.def(),s=e.cond("typeof ",n,'==="string"');return f.optional(function(){function r(t,r,n){e.assert(t,n+" in "+a,"invalid "+r+", must be one of "+Object.keys(ar))}r(s.then,t,n),e.assert(s.else,n+"&&typeof "+n+'==="object"',"invalid "+t),r(s.else,t+".rgb",n+".rgb"),r(s.else,t+".alpha",n+".alpha")}),s.then(i,"=",o,"=",a,"[",n,"];"),s.else(i,"=",a,"[",n,".rgb];",o,"=",a,"[",n,".alpha];"),r(s),[i,o]});case F:return i(function(t){return f.command(p(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),c(4,function(e){return+t[e]})},function(t,e,r){return f.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")}),c(4,function(t){return e.def("+",r,"[",t,"]")})});case G:return i(function(t){return f.commandType(t,"number",o,e.commandStr),0|t},function(t,e,r){return f.optional(function(){t.assert(e,"typeof "+r+'==="number"',"invalid stencil.mask")}),e.def(r,"|0")});case Q:return i(function(r){f.commandType(r,"object",o,e.commandStr);var n=r.cmp||"keep",a=r.ref||0,i="mask"in r?r.mask:-1;return f.commandParameter(n,pe,t+".cmp",e.commandStr),f.commandType(a,"number",t+".ref",e.commandStr),f.commandType(i,"number",t+".mask",e.commandStr),[pe[n],a,i]},function(t,e,r){var n=t.constants.compareFuncs;f.optional(function(){function a(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}a(r+"&&typeof ",r,'==="object"'),a('!("cmp" in ',r,")||(",r,".cmp in ",n,")")});var a=e.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",ie),i=e.def(r,".ref|0"),o=e.def('"mask" in ',r,"?",r,".mask|0:-1");return[a,i,o]});case X:case Z:return i(function(r){f.commandType(r,"object",o,e.commandStr);var n=r.fail||"keep",a=r.zfail||"keep",i=r.zpass||"keep";return f.commandParameter(n,me,t+".fail",e.commandStr),f.commandParameter(a,me,t+".zfail",e.commandStr),f.commandParameter(i,me,t+".zpass",e.commandStr),[t===Z?Kt:Jt,me[n],me[a],me[i]]},function(e,r,n){function a(a){return f.optional(function(){e.assert(r,'!("'+a+'" in '+n+")||("+n+"."+a+" in "+i+")","invalid "+t+"."+a+", must be one of "+Object.keys(me))}),r.def('"',a,'" in ',n,"?",i,"[",n,".",a,"]:",ie)}var i=e.constants.stencilOps;return f.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)}),[t===Z?Kt:Jt,a("fail"),a("zfail"),a("zpass")]});case N:return i(function(t){f.commandType(t,"object",o,e.commandStr);var r=0|t.factor,n=0|t.units;return f.commandType(r,"number",o+".factor",e.commandStr),f.commandType(n,"number",o+".units",e.commandStr),[r,n]},function(e,r,n){f.optional(function(){e.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+t)});var a=r.def(n,".factor|0"),i=r.def(n,".units|0");return[a,i]});case P:return i(function(t){var r=0;return"front"===t?r=Jt:"back"===t&&(r=Kt),f.command(!!r,o,e.commandStr),r},function(t,e,r){return f.optional(function(){t.assert(e,r+'==="front"||'+r+'==="back"',"invalid cull.face");
}),e.def(r,'==="front"?',Jt,":",Kt)});case U:return i(function(t){return f.command("number"==typeof t&&t>=h.lineWidthDims[0]&&t<=h.lineWidthDims[1],"invalid line width, must positive number between "+h.lineWidthDims[0]+" and "+h.lineWidthDims[1],e.commandStr),t},function(t,e,r){return f.optional(function(){t.assert(e,"typeof "+r+'==="number"&&'+r+">="+h.lineWidthDims[0]+"&&"+r+"<="+h.lineWidthDims[1],"invalid line width")}),r});case C:return i(function(t){return f.commandParameter(t,ge,o,e.commandStr),ge[t]},function(t,e,r){return f.optional(function(){t.assert(e,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),e.def(r+'==="cw"?'+te+":"+ee)});case L:return i(function(t){return f.command(p(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map(function(t){return!!t})},function(t,e,r){return f.optional(function(){t.assert(e,t.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")}),c(4,function(t){return"!!"+r+"["+t+"]"})});case V:return i(function(t){f.command("object"==typeof t&&t,o,e.commandStr);var r="value"in t?t.value:1,n=!!t.invert;return f.command("number"==typeof r&&r>=0&&r<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[r,n]},function(t,e,r){f.optional(function(){t.assert(e,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")});var n=e.def('"value" in ',r,"?+",r,".value:1"),a=e.def("!!",r,".invert");return[n,a]})}}),a}function Oe(t,e){var r=t.static,n=t.dynamic,a={};return Object.keys(r).forEach(function(t){var n,i=r[t];if("number"==typeof i||"boolean"==typeof i)n=s(function(){return i});else if("function"==typeof i){var o=i._reglType;"texture2d"===o||"textureCube"===o?n=s(function(t){return t.link(i)}):"framebuffer"===o||"framebufferCube"===o?(f.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),n=s(function(t){return t.link(i.color[0])})):f.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else p(i)?n=s(function(e){var r=e.global.def("[",c(i.length,function(r){return f.command("number"==typeof i[r]||"boolean"==typeof i[r],"invalid uniform "+t,e.commandStr),i[r]}),"]");return r}):f.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);n.value=i,a[t]=n}),Object.keys(n).forEach(function(t){var e=n[t];a[t]=u(e,function(t,r){return t.invoke(r,e)})}),a}function ze(t,r){var a=t.static,i=t.dynamic,o={};return Object.keys(a).forEach(function(t){var i=a[t],u=e.id(t),l=new nr;if(n(i))l.state=x,l.buffer=d.getBuffer(d.create(i,yt,!1,!0)),l.type=0;else{var c=d.getBuffer(i);if(c)l.state=x,l.buffer=c,l.type=0;else if(f.command("object"==typeof i&&i,"invalid data for attribute "+t,r.commandStr),i.constant){var h=i.constant;l.buffer="null",l.state=w,"number"==typeof h?l.x=h:(f.command(p(h)&&h.length>0&&h.length<=4,"invalid constant for attribute "+t,r.commandStr),v.forEach(function(t,e){e<h.length&&(l[t]=h[e])}))}else{c=n(i.buffer)?d.getBuffer(d.create(i.buffer,yt,!1,!0)):d.getBuffer(i.buffer),f.command(!!c,'missing buffer for attribute "'+t+'"',r.commandStr);var m=0|i.offset;f.command(m>=0,'invalid offset for attribute "'+t+'"',r.commandStr);var b=0|i.stride;f.command(b>=0&&b<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',r.commandStr);var y=0|i.size;f.command(!("size"in i)||y>0&&y<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',r.commandStr);var M=!!i.normalized,S=0;"type"in i&&(f.commandParameter(i.type,g,"invalid type for attribute "+t,r.commandStr),S=g[i.type]);var _=0|i.divisor;"divisor"in i&&(f.command(0===_||ir,'cannot specify divisor for attribute "'+t+'", instancing not supported',r.commandStr),f.command(_>=0,'invalid divisor for attribute "'+t+'"',r.commandStr)),f.optional(function(){var e=r.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach(function(r){f.command(n.indexOf(r)>=0,'unknown parameter "'+r+'" for attribute pointer "'+t+'" (valid parameters are '+n+")",e)})}),l.buffer=c,l.state=x,l.size=y,l.normalized=M,l.type=S||c.dtype,l.offset=m,l.stride=b,l.divisor=_}}o[t]=s(function(t,e){var r=t.attribCache;if(u in r)return r[u];var n={isStream:!1};return Object.keys(l).forEach(function(t){n[t]=l[t]}),l.buffer&&(n.buffer=t.link(l.buffer),n.type=n.type||n.buffer+".dtype"),r[u]=n,n})}),Object.keys(i).forEach(function(t){function e(e,n){function a(t){n(l[t],"=",i,".",t,"|0;")}var i=e.invoke(n,r),o=e.shared,s=o.isBufferArgs,u=o.buffer;f.optional(function(){e.assert(n,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')});var l={isStream:n.def(!1)},c=new nr;c.state=x,Object.keys(c).forEach(function(t){l[t]=n.def(""+c[t])});var h=l.buffer,d=l.type;return n("if(",s,"(",i,")){",l.isStream,"=true;",h,"=",u,".createStream(",yt,",",i,");",d,"=",h,".dtype;","}else{",h,"=",u,".getBuffer(",i,");","if(",h,"){",d,"=",h,".dtype;",'}else if("constant" in ',i,"){",l.state,"=",w,";","if(typeof "+i+'.constant === "number"){',l[v[0]],"=",i,".constant;",v.slice(1).map(function(t){return l[t]}).join("="),"=0;","}else{",v.map(function(t,e){return l[t]+"="+i+".constant.length>="+e+"?"+i+".constant["+e+"]:0;"}).join(""),"}}else{","if(",s,"(",i,".buffer)){",h,"=",u,".createStream(",yt,",",i,".buffer);","}else{",h,"=",u,".getBuffer(",i,".buffer);","}",d,'="type" in ',i,"?",o.glTypes,"[",i,".type]:",h,".dtype;",l.normalized,"=!!",i,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),n("}}"),n.exit("if(",l.isStream,"){",u,".destroyStream(",h,");","}"),l}var r=i[t];o[t]=u(r,e)}),o}function Le(t){var e=t.static,r=t.dynamic,n={};return Object.keys(e).forEach(function(t){var r=e[t];n[t]=s(function(t,e){return"number"==typeof r||"boolean"==typeof r?""+r:t.link(r)})}),Object.keys(r).forEach(function(t){var e=r[t];n[t]=u(e,function(t,r){return t.invoke(r,e)})}),n}function Be(t,e,r,n,a){function i(t){var e=l[t];e&&(h[t]=e)}var o=t.static,s=t.dynamic;f.optional(function(){function t(t){Object.keys(t).forEach(function(t){f.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',a.commandStr)})}var e=[et,rt,nt,at,it,st,ot,ut,tt].concat(fr);t(o),t(s)});var u=Fe(t,a),l=ke(t,u,a),c=Te(t,a),h=Re(t,a),d=je(t,a);i(K),i(_e(J));var p=Object.keys(h).length>0,m={framebuffer:u,draw:c,shader:d,state:h,dirty:p};return m.profile=Ee(t,a),m.uniforms=Oe(r,a),m.attributes=ze(e,a),m.context=Le(n,a),m}function Pe(t,e,r){var n=t.shared,a=n.context,i=t.scope();Object.keys(r).forEach(function(n){e.save(a,"."+n);var o=r[n];i(a,".",n,"=",o.append(t,e),";")}),e(i)}function Ce(t,e,r,n){var a,i=t.shared,o=i.gl,s=i.framebuffer;or&&(a=e.def(i.extensions,".webgl_draw_buffers"));var u,f=t.constants,l=f.drawBuffer,c=f.backBuffer;u=r?r.append(t,e):e.def(s,".next"),n||e("if(",u,"!==",s,".cur){"),e("if(",u,"){",o,".bindFramebuffer(",le,",",u,".framebuffer);"),or&&e(a,".drawBuffersWEBGL(",l,"[",u,".colorAttachments.length]);"),e("}else{",o,".bindFramebuffer(",le,",null);"),or&&e(a,".drawBuffersWEBGL(",c,");"),e("}",s,".cur=",u,";"),n||e("}")}function Ue(t,e,r){var n=t.shared,a=n.gl,i=t.current,o=t.next,s=n.current,u=n.next,f=t.cond(s,".dirty");fr.forEach(function(e){var n=_e(e);if(!(n in r.state)){var l,h;if(n in o){l=o[n],h=i[n];var d=c(sr[n].length,function(t){return f.def(l,"[",t,"]")});f(t.cond(d.map(function(t,e){return t+"!=="+h+"["+e+"]"}).join("||")).then(a,".",cr[n],"(",d,");",d.map(function(t,e){return h+"["+e+"]="+t}).join(";"),";"))}else{l=f.def(u,".",n);var p=t.cond(l,"!==",s,".",n);f(p),n in lr?p(t.cond(l).then(a,".enable(",lr[n],");").else(a,".disable(",lr[n],");"),s,".",n,"=",l,";"):p(a,".",cr[n],"(",l,");",s,".",n,"=",l,";")}}}),0===Object.keys(r.state).length&&f(s,".dirty=false;"),e(f)}function qe(t,e,r,n){var i=t.shared,s=t.current,u=i.current,f=i.gl;a(Object.keys(r)).forEach(function(a){var i=r[a];if(!n||n(i)){var l=i.append(t,e);if(lr[a]){var c=lr[a];o(i)?l?e(f,".enable(",c,");"):e(f,".disable(",c,");"):e(t.cond(l).then(f,".enable(",c,");").else(f,".disable(",c,");")),e(u,".",a,"=",l,";")}else if(p(l)){var h=s[a];e(f,".",cr[a],"(",l,");",l.map(function(t,e){return h+"["+e+"]="+t}).join(";"),";")}else e(f,".",cr[a],"(",l,");",u,".",a,"=",l,";")}})}function Ne(t,e){ir&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function Ye(t,e,r,n,a){function i(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function s(t){l=e.def(),t(l,"=",i(),";"),"string"==typeof a?t(p,".count+=",a,";"):t(p,".count++;"),Me&&(n?(c=e.def(),t(c,"=",b,".getNumPendingQueries();")):t(b,".beginQuery(",p,");"))}function u(t){t(p,".cpuTime+=",i(),"-",l,";"),Me&&(n?t(b,".pushScopeStats(",c,",",b,".getNumPendingQueries(),",p,");"):t(b,".endQuery();"))}function f(t){var r=e.def(m,".profile");e(m,".profile=",t,";"),e.exit(m,".profile=",r,";")}var l,c,h,d=t.shared,p=t.stats,m=d.current,b=d.timer,g=r.profile;if(g){if(o(g))return void(g.enable?(s(e),u(e.exit),f("true")):f("false"));h=g.append(t,e),f(h)}else h=e.def(m,".profile");var v=t.block();s(v),e("if(",h,"){",v,"}");var y=t.block();u(y),e.exit("if(",h,"){",y,"}")}function We(t,e,r,n,a){function i(t){switch(t){case zt:case Ct:case Yt:return 2;case Lt:case Ut:case Wt:return 3;case Bt:case qt:case Vt:return 4;default:return 1}}function o(r,n,a){function i(){e("if(!",l,".buffer){",u,".enableVertexAttribArray(",f,");}");var r,i=a.type;if(r=a.size?e.def(a.size,"||",n):n,e("if(",l,".type!==",i,"||",l,".size!==",r,"||",p.map(function(t){return l+"."+t+"!=="+a[t]}).join("||"),"){",u,".bindBuffer(",yt,",",h,".buffer);",u,".vertexAttribPointer(",[f,r,i,a.normalized,a.stride,a.offset],");",l,".type=",i,";",l,".size=",r,";",p.map(function(t){return l+"."+t+"="+a[t]+";"}).join(""),"}"),ir){var o=a.divisor;e("if(",l,".divisor!==",o,"){",t.instancing,".vertexAttribDivisorANGLE(",[f,o],");",l,".divisor=",o,";}")}}function o(){e("if(",l,".buffer){",u,".disableVertexAttribArray(",f,");","}if(",v.map(function(t,e){return l+"."+t+"!=="+d[e]}).join("||"),"){",u,".vertexAttrib4f(",f,",",d,");",v.map(function(t,e){return l+"."+t+"="+d[e]+";"}).join(""),"}")}var u=s.gl,f=e.def(r,".location"),l=e.def(s.attributes,"[",f,"]"),c=a.state,h=a.buffer,d=[a.x,a.y,a.z,a.w],p=["buffer","normalized","offset","stride"];c===x?i():c===w?o():(e("if(",c,"===",x,"){"),i(),e("}else{"),o(),e("}"))}var s=t.shared;n.forEach(function(n){var s,u=n.name,l=r.attributes[u];if(l){if(!a(l))return;s=l.append(t,e)}else{if(!a(ve))return;var c=t.scopeAttrib(u);f.optional(function(){t.assert(e,c+".state","missing attribute "+u)}),s={},Object.keys(new nr).forEach(function(t){s[t]=e.def(c,".",t)})}o(t.link(n),i(n.info.type),s)})}function Ve(t,r,n,a,i){for(var s,u=t.shared,l=u.gl,h=0;h<a.length;++h){var d,m=a[h],b=m.name,g=m.info.type,v=n.uniforms[b],y=t.link(m),x=y+".location";if(v){if(!i(v))continue;if(o(v)){var w=v.value;if(f.command(null!==w&&"undefined"!=typeof w,'missing uniform "'+b+'"',t.commandStr),g===Xt||g===Zt){f.command("function"==typeof w&&(g===Xt&&("texture2d"===w._reglType||"framebuffer"===w._reglType)||g===Zt&&("textureCube"===w._reglType||"framebufferCube"===w._reglType)),"invalid texture for uniform "+b,t.commandStr);var M=t.link(w._texture||w.color[0]._texture);r(l,".uniform1i(",x,",",M+".bind());"),r.exit(M,".unbind();")}else if(g===Ht||g===Gt||g===Qt){f.optional(function(){f.command(p(w),"invalid matrix for uniform "+b,t.commandStr),f.command(g===Ht&&4===w.length||g===Gt&&9===w.length||g===Qt&&16===w.length,"invalid length for matrix uniform "+b,t.commandStr)});var S=t.global.def("new Float32Array(["+Array.prototype.slice.call(w)+"])"),_=2;g===Gt?_=3:g===Qt&&(_=4),r(l,".uniformMatrix",_,"fv(",x,",false,",S,");")}else{switch(g){case Ot:f.commandType(w,"number","uniform "+b,t.commandStr),s="1f";break;case zt:f.command(p(w)&&2===w.length,"uniform "+b,t.commandStr),s="2f";break;case Lt:f.command(p(w)&&3===w.length,"uniform "+b,t.commandStr),s="3f";break;case Bt:f.command(p(w)&&4===w.length,"uniform "+b,t.commandStr),s="4f";break;case Nt:f.commandType(w,"boolean","uniform "+b,t.commandStr),s="1i";break;case Pt:f.commandType(w,"number","uniform "+b,t.commandStr),s="1i";break;case Yt:f.command(p(w)&&2===w.length,"uniform "+b,t.commandStr),s="2i";break;case Ct:f.command(p(w)&&2===w.length,"uniform "+b,t.commandStr),s="2i";break;case Wt:f.command(p(w)&&3===w.length,"uniform "+b,t.commandStr),s="3i";break;case Ut:f.command(p(w)&&3===w.length,"uniform "+b,t.commandStr),s="3i";break;case Vt:f.command(p(w)&&4===w.length,"uniform "+b,t.commandStr),s="4i";break;case qt:f.command(p(w)&&4===w.length,"uniform "+b,t.commandStr),s="4i"}r(l,".uniform",s,"(",x,",",p(w)?Array.prototype.slice.call(w):w,");")}continue}d=v.append(t,r)}else{if(!i(ve))continue;d=r.def(u.uniforms,"[",e.id(b),"]")}g===Xt?r("if(",d,"&&",d,'._reglType==="framebuffer"){',d,"=",d,".color[0];","}"):g===Zt&&r("if(",d,"&&",d,'._reglType==="framebufferCube"){',d,"=",d,".color[0];","}"),f.optional(function(){function e(e,n){t.assert(r,e,'bad data or missing for uniform "'+b+'".  '+n)}function n(t){e("typeof "+d+'==="'+t+'"',"invalid type, expected "+t)}function a(r,n){e(u.isArrayLike+"("+d+")&&"+d+".length==="+r,"invalid vector, should have length "+r,t.commandStr)}function i(r){e("typeof "+d+'==="function"&&'+d+'._reglType==="texture'+(r===St?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(g){case Pt:n("number");break;case Ct:a(2,"number");break;case Ut:a(3,"number");break;case qt:a(4,"number");break;case Ot:n("number");break;case zt:a(2,"number");break;case Lt:a(3,"number");break;case Bt:a(4,"number");break;case Nt:n("boolean");break;case Yt:a(2,"boolean");break;case Wt:a(3,"boolean");break;case Vt:a(4,"boolean");break;case Ht:a(4,"number");break;case Gt:a(9,"number");break;case Qt:a(16,"number");break;case Xt:i(St);break;case Zt:i(_t)}});var D=1;switch(g){case Xt:case Zt:var A=r.def(d,"._texture");r(l,".uniform1i(",x,",",A,".bind());"),r.exit(A,".unbind();");continue;case Pt:case Nt:s="1i";break;case Ct:case Yt:s="2i",D=2;break;case Ut:case Wt:s="3i",D=3;break;case qt:case Vt:s="4i",D=4;break;case Ot:s="1f";break;case zt:s="2f",D=2;break;case Lt:s="3f",D=3;break;case Bt:s="4f",D=4;break;case Ht:s="Matrix2fv";break;case Gt:s="Matrix3fv";break;case Qt:s="Matrix4fv"}if(r(l,".uniform",s,"(",x,","),"M"===s.charAt(0)){var I=Math.pow(g-Ht+2,2),E=t.global.def("new Float32Array(",I,")");r("false,(Array.isArray(",d,")||",d," instanceof Float32Array)?",d,":(",c(I,function(t){return E+"["+t+"]="+d+"["+t+"]"}),",",E,")")}else r(D>1?c(D,function(t){return d+"["+t+"]"}):d);r(");")}}function He(t,e,r,n){function a(){var a,i=p.elements,o=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(o=r),a=i.append(t,o)):a=o.def(d,".",at),a&&o("if("+a+")"+h+".bindBuffer("+xt+","+a+".buffer.buffer);"),a}function i(){var a,i=p.count,o=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(o=r),a=i.append(t,o),f.optional(function(){i.MISSING&&t.assert(e,"false","missing vertex count"),i.DYNAMIC&&t.assert(o,a+">=0","missing vertex count")})):(a=o.def(d,".",ot),f.optional(function(){t.assert(o,a+">=0","missing vertex count")})),a}function s(a){var i=p[a];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(t,r):i.append(t,e):e.def(d,".",a)}function u(){function t(){r(w,".drawElementsInstancedANGLE(",[b,v,M,g+"<<(("+M+"-"+y+")>>1)",x],");")}function e(){r(w,".drawArraysInstancedANGLE(",[b,g,v,x],");")}m?S?t():(r("if(",m,"){"),t(),r("}else{"),e(),r("}")):e()}function l(){function t(){r(h+".drawElements("+[b,v,M,g+"<<(("+M+"-"+y+")>>1)"]+");")}function e(){r(h+".drawArrays("+[b,g,v]+");")}m?S?t():(r("if(",m,"){"),t(),r("}else{"),e(),r("}")):e()}var c=t.shared,h=c.gl,d=c.draw,p=n.draw,m=a(),b=s(it),g=s(st),v=i();if("number"==typeof v){if(0===v)return}else r("if(",v,"){"),r.exit("}");var x,w;ir&&(x=s(ut),w=t.instancing);var M=m+".type",S=p.elements&&o(p.elements);ir&&("number"!=typeof x||x>=0)?"string"==typeof x?(r("if(",x,">0){"),u(),r("}else if(",x,"<0){"),l(),r("}")):u():l()}function Ge(t,e,r,n,a){var i=Ie(),o=i.proc("body",a);return f.optional(function(){i.commandStr=e.commandStr,i.command=i.link(e.commandStr)}),ir&&(i.instancing=o.def(i.shared.extensions,".angle_instanced_arrays")),t(i,o,r,n),i.compile().body}function Qe(t,e,r,n){Ne(t,e),We(t,e,r,n.attributes,function(){return!0}),Ve(t,e,r,n.uniforms,function(){return!0}),He(t,e,e,r)}function Xe(t,e){var r=t.proc("draw",1);Ne(t,r),Pe(t,r,e.context),Ce(t,r,e.framebuffer),Ue(t,r,e),qe(t,r,e.state),Ye(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",n,".program);"),e.shader.program)Qe(t,r,e,e.shader.program);else{var a=t.global.def("{}"),i=r.def(n,".id"),o=r.def(a,"[",i,"]");r(t.cond(o).then(o,".call(this,a0);").else(o,"=",a,"[",i,"]=",t.link(function(r){return Ge(Qe,t,e,r,1)}),"(",n,");",o,".call(this,a0);"))}Object.keys(e.state).length>0&&r(t.shared.current,".dirty=true;")}function Ze(t,e,r,n){function a(){return!0}t.batchId="a1",Ne(t,e),We(t,e,r,n.attributes,a),Ve(t,e,r,n.uniforms,a),He(t,e,e,r)}function $e(t,e,r,n){function a(t){return t.contextDep&&o||t.propDep}function i(t){return!a(t)}Ne(t,e);var o=r.contextDep,s=e.def(),u="a0",f="a1",l=e.def();t.shared.props=l,t.batchId=s;var c=t.scope(),h=t.scope();if(e(c.entry,"for(",s,"=0;",s,"<",f,";++",s,"){",l,"=",u,"[",s,"];",h,"}",c.exit),r.needsContext&&Pe(t,h,r.context),r.needsFramebuffer&&Ce(t,h,r.framebuffer),qe(t,h,r.state,a),r.profile&&a(r.profile)&&Ye(t,h,r,!1,!0),n)We(t,c,r,n.attributes,i),We(t,h,r,n.attributes,a),Ve(t,c,r,n.uniforms,i),Ve(t,h,r,n.uniforms,a),He(t,c,h,r);else{var d=t.global.def("{}"),p=r.shader.progVar.append(t,h),m=h.def(p,".id"),b=h.def(d,"[",m,"]");h(t.shared.gl,".useProgram(",p,".program);","if(!",b,"){",b,"=",d,"[",m,"]=",t.link(function(e){return Ge(Ze,t,r,e,2)}),"(",p,");}",b,".call(this,a0[",s,"],",s,");")}}function Je(t,e){function r(t){return t.contextDep&&a||t.propDep}var n=t.proc("batch",2);t.batchId="0",Ne(t,n);var a=!1,i=!0;Object.keys(e.context).forEach(function(t){a=a||e.context[t].propDep}),a||(Pe(t,n,e.context),i=!1);var o=e.framebuffer,s=!1;o?(o.propDep?a=s=!0:o.contextDep&&a&&(s=!0),s||Ce(t,n,o)):Ce(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(a=!0),Ue(t,n,e),qe(t,n,e.state,function(t){return!r(t)}),e.profile&&r(e.profile)||Ye(t,n,e,!1,"a1"),e.contextDep=a,e.needsContext=i,e.needsFramebuffer=s;var u=e.shader.progVar;if(u.contextDep&&a||u.propDep)$e(t,n,e,null);else{var f=u.append(t,n);if(n(t.shared.gl,".useProgram(",f,".program);"),e.shader.program)$e(t,n,e,e.shader.program);else{var l=t.global.def("{}"),c=n.def(f,".id"),h=n.def(l,"[",c,"]");n(t.cond(h).then(h,".call(this,a0,a1);").else(h,"=",l,"[",c,"]=",t.link(function(r){return Ge($e,t,e,r,2)}),"(",f,");",h,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function Ke(t,r){function n(e){var n=r.shader[e];n&&i.set(o.shader,"."+e,n.append(t,i))}var i=t.proc("scope",3);t.batchId="a2";var o=t.shared,s=o.current;Pe(t,i,r.context),r.framebuffer&&r.framebuffer.append(t,i),a(Object.keys(r.state)).forEach(function(e){var n=r.state[e],a=n.append(t,i);p(a)?a.forEach(function(r,n){i.set(t.next[e],"["+n+"]",r)}):i.set(o.next,"."+e,a)}),Ye(t,i,r,!0,!0),[at,st,ot,ut,it].forEach(function(e){var n=r.draw[e];n&&i.set(o.draw,"."+e,""+n.append(t,i))}),Object.keys(r.uniforms).forEach(function(n){i.set(o.uniforms,"["+e.id(n)+"]",r.uniforms[n].append(t,i))}),Object.keys(r.attributes).forEach(function(e){var n=r.attributes[e].append(t,i),a=t.scopeAttrib(e);Object.keys(new nr).forEach(function(t){i.set(a,"."+t,n[t])})}),n(rt),n(nt),Object.keys(r.state).length>0&&(i(s,".dirty=true;"),i.exit(s,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}function tr(t){if("object"==typeof t&&!p(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(m.isDynamic(t[e[r]]))return!0;return!1}}function er(t,e,r){function n(t,e){o.forEach(function(r){var n=a[r];if(m.isDynamic(n)){var i=t.invoke(e,n);e(c,".",r,"=",i,";")}})}var a=e.static[r];if(a&&tr(a)){var i=t.global,o=Object.keys(a),s=!1,f=!1,l=!1,c=t.global.def("{}");o.forEach(function(e){var r=a[e];if(m.isDynamic(r)){"function"==typeof r&&(r=a[e]=m.unbox(r));var n=u(r,null);s=s||n.thisDep,l=l||n.propDep,f=f||n.contextDep}else{switch(i(c,".",e,"="),typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(t.link(r))}i(";")}}),e.dynamic[r]=new m.DynamicVariable(A,{thisDep:s,contextDep:f,propDep:l,ref:c,append:n}),delete e.static[r]}}function rr(t,e,r,n,a){var i=Ie();i.stats=i.link(a),Object.keys(e.static).forEach(function(t){er(i,e,t)}),vt.forEach(function(e){er(i,t,e)});var o=Be(t,e,r,n,i);return Xe(i,o),Ke(i,o),Je(i,o),i.compile()}var nr=Mt.Record,ar={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(ar.min=re,ar.max=ne);var ir=r.angle_instanced_arrays,or=r.webgl_draw_buffers,sr={dirty:!0,profile:Se.profile},ur={},fr=[],lr={},cr={};De(I,It),De(E,At),Ae(F,"blendColor",[0,0,0,0]),Ae(k,"blendEquationSeparate",[ue,ue]),Ae(j,"blendFuncSeparate",[se,oe,se,oe]),De(T,Ft,!0),Ae(R,"depthFunc",fe),Ae(O,"depthRange",[0,1]),Ae(z,"depthMask",!0),Ae(L,L,[!0,!0,!0,!0]),De(B,Dt),Ae(P,"cullFace",Kt),Ae(C,C,ee),Ae(U,U,1),De(q,jt),Ae(N,"polygonOffset",[0,0]),De(Y,Tt),De(W,Rt),Ae(V,"sampleCoverage",[1,!1]),De(H,Et),Ae(G,"stencilMask",-1),Ae(Q,"stencilFunc",[ae,0,-1]),Ae(X,"stencilOpSeparate",[Jt,ie,ie,ie]),Ae(Z,"stencilOpSeparate",[Kt,ie,ie,ie]),De($,kt),Ae(J,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),Ae(K,K,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var hr={gl:t,context:we,strings:e,next:ur,current:sr,draw:xe,elements:ft,buffer:d,shader:ye,attributes:Mt.state,uniforms:wt,framebuffer:mt,extensions:r,timer:Me,isBufferArgs:n},dr={primTypes:b,compareFuncs:pe,blendFuncs:he,blendEquations:ar,stencilOps:me,glTypes:g,orientationType:ge};f.optional(function(){hr.isArrayLike=p}),or&&(dr.backBuffer=[Kt],dr.drawBuffer=c(h.maxDrawbuffers,function(t){return 0===t?[0]:c(t,function(t){return ce+t})}));var pr=0;return{next:ur,current:sr,procs:function(){var e=Ie(),r=e.proc("poll"),n=e.proc("refresh"),a=e.block();r(a),n(a);var i=e.shared,o=i.gl,s=i.next,u=i.current;a(u,".dirty=false;"),Ce(e,r),Ce(e,n,null,!0);var f,l=t.getExtension("angle_instanced_arrays");l&&(f=e.link(l));for(var d=0;d<h.maxAttributes;++d){var m=n.def(i.attributes,"[",d,"]"),b=e.cond(m,".buffer");b.then(o,".enableVertexAttribArray(",d,");",o,".bindBuffer(",yt,",",m,".buffer.buffer);",o,".vertexAttribPointer(",d,",",m,".size,",m,".type,",m,".normalized,",m,".stride,",m,".offset);").else(o,".disableVertexAttribArray(",d,");",o,".vertexAttrib4f(",d,",",m,".x,",m,".y,",m,".z,",m,".w);",m,".buffer=null;"),n(b),l&&n(f,".vertexAttribDivisorANGLE(",d,",",m,".divisor);")}return Object.keys(lr).forEach(function(t){var i=lr[t],f=a.def(s,".",t),l=e.block();l("if(",f,"){",o,".enable(",i,")}else{",o,".disable(",i,")}",u,".",t,"=",f,";"),n(l),r("if(",f,"!==",u,".",t,"){",l,"}")}),Object.keys(cr).forEach(function(t){var i,f,l=cr[t],h=sr[t],d=e.block();if(d(o,".",l,"("),p(h)){var m=h.length;i=e.global.def(s,".",t),f=e.global.def(u,".",t),d(c(m,function(t){return i+"["+t+"]"}),");",c(m,function(t){return f+"["+t+"]="+i+"["+t+"];"}).join("")),r("if(",c(m,function(t){return i+"["+t+"]!=="+f+"["+t+"]"}).join("||"),"){",d,"}")}else i=a.def(s,".",t),f=a.def(u,".",t),d(i,");",u,".",t,"=",i,";"),r("if(",i,"!==",f,"){",d,"}");n(d)}),e.compile()}(),compile:rr}}},{"./constants/dtypes.json":50,"./constants/primitives.json":51,"./dynamic":54,"./util/check":66,"./util/codegen":68,"./util/is-array-like":70,"./util/is-ndarray":71,"./util/is-typed-array":72,"./util/loop":73}],54:[function(t,e,r){function n(t,e){this.id=l++,this.type=t,this.data=e}function a(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function i(t){if(0===t.length)return[];var e=t.charAt(0),r=t.charAt(t.length-1);if(t.length>1&&e===r&&('"'===e||"'"===e))return['"'+a(t.substr(1,t.length-2))+'"'];var n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(n)return i(t.substr(0,n.index)).concat(i(n[1])).concat(i(t.substr(n.index+n[0].length)));var o=t.split(".");if(1===o.length)return['"'+a(t)+'"'];for(var s=[],u=0;u<o.length;++u)s=s.concat(i(o[u]));return s}function o(t){return"["+i(t).join("][")+"]"}function s(t,e){return new n(t,o(e+""))}function u(t){return"function"==typeof t&&!t._reglType||t instanceof n}function f(t,e){return"function"==typeof t?new n(c,t):t}var l=0,c=0;e.exports={DynamicVariable:n,define:s,isDynamic:u,unbox:f,accessor:o}},{}],55:[function(t,e,r){var n=t("./util/check"),a=t("./util/is-typed-array"),i=t("./util/is-ndarray"),o=t("./util/values"),s=t("./constants/primitives.json"),u=t("./constants/usage.json"),f=0,l=1,c=4,h=5120,d=5121,p=5122,m=5123,b=5124,g=5125,v=34963,y=35040,x=35044;e.exports=function(t,e,r,w){function M(t){this.id=F++,E[this.id]=this,this.buffer=t,this.primType=c,this.vertCount=0,this.type=0}function S(t){var e=j.pop();return e||(e=new M(r.create(null,v,!0,!1)._buffer)),D(e,t,y,-1,-1,0,0),e}function _(t){j.push(t)}function D(t,o,s,u,v,y,x){var w=x;x||a(o)&&(!i(o)||a(o.data))||(w=e.oes_element_index_uint?g:m),t.buffer.bind(),r._initBuffer(t.buffer,o,s,w,3);var M=x;if(!x){switch(t.buffer.dtype){case d:case h:M=d;break;case m:case p:M=m;break;case g:case b:M=g;break;default:n.raise("unsupported type for element array")}t.buffer.dtype=M}t.type=M,n(M!==g||!!e.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var S=v;S<0&&(S=t.buffer.byteLength,M===m?S>>=1:M===g&&(S>>=2)),t.vertCount=S;var _=u;if(u<0){_=c;var D=t.buffer.dimension;1===D&&(_=f),2===D&&(_=l),3===D&&(_=c)}t.primType=_}function A(t){w.elementsCount--,n(null!==t.buffer,"must not double destroy elements"),delete E[t.id],t.buffer.destroy(),t.buffer=null}function I(e,o){function f(e){if(e)if("number"==typeof e)l(e),h.primType=c,h.vertCount=0|e,h.type=d;else{var r=null,o=x,p=-1,m=-1,b=0,g=0;if(Array.isArray(e)||a(e)||i(e)?r=e:(n.type(e,"object","invalid arguments for elements"),"data"in e&&(r=e.data,n(Array.isArray(r)||a(r)||i(r),"invalid data for element buffer")),"usage"in e&&(n.parameter(e.usage,u,"invalid element buffer usage"),o=u[e.usage]),"primitive"in e&&(n.parameter(e.primitive,s,"invalid element buffer primitive"),p=s[e.primitive]),"count"in e&&(n("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),m=0|e.count),"length"in e&&(b=0|e.length),"type"in e&&(n.parameter(e.type,k,"invalid buffer type"),g=k[e.type])),r)D(h,r,o,p,m,b,g);else{var y=h.buffer;y.bind(),t.bufferData(v,b,o),y.dtype=g||d,y.usage=o,y.dimension=3,y.byteLength=b,h.primType=p<0?c:p,h.vertCount=m<0?0:m,h.type=y.dtype}}else l(),h.primType=c,h.vertCount=0,h.type=d;return f}var l=r.create(null,v,!0),h=new M(l._buffer);return w.elementsCount++,f(e),f._reglType="elements",f._elements=h,f.subdata=function(t,e){return l.subdata(t,e),f},f.destroy=function(){A(h)},f}var E={},F=0,k={uint8:d,uint16:m};e.oes_element_index_uint&&(k.uint32=g),M.prototype.bind=function(){this.buffer.bind()};var j=[];return{create:I,createStream:S,destroyStream:_,getElements:function(t){return"function"==typeof t&&t._elements instanceof M?t._elements:null},clear:function(){o(E).forEach(A)}}}},{"./constants/primitives.json":51,"./constants/usage.json":52,"./util/check":66,"./util/is-ndarray":71,"./util/is-typed-array":72,"./util/values":77}],56:[function(t,e,r){var n=t("./util/check");e.exports=function(t,e){function r(e){n.type(e,"string","extension name must be string");var r,i=e.toLowerCase();try{r=a[i]=t.getExtension(i)}catch(t){}return!!r}for(var a={},i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!r(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:a,restore:function(){Object.keys(a).forEach(function(t){if(!r(t))throw new Error("(regl): error restoring extension "+t)})}}}},{"./util/check":66}],57:[function(t,e,r){var n=t("./util/check"),a=t("./util/values"),i=t("./util/extend"),o=36160,s=36161,u=3553,f=34069,l=36064,c=36096,h=36128,d=33306,p=36053,m=36054,b=36055,g=36057,v=36061,y=36193,x=5121,w=5126,M=6408,S=6402,_=[M],D=[];D[M]=4;var A=[];A[x]=1,A[w]=4,A[y]=2;var I=32854,E=32855,F=36194,k=33189,j=36168,T=34041,R=35907,O=34836,z=34842,L=34843,B=[I,E,F,R,z,L,O],P={};P[p]="complete",P[m]="incomplete attachment",P[g]="incomplete dimensions",P[b]="incomplete, missing attachment",P[v]="unsupported",e.exports=function(t,e,r,m,b,g){function v(t,e,r){this.target=t,this.texture=e,this.renderbuffer=r;var n=0,a=0;e?(n=e.width,a=e.height):r&&(n=r.width,a=r.height),this.width=n,this.height=a}function y(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function x(t,e,r){if(t)if(t.texture){var a=t.texture._texture,i=Math.max(1,a.width),o=Math.max(1,a.height);n(i===e&&o===r,"inconsistent width/height for supplied texture"),a.refCount+=1}else{var s=t.renderbuffer._renderbuffer;n(s.width===e&&s.height===r,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function w(e,r){r?r.texture?t.framebufferTexture2D(o,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(o,e,s,r.renderbuffer._renderbuffer.renderbuffer):t.framebufferTexture2D(o,e,u,null,0)}function M(t){var e=u,r=null,a=null,i=t;"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),n.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(r=i,n(e===u)):"textureCube"===o?(r=i,n(e>=f&&e<f+6,"invalid cube map target")):"renderbuffer"===o?(a=i,e=s):n.raise("invalid regl object for attachment"),new v(e,r,a)}function I(t,e,r,n,a){if(r){var i=m.create2D({width:t,height:e,format:n,type:a});return i._texture.refCount=0,new v(u,i,null)}var o=b.create({width:t,height:e,format:n});return o._renderbuffer.refCount=0,new v(s,null,o)}function E(t){return t&&(t.texture||t.renderbuffer)}function F(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r))}function R(){this.id=H++,G[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function O(t){t.colorAttachments.forEach(y),y(t.depthAttachment),y(t.stencilAttachment),y(t.depthStencilAttachment)}function z(e){var r=e.framebuffer;n(r,"must not double destroy framebuffer"),t.deleteFramebuffer(r),e.framebuffer=null,g.framebufferCount--,delete G[e.id]}function L(e){var a;t.bindFramebuffer(o,e.framebuffer);var i=e.colorAttachments;for(a=0;a<i.length;++a)w(l+a,i[a]);for(a=i.length;a<r.maxColorAttachments;++a)w(l+a,null);w(c,e.depthAttachment),w(h,e.stencilAttachment),w(d,e.depthStencilAttachment);var s=t.checkFramebufferStatus(o);s!==p&&n.raise("framebuffer configuration not supported, status = "+P[s]),t.bindFramebuffer(o,N.next),N.cur=N.next,t.getError()}function C(t,a){function o(t,a){var i;n(N.next!==u,"can not update framebuffer which is currently in use");var s=e.webgl_draw_buffers,f=0,l=0,c=!0,h=!0,d=null,p=!0,m="rgba",b="uint8",g=1,v=null,y=null,w=null,F=!1;if("number"==typeof t)f=0|t,l=0|a||f;else if(t){n.type(t,"object","invalid arguments for framebuffer");var R=t;if("shape"in R){var z=R.shape;n(Array.isArray(z)&&z.length>=2,"invalid shape for framebuffer"),f=z[0],l=z[1]}else"radius"in R&&(f=l=R.radius),"width"in R&&(f=R.width),"height"in R&&(l=R.height);("color"in R||"colors"in R)&&(d=R.color||R.colors,Array.isArray(d)&&n(1===d.length||s,"multiple render targets not supported")),d||("colorCount"in R&&(g=0|R.colorCount,n(g>0,"invalid color buffer count")),"colorTexture"in R&&(p=!!R.colorTexture,m="rgba4"),"colorType"in R&&(b=R.colorType,p?(n(e.oes_texture_float||!("float"===b||"float32"===b),"you must enable OES_texture_float in order to use floating point framebuffer objects"),n(e.oes_texture_half_float||!("half float"===b||"float16"===b),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===b||"float16"===b?(n(e.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),
m="rgba16f"):"float"!==b&&"float32"!==b||(n(e.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),m="rgba32f"),n.oneOf(b,V,"invalid color type")),"colorFormat"in R&&(m=R.colorFormat,Y.indexOf(m)>=0?p=!0:W.indexOf(m)>=0?p=!1:p?n.oneOf(R.colorFormat,Y,"invalid color format for texture"):n.oneOf(R.colorFormat,W,"invalid color format for renderbuffer"))),("depthTexture"in R||"depthStencilTexture"in R)&&(F=!(!R.depthTexture&&!R.depthStencilTexture),n(!F||e.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in R&&("boolean"==typeof R.depth?c=R.depth:(v=R.depth,h=!1)),"stencil"in R&&("boolean"==typeof R.stencil?h=R.stencil:(y=R.stencil,c=!1)),"depthStencil"in R&&("boolean"==typeof R.depthStencil?c=h=R.depthStencil:(w=R.depthStencil,c=!1,h=!1))}else f=l=1;var P=null,C=null,U=null,q=null;if(Array.isArray(d))P=d.map(M);else if(d)P=[M(d)];else for(P=new Array(g),i=0;i<g;++i)P[i]=I(f,l,p,m,b);n(e.webgl_draw_buffers||P.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),n(P.length<=r.maxColorAttachments,"too many color attachments, not supported"),f=f||P[0].width,l=l||P[0].height,v?C=M(v):c&&!h&&(C=I(f,l,F,"depth","uint32")),y?U=M(y):h&&!c&&(U=I(f,l,!1,"stencil","uint8")),w?q=M(w):!v&&!y&&h&&c&&(q=I(f,l,F,"depth stencil","depth stencil")),n(!!v+!!y+!!w<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var H=null;for(i=0;i<P.length;++i)if(x(P[i],f,l),n(!P[i]||P[i].texture&&_.indexOf(P[i].texture._texture.format)>=0||P[i].renderbuffer&&B.indexOf(P[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),P[i]&&P[i].texture){var G=D[P[i].texture._texture.format]*A[P[i].texture._texture.type];null===H?H=G:n(H===G,"all color attachments much have the same number of bits per pixel.")}return x(C,f,l),n(!C||C.texture&&C.texture._texture.format===S||C.renderbuffer&&C.renderbuffer._renderbuffer.format===k,"invalid depth attachment for framebuffer object"),x(U,f,l),n(!U||U.renderbuffer&&U.renderbuffer._renderbuffer.format===j,"invalid stencil attachment for framebuffer object"),x(q,f,l),n(!q||q.texture&&q.texture._texture.format===T||q.renderbuffer&&q.renderbuffer._renderbuffer.format===T,"invalid depth-stencil attachment for framebuffer object"),O(u),u.width=f,u.height=l,u.colorAttachments=P,u.depthAttachment=C,u.stencilAttachment=U,u.depthStencilAttachment=q,o.color=P.map(E),o.depth=E(C),o.stencil=E(U),o.depthStencil=E(q),o.width=u.width,o.height=u.height,L(u),o}function s(t,e){n(N.next!==u,"can not resize a framebuffer which is currently in use");var r=0|t,a=0|e||r;if(r===u.width&&a===u.height)return o;for(var i=u.colorAttachments,s=0;s<i.length;++s)F(i[s],r,a);return F(u.depthAttachment,r,a),F(u.stencilAttachment,r,a),F(u.depthStencilAttachment,r,a),u.width=o.width=r,u.height=o.height=a,L(u),o}var u=new R;return g.framebufferCount++,o(t,a),i(o,{resize:s,_reglType:"framebuffer",_framebuffer:u,destroy:function(){z(u),O(u)}})}function U(t){function a(t){var r;n(s.indexOf(N.next)<0,"can not update framebuffer which is currently in use");var o=e.webgl_draw_buffers,u={color:null},l=0,c=null,h="rgba",d="uint8",p=1;if("number"==typeof t)l=0|t;else if(t){n.type(t,"object","invalid arguments for framebuffer");var b=t;if("shape"in b){var g=b.shape;n(Array.isArray(g)&&g.length>=2,"invalid shape for framebuffer"),n(g[0]===g[1],"cube framebuffer must be square"),l=g[0]}else"radius"in b&&(l=0|b.radius),"width"in b?(l=0|b.width,"height"in b&&n(b.height===l,"must be square")):"height"in b&&(l=0|b.height);("color"in b||"colors"in b)&&(c=b.color||b.colors,Array.isArray(c)&&n(1===c.length||o,"multiple render targets not supported")),c||("colorCount"in b&&(p=0|b.colorCount,n(p>0,"invalid color buffer count")),"colorType"in b&&(n.oneOf(b.colorType,V,"invalid color type"),d=b.colorType),"colorFormat"in b&&(h=b.colorFormat,n.oneOf(b.colorFormat,Y,"invalid color format for texture"))),"depth"in b&&(u.depth=b.depth),"stencil"in b&&(u.stencil=b.stencil),"depthStencil"in b&&(u.depthStencil=b.depthStencil)}else l=1;var v;if(c)if(Array.isArray(c))for(v=[],r=0;r<c.length;++r)v[r]=c[r];else v=[c];else{v=Array(p);var y={radius:l,format:h,type:d};for(r=0;r<p;++r)v[r]=m.createCube(y)}for(u.color=Array(v.length),r=0;r<v.length;++r){var x=v[r];n("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),l=l||x.width,n(x.width===l&&x.height===l,"invalid cube map shape"),u.color[r]={target:f,data:v[r]}}for(r=0;r<6;++r){for(var w=0;w<v.length;++w)u.color[w].target=f+r;r>0&&(u.depth=s[0].depth,u.stencil=s[0].stencil,u.depthStencil=s[0].depthStencil),s[r]?s[r](u):s[r]=C(u)}return i(a,{width:l,height:l,color:v})}function o(t){var e,i=0|t;if(n(i>0&&i<=r.maxCubeMapSize,"invalid radius for cube fbo"),i===a.width)return a;var o=a.color;for(e=0;e<o.length;++e)o[e].resize(i);for(e=0;e<6;++e)s[e].resize(i);return a.width=a.height=i,a}var s=Array(6);return a(t),i(a,{faces:s,resize:o,_reglType:"framebufferCube",destroy:function(){s.forEach(function(t){t.destroy()})}})}function q(){a(G).forEach(function(e){e.framebuffer=t.createFramebuffer(),L(e)})}var N={cur:null,next:null,dirty:!1},Y=["rgba"],W=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&W.push("srgba"),e.ext_color_buffer_half_float&&W.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&W.push("rgba32f");var V=["uint8"];e.oes_texture_half_float&&V.push("half float","float16"),e.oes_texture_float&&V.push("float","float32");var H=0,G={};return i(N,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof R)return e}return null},create:C,createCube:U,clear:function(){a(G).forEach(z)},restore:q})}},{"./util/check":66,"./util/extend":69,"./util/values":77}],58:[function(t,e,r){var n=3408,a=3410,i=3411,o=3412,s=3413,u=3414,f=3415,l=33901,c=33902,h=3379,d=3386,p=34921,m=36347,b=36348,g=35661,v=35660,y=34930,x=36349,w=34076,M=34024,S=7936,_=7937,D=7938,A=35724,I=34047,E=36063,F=34852;e.exports=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(I));var k=1,j=1;return e.webgl_draw_buffers&&(k=t.getParameter(F),j=t.getParameter(E)),{colorBits:[t.getParameter(a),t.getParameter(i),t.getParameter(o),t.getParameter(s)],depthBits:t.getParameter(u),stencilBits:t.getParameter(f),subpixelBits:t.getParameter(n),extensions:Object.keys(e).filter(function(t){return!!e[t]}),maxAnisotropic:r,maxDrawbuffers:k,maxColorAttachments:j,pointSizeDims:t.getParameter(l),lineWidthDims:t.getParameter(c),maxViewportDims:t.getParameter(d),maxCombinedTextureUnits:t.getParameter(g),maxCubeMapSize:t.getParameter(w),maxRenderbufferSize:t.getParameter(M),maxTextureUnits:t.getParameter(y),maxTextureSize:t.getParameter(h),maxAttributes:t.getParameter(p),maxVertexUniforms:t.getParameter(m),maxVertexTextureUnits:t.getParameter(v),maxVaryingVectors:t.getParameter(b),maxFragmentUniforms:t.getParameter(x),glsl:t.getParameter(A),renderer:t.getParameter(_),vendor:t.getParameter(S),version:t.getParameter(D)}}},{}],59:[function(t,e,r){var n=t("./util/check"),a=t("./util/is-typed-array"),i=6408,o=5121,s=3333,u=5126;e.exports=function(t,e,r,f,l,c){function h(h){var d;null===e.next?(n(l.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),d=o):(n(null!==e.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),d=e.next.colorAttachments[0].texture._texture.type,c.oes_texture_float?n(d===o||d===u,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):n(d===o,"Reading from a framebuffer is only allowed for the type 'uint8'"));var p=0,m=0,b=f.framebufferWidth,g=f.framebufferHeight,v=null;a(h)?v=h:h&&(n.type(h,"object","invalid arguments to regl.read()"),p=0|h.x,m=0|h.y,n(p>=0&&p<f.framebufferWidth,"invalid x offset for regl.read"),n(m>=0&&m<f.framebufferHeight,"invalid y offset for regl.read"),b=0|(h.width||f.framebufferWidth-p),g=0|(h.height||f.framebufferHeight-m),v=h.data||null),v&&(d===o?n(v instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):d===u&&n(v instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),n(b>0&&b+p<=f.framebufferWidth,"invalid width for read pixels"),n(g>0&&g+m<=f.framebufferHeight,"invalid height for read pixels"),r();var y=b*g*4;return v||(d===o?v=new Uint8Array(y):d===u&&(v=v||new Float32Array(y))),n.isTypedArray(v,"data buffer for regl.read() must be a typedarray"),n(v.byteLength>=y,"data buffer for regl.read() too small"),t.pixelStorei(s,4),t.readPixels(p,m,b,g,i,d,v),v}return h}},{"./util/check":66,"./util/is-typed-array":72}],60:[function(t,e,r){function n(t,e,r){return g[t]*e*r}var a=t("./util/check"),i=t("./util/values"),o=36161,s=32854,u=32855,f=36194,l=33189,c=36168,h=34041,d=35907,p=34836,m=34842,b=34843,g=[];g[s]=2,g[u]=2,g[f]=2,g[l]=2,g[c]=1,g[h]=4,g[d]=4,g[p]=16,g[m]=8,g[b]=6,e.exports=function(t,e,r,g,v){function y(t){this.id=D++,this.refCount=1,this.renderbuffer=t,this.format=s,this.width=0,this.height=0,v.profile&&(this.stats={size:0})}function x(e){var r=e.renderbuffer;a(r,"must not double destroy renderbuffer"),t.bindRenderbuffer(o,null),t.deleteRenderbuffer(r),e.renderbuffer=null,e.refCount=0,delete A[e.id],g.renderbufferCount--}function w(e,i){function u(e,i){var f=0,c=0,h=s;if("object"==typeof e&&e){var d=e;if("shape"in d){var p=d.shape;a(Array.isArray(p)&&p.length>=2,"invalid renderbuffer shape"),f=0|p[0],c=0|p[1]}else"radius"in d&&(f=c=0|d.radius),"width"in d&&(f=0|d.width),"height"in d&&(c=0|d.height);"format"in d&&(a.parameter(d.format,S,"invalid renderbuffer format"),h=S[d.format])}else"number"==typeof e?(f=0|e,c="number"==typeof i?0|i:f):e?a.raise("invalid arguments to renderbuffer constructor"):f=c=1;if(a(f>0&&c>0&&f<=r.maxRenderbufferSize&&c<=r.maxRenderbufferSize,"invalid renderbuffer size"),f!==l.width||c!==l.height||h!==l.format)return u.width=l.width=f,u.height=l.height=c,l.format=h,t.bindRenderbuffer(o,l.renderbuffer),t.renderbufferStorage(o,h,f,c),v.profile&&(l.stats.size=n(l.format,l.width,l.height)),u.format=_[l.format],u}function f(e,i){var s=0|e,f=0|i||s;return s===l.width&&f===l.height?u:(a(s>0&&f>0&&s<=r.maxRenderbufferSize&&f<=r.maxRenderbufferSize,"invalid renderbuffer size"),u.width=l.width=s,u.height=l.height=f,t.bindRenderbuffer(o,l.renderbuffer),t.renderbufferStorage(o,l.format,s,f),v.profile&&(l.stats.size=n(l.format,l.width,l.height)),u)}var l=new y(t.createRenderbuffer());return A[l.id]=l,g.renderbufferCount++,u(e,i),u.resize=f,u._reglType="renderbuffer",u._renderbuffer=l,v.profile&&(u.stats=l.stats),u.destroy=function(){l.decRef()},u}function M(){i(A).forEach(function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(o,e.renderbuffer),t.renderbufferStorage(o,e.format,e.width,e.height)}),t.bindRenderbuffer(o,null)}var S={rgba4:s,rgb565:f,"rgb5 a1":u,depth:l,stencil:c,"depth stencil":h};e.ext_srgb&&(S.srgba=d),e.ext_color_buffer_half_float&&(S.rgba16f=m,S.rgb16f=b),e.webgl_color_buffer_float&&(S.rgba32f=p);var _=[];Object.keys(S).forEach(function(t){var e=S[t];_[e]=t});var D=0,A={};return y.prototype.decRef=function(){--this.refCount<=0&&x(this)},v.profile&&(g.getTotalRenderbufferSize=function(){var t=0;return Object.keys(A).forEach(function(e){t+=A[e].stats.size}),t}),{create:w,clear:function(){i(A).forEach(x)},restore:M}}},{"./util/check":66,"./util/values":77}],61:[function(t,e,r){var n=t("./util/check"),a=t("./util/values"),i=35632,o=35633,s=35718,u=35721;e.exports=function(t,e,r,f){function l(t,e,r,n){this.name=t,this.id=e,this.location=r,this.info=n}function c(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id)return void(t[r].location=e.location);t.push(e)}function h(r,a,o){var s=r===i?b:g,u=s[a];if(!u){var f=e.str(a);u=t.createShader(r),t.shaderSource(u,f),t.compileShader(u),n.shaderError(t,u,f,r,o),s[a]=u}return u}function d(t,e){this.id=x++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],f.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(r,a){var d,p,m=h(i,r.fragId),b=h(o,r.vertId),g=r.program=t.createProgram();t.attachShader(g,m),t.attachShader(g,b),t.linkProgram(g),n.linkError(t,g,e.str(r.fragId),e.str(r.vertId),a);var v=t.getProgramParameter(g,s);f.profile&&(r.stats.uniformsCount=v);var y=r.uniforms;for(d=0;d<v;++d)if(p=t.getActiveUniform(g,d))if(p.size>1)for(var x=0;x<p.size;++x){var w=p.name.replace("[0]","["+x+"]");c(y,new l(w,e.id(w),t.getUniformLocation(g,w),p))}else c(y,new l(p.name,e.id(p.name),t.getUniformLocation(g,p.name),p));var M=t.getProgramParameter(g,u);f.profile&&(r.stats.attributesCount=M);var S=r.attributes;for(d=0;d<M;++d)p=t.getActiveAttrib(g,d),p&&c(S,new l(p.name,e.id(p.name),t.getAttribLocation(g,p.name),p))}function m(){b={},g={};for(var t=0;t<y.length;++t)p(y[t])}var b={},g={},v={},y=[],x=0;return f.profile&&(r.getMaxUniformsCount=function(){var t=0;return y.forEach(function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)}),t},r.getMaxAttributesCount=function(){var t=0;return y.forEach(function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)}),t}),{clear:function(){var e=t.deleteShader.bind(t);a(b).forEach(e),b={},a(g).forEach(e),g={},y.forEach(function(e){t.deleteProgram(e.program)}),y.length=0,v={},r.shaderCount=0},program:function(t,e,a){n.command(t>=0,"missing vertex shader",a),n.command(e>=0,"missing fragment shader",a),r.shaderCount++;var i=v[e];i||(i=v[e]={});var o=i[t];return o||(o=new d(e,t),p(o,a),i[t]=o,y.push(o)),o},restore:m,shader:h,frag:-1,vert:-1}}},{"./util/check":66,"./util/values":77}],62:[function(t,e,r){e.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],63:[function(t,e,r){e.exports=function(){var t={"":0},e=[""];return{id:function(r){var n=t[r];return n?n:(n=t[r]=e.length,e.push(r),n)},str:function(t){return e[t]}}}},{}],64:[function(t,e,r){function n(t){return"[object "+t+"]"}function a(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function i(t){if(!Array.isArray(t))return!1;var e=t.length;return!(0===e||!I(t[0]))}function o(t){return Object.prototype.toString.call(t)}function s(t){return o(t)===qt}function u(t){return o(t)===Nt}function f(t){return o(t)===Yt}function l(t){return o(t)===Wt}function c(t){if(!t)return!1;var e=o(t);return Vt.indexOf(e)>=0||(a(t)||i(t)||_(t))}function h(t){return 0|F[Object.prototype.toString.call(t)]}function d(t,e){var r=t.width*t.height*t.channels;switch(x(e.length===r,"inconsistent array length for texture. Expected: "+r+". Was: "+e.length),t.type){case ft:case lt:case ct:case ht:var n=D.allocType(t.type,r);n.set(e),t.data=n;break;case Z:t.data=A(e);break;default:x.raise("unsupported texture type, must specify a typed array")}}function p(t,e){return D.allocType(t.type===Z?ht:t.type,e)}function m(t,e){t.type===Z?(t.data=A(e),D.freeType(e)):t.data=e}function b(t,e,r,n,a,i){for(var o=t.width,s=t.height,u=t.channels,f=o*s*u,l=p(t,f),c=0,h=0;h<s;++h)for(var d=0;d<o;++d)for(var b=0;b<u;++b)l[c++]=e[r*d+n*h+a*b+i];m(t,l)}function g(t,e,r,n){for(var a=r*n,i=p(t,a),o=0,s=0;s<n;++s)for(var u=e[s],f=0;f<r;++f)i[o++]=u[f];m(t,i)}function v(t,e,r,n,a){for(var i=r*n*a,o=p(t,i),s=0,u=0;u<n;++u)for(var f=e[u],l=0;l<r;++l)for(var c=f[l],h=0;h<a;++h)o[s++]=c[h];m(t,o)}function y(t,e,r,n,a,i){var o;if(o="undefined"!=typeof Gt[t]?Gt[t]:Ct[t]*Ht[e],i&&(o*=6),a){for(var s=0,u=r;u>=1;)s+=o*u*u,u/=2;return s}return o*r*n}var x=t("./util/check"),w=t("./util/extend"),M=t("./util/values"),S=t("./util/is-typed-array"),_=t("./util/is-ndarray"),D=t("./util/pool"),A=t("./util/to-half-float"),I=t("./util/is-array-like"),E=t("./constants/arraytypes.json"),F=t("./constants/arraytypes.json"),k=34467,j=3553,T=34067,R=34069,O=6408,z=6406,L=6407,B=6409,P=6410,C=32854,U=32855,q=36194,N=32819,Y=32820,W=33635,V=34042,H=6402,G=34041,Q=35904,X=35906,Z=36193,$=33776,J=33777,K=33778,tt=33779,et=35986,rt=35987,nt=34798,at=35840,it=35841,ot=35842,st=35843,ut=36196,ft=5121,lt=5123,ct=5125,ht=5126,dt=10242,pt=10243,mt=10497,bt=33071,gt=33648,vt=10240,yt=10241,xt=9728,wt=9729,Mt=9984,St=9985,_t=9986,Dt=9987,At=33170,It=4352,Et=4353,Ft=4354,kt=34046,jt=3317,Tt=37440,Rt=37441,Ot=37443,zt=37444,Lt=33984,Bt=[Mt,_t,St,Dt],Pt=[0,B,P,L,O],Ct={};Ct[B]=Ct[z]=Ct[H]=1,Ct[G]=Ct[P]=2,Ct[L]=Ct[Q]=3,Ct[O]=Ct[X]=4;var Ut={};Ut[C]=N,Ut[q]=W,Ut[U]=Y,Ut[H]=ct,Ut[G]=V;var qt=n("HTMLCanvasElement"),Nt=n("CanvasRenderingContext2D"),Yt=n("HTMLImageElement"),Wt=n("HTMLVideoElement"),Vt=Object.keys(E).concat([qt,Nt,Yt,Wt]),Ht=[];Ht[ft]=1,Ht[ht]=4,Ht[Z]=2,Ht[lt]=2,Ht[ct]=4;var Gt=[];Gt[C]=2,Gt[U]=2,Gt[q]=2,Gt[G]=4,Gt[$]=.5,Gt[J]=.5,Gt[K]=1,Gt[tt]=1,Gt[et]=.5,Gt[rt]=1,Gt[nt]=1,Gt[at]=.5,Gt[it]=.25,Gt[ot]=.5,Gt[st]=.25,Gt[ut]=.5,e.exports=function(t,e,r,n,o,p,m){function A(){this.internalformat=O,this.format=O,this.type=ft,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=4}function E(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function F(t,n){if("object"==typeof n&&n){if("premultiplyAlpha"in n&&(x.type(n.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=n.premultiplyAlpha),"flipY"in n&&(x.type(n.flipY,"boolean","invalid texture flip"),t.flipY=n.flipY),"alignment"in n&&(x.oneOf(n.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=n.alignment),"colorSpace"in n&&(x.parameter(n.colorSpace,pe,"invalid colorSpace"),t.colorSpace=pe[n.colorSpace]),"type"in n){var a=n.type;x(e.oes_texture_float||!("float"===a||"float32"===a),"you must enable the OES_texture_float extension in order to use floating point textures."),x(e.oes_texture_half_float||!("half float"===a||"float16"===a),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),x(e.webgl_depth_texture||!("depth"===a||"depth stencil"===a),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),x.parameter(a,me,"invalid texture type"),t.type=me[a]}var i=t.width,o=t.height,s=t.channels,u=!1;"shape"in n?(x(Array.isArray(n.shape)&&n.shape.length>=2,"shape must be an array"),i=n.shape[0],o=n.shape[1],3===n.shape.length&&(s=n.shape[2],x(s>0&&s<=4,"invalid number of channels"),u=!0),x(i>=0&&i<=r.maxTextureSize,"invalid width"),x(o>=0&&o<=r.maxTextureSize,"invalid height")):("radius"in n&&(i=o=n.radius,x(i>=0&&i<=r.maxTextureSize,"invalid radius")),"width"in n&&(i=n.width,x(i>=0&&i<=r.maxTextureSize,"invalid width")),"height"in n&&(o=n.height,x(o>=0&&o<=r.maxTextureSize,"invalid height")),"channels"in n&&(s=n.channels,x(s>0&&s<=4,"invalid number of channels"),u=!0)),t.width=0|i,t.height=0|o,t.channels=0|s;var f=!1;if("format"in n){var l=n.format;x(e.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),x.parameter(l,be,"invalid texture format");var c=t.internalformat=be[l];t.format=De[c],l in me&&("type"in n||(t.type=me[l])),l in ge&&(t.compressed=!0),f=!0}!u&&f?t.channels=Ct[t.format]:u&&!f?t.channels!==Pt[t.format]&&(t.format=t.internalformat=Pt[t.channels]):f&&u&&x(t.channels===Ct[t.format],"number of channels inconsistent with specified format")}}function Ut(e){t.pixelStorei(Tt,e.flipY),t.pixelStorei(Rt,e.premultiplyAlpha),t.pixelStorei(Ot,e.colorSpace),t.pixelStorei(jt,e.unpackAlignment)}function qt(){A.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Nt(t,e){var n=null;if(c(e)?n=e:e&&(x.type(e,"object","invalid pixel data type"),F(t,e),"x"in e&&(t.xOffset=0|e.x),"y"in e&&(t.yOffset=0|e.y),c(e.data)&&(n=e.data)),x(!t.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),e.copy){x(!n,"can not specify copy and data field for the same texture");var p=o.viewportWidth,m=o.viewportHeight;t.width=t.width||p-t.xOffset,t.height=t.height||m-t.yOffset,t.needsCopy=!0,x(t.xOffset>=0&&t.xOffset<p&&t.yOffset>=0&&t.yOffset<m&&t.width>0&&t.width<=p&&t.height>0&&t.height<=m,"copy texture read out of bounds")}else if(n){if(S(n))t.data=n,"type"in e||t.type!==ft||(t.type=h(n));else if(a(n))d(t,n),t.alignment=1,t.needsFree=!0;else if(_(n)){var y=n.data;Array.isArray(y)||t.type!==ft||(t.type=h(y));var w,M,D,A,E,k,j=n.shape,T=n.stride;3===j.length?(D=j[2],k=T[2]):(x(2===j.length,"invalid ndarray pixel data, must be 2 or 3D"),D=1,k=1),w=j[0],M=j[1],A=T[0],E=T[1],t.alignment=1,t.width=w,t.height=M,t.channels=D,t.format=t.internalformat=Pt[D],t.needsFree=!0,b(t,y,A,E,k,n.offset)}else if(s(n)||u(n))s(n)?t.element=n:t.element=n.canvas,t.width=t.element.width,t.height=t.element.height;else if(f(n))t.element=n,t.width=n.naturalWidth,t.height=n.naturalHeight;else if(l(n))t.element=n,t.width=n.videoWidth,t.height=n.videoHeight,t.needsPoll=!0;else if(i(n)){var R=n[0].length,O=n.length,z=1;I(n[0][0])?(z=n[0][0].length,v(t,n,R,O,z)):g(t,n,R,O),t.alignment=1,t.width=R,t.height=O,t.channels=z,t.format=t.internalformat=Pt[z],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1;t.type===ht?x(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Z&&x(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Yt(e,r,a){var i=e.element,o=e.data,s=e.internalformat,u=e.format,f=e.type,l=e.width,c=e.height;Ut(e),i?t.texImage2D(r,a,u,u,f,i):e.compressed?t.compressedTexImage2D(r,a,s,l,c,0,o):e.needsCopy?(n(),t.copyTexImage2D(r,a,u,e.xOffset,e.yOffset,l,c,0)):t.texImage2D(r,a,u,l,c,0,u,f,o)}function Wt(e,r,a,i,o){var s=e.element,u=e.data,f=e.internalformat,l=e.format,c=e.type,h=e.width,d=e.height;Ut(e),s?t.texSubImage2D(r,o,a,i,l,c,s):e.compressed?t.compressedTexSubImage2D(r,o,a,i,f,h,d,u):e.needsCopy?(n(),t.copyTexSubImage2D(r,o,a,i,e.xOffset,e.yOffset,h,d)):t.texSubImage2D(r,o,a,i,h,d,l,c,u)}function Vt(){return Ae.pop()||new qt}function Ht(t){t.needsFree&&D.freeType(t.data),qt.call(t),Ae.push(t)}function Gt(){A.call(this),this.genMipmaps=!1,this.mipmapHint=It,this.mipmask=0,this.images=Array(16)}function Qt(t,e,r){var n=t.images[0]=Vt();t.mipmask=1,n.width=t.width=e,n.height=t.height=r}function Xt(t,e){var r=null;if(c(e))r=t.images[0]=Vt(),E(r,t),Nt(r,e),t.mipmask=1;else if(F(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,a=0;a<n.length;++a)r=t.images[a]=Vt(),E(r,t),r.width>>=a,r.height>>=a,Nt(r,n[a]),t.mipmask|=1<<a;else r=t.images[0]=Vt(),E(r,t),Nt(r,e),t.mipmask=1;E(t,t.images[0]),(t.compressed&&t.internalformat===$||t.internalformat===J||t.internalformat===K||t.internalformat===tt)&&x(t.width%4===0&&t.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Zt(t,e){for(var r=t.images,n=0;n<r.length;++n){if(!r[n])return;Yt(r[n],e,n)}}function $t(){var t=Ie.pop()||new Gt;A.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function Jt(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&Ht(e[r]),e[r]=null;Ie.push(t)}function Kt(){this.minFilter=xt,this.magFilter=xt,this.wrapS=bt,this.wrapT=bt,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=It}function te(t,e){if("min"in e){var n=e.min;x.parameter(n,de),t.minFilter=de[n],Bt.indexOf(t.minFilter)>=0&&(t.genMipmaps=!0)}if("mag"in e){var a=e.mag;x.parameter(a,he),t.magFilter=he[a]}var i=t.wrapS,o=t.wrapT;if("wrap"in e){var s=e.wrap;"string"==typeof s?(x.parameter(s,ce),i=o=ce[s]):Array.isArray(s)&&(x.parameter(s[0],ce),x.parameter(s[1],ce),i=ce[s[0]],o=ce[s[1]])}else{if("wrapS"in e){var u=e.wrapS;x.parameter(u,ce),i=ce[u]}if("wrapT"in e){var f=e.wrapT;x.parameter(f,ce),o=ce[f]}}if(t.wrapS=i,t.wrapT=o,"anisotropic"in e){var l=e.anisotropic;x("number"==typeof l&&l>=1&&l<=r.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var c=!1;switch(typeof e.mipmap){case"string":x.parameter(e.mipmap,le,"invalid mipmap hint"),t.mipmapHint=le[e.mipmap],t.genMipmaps=!0,c=!0;break;case"boolean":c=t.genMipmaps=e.mipmap;break;case"object":x(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,c=!0;break;default:x.raise("invalid mipmap type")}!c||"min"in e||(t.minFilter=Mt)}}function ee(r,n){t.texParameteri(n,yt,r.minFilter),t.texParameteri(n,vt,r.magFilter),t.texParameteri(n,dt,r.wrapS),t.texParameteri(n,pt,r.wrapT),e.ext_texture_filter_anisotropic&&t.texParameteri(n,kt,r.anisotropic),r.genMipmaps&&(t.hint(At,r.mipmapHint),t.generateMipmap(n))}function re(e){A.call(this),this.mipmask=0,this.internalformat=O,this.id=Ee++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Kt,m.profile&&(this.stats={size:0})}function ne(e){t.activeTexture(Lt),t.bindTexture(e.target,e.texture)}function ae(){var e=je[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(j,null)}function ie(e){var r=e.texture;x(r,"must not double destroy texture");var n=e.unit,a=e.target;n>=0&&(t.activeTexture(Lt+n),t.bindTexture(a,null),je[n]=null),t.deleteTexture(r),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete Fe[e.id],p.textureCount--}function oe(e,n){function a(t,e){var n=s.texInfo;Kt.call(n);var i=$t();return"number"==typeof t?"number"==typeof e?Qt(i,0|t,0|e):Qt(i,0|t,0|t):t?(x.type(t,"object","invalid arguments to regl.texture"),te(n,t),Xt(i,t)):Qt(i,1,1),n.genMipmaps&&(i.mipmask=(i.width<<1)-1),s.mipmask=i.mipmask,E(s,i),x.texture2D(n,i,r),s.internalformat=i.internalformat,a.width=i.width,a.height=i.height,ne(s),Zt(i,j),ee(n,j),ae(),Jt(i),m.profile&&(s.stats.size=y(s.internalformat,s.type,i.width,i.height,n.genMipmaps,!1)),a.format=xe[s.internalformat],a.type=we[s.type],a.mag=Me[n.magFilter],a.min=Se[n.minFilter],a.wrapS=_e[n.wrapS],a.wrapT=_e[n.wrapT],a}function i(t,e,r,n){x(!!t,"must specify image data");var i=0|e,o=0|r,u=0|n,f=Vt();return E(f,s),f.width>>=u,f.height>>=u,f.width-=i,f.height-=o,Nt(f,t),x(s.type===f.type&&s.format===f.format&&s.internalformat===f.internalformat,"incompatible format for texture.subimage"),x(i>=0&&o>=0&&i+f.width<=s.width&&o+f.height<=s.height,"texture.subimage write out of bounds"),x(s.mipmask&1<<u,"missing mipmap data"),x(f.data||f.element||f.needsCopy,"missing image data"),ne(s),Wt(f,j,i,o,u),ae(),Ht(f),a}function o(e,r){var n=0|e,i=0|r||n;if(n===s.width&&i===s.height)return a;a.width=s.width=n,a.height=s.height=i,ne(s);for(var o=0;s.mipmask>>o;++o)t.texImage2D(j,o,s.format,n>>o,i>>o,0,s.format,s.type,null);return ae(),m.profile&&(s.stats.size=y(s.internalformat,s.type,n,i,!1,!1)),a}var s=new re(j);return Fe[s.id]=s,p.textureCount++,a(e,n),a.subimage=i,a.resize=o,a._reglType="texture2d",a._texture=s,m.profile&&(a.stats=s.stats),a.destroy=function(){s.decRef()},a}function se(e,n,a,i,o,s){function u(t,e,n,a,i,o){var s,f=c.texInfo;for(Kt.call(f),s=0;s<6;++s)h[s]=$t();if("number"!=typeof t&&t)if("object"==typeof t)if(e)Xt(h[0],t),Xt(h[1],e),Xt(h[2],n),Xt(h[3],a),Xt(h[4],i),Xt(h[5],o);else if(te(f,t),F(c,t),"faces"in t){var l=t.faces;for(x(Array.isArray(l)&&6===l.length,"cube faces must be a length 6 array"),s=0;s<6;++s)x("object"==typeof l[s]&&!!l[s],"invalid input for cube map face"),E(h[s],c),Xt(h[s],l[s])}else for(s=0;s<6;++s)Xt(h[s],t);else x.raise("invalid arguments to cube map");else{var d=0|t||1;for(s=0;s<6;++s)Qt(h[s],d,d)}for(E(c,h[0]),f.genMipmaps?c.mipmask=(h[0].width<<1)-1:c.mipmask=h[0].mipmask,x.textureCube(c,f,h,r),c.internalformat=h[0].internalformat,u.width=h[0].width,u.height=h[0].height,ne(c),s=0;s<6;++s)Zt(h[s],R+s);for(ee(f,T),ae(),m.profile&&(c.stats.size=y(c.internalformat,c.type,u.width,u.height,f.genMipmaps,!0)),u.format=xe[c.internalformat],u.type=we[c.type],u.mag=Me[f.magFilter],u.min=Se[f.minFilter],u.wrapS=_e[f.wrapS],u.wrapT=_e[f.wrapT],s=0;s<6;++s)Jt(h[s]);return u}function f(t,e,r,n,a){x(!!e,"must specify image data"),x("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var i=0|r,o=0|n,s=0|a,f=Vt();return E(f,c),f.width>>=s,f.height>>=s,f.width-=i,f.height-=o,Nt(f,e),x(c.type===f.type&&c.format===f.format&&c.internalformat===f.internalformat,"incompatible format for texture.subimage"),x(i>=0&&o>=0&&i+f.width<=c.width&&o+f.height<=c.height,"texture.subimage write out of bounds"),x(c.mipmask&1<<s,"missing mipmap data"),x(f.data||f.element||f.needsCopy,"missing image data"),ne(c),Wt(f,R+t,i,o,s),ae(),Ht(f),u}function l(e){var r=0|e;if(r!==c.width){u.width=c.width=r,u.height=c.height=r,ne(c);for(var n=0;n<6;++n)for(var a=0;c.mipmask>>a;++a)t.texImage2D(R+n,a,c.format,r>>a,r>>a,0,c.format,c.type,null);return ae(),m.profile&&(c.stats.size=y(c.internalformat,c.type,u.width,u.height,!1,!0)),u}}var c=new re(T);Fe[c.id]=c,p.cubeCount++;var h=new Array(6);return u(e,n,a,i,o,s),u.subimage=f,u.resize=l,u._reglType="textureCube",u._texture=c,m.profile&&(u.stats=c.stats),u.destroy=function(){c.decRef()},u}function ue(){for(var e=0;e<ke;++e)t.activeTexture(Lt+e),t.bindTexture(j,null),je[e]=null;M(Fe).forEach(ie),p.cubeCount=0,p.textureCount=0}function fe(){M(Fe).forEach(function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var r=0;r<32;++r)if(0!==(e.mipmask&1<<r))if(e.target===j)t.texImage2D(j,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);else for(var n=0;n<6;++n)t.texImage2D(R+n,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);ee(e.texInfo,e.target)})}var le={"don't care":It,"dont care":It,nice:Ft,fast:Et},ce={repeat:mt,clamp:bt,mirror:gt},he={nearest:xt,linear:wt},de=w({mipmap:Dt,"nearest mipmap nearest":Mt,"linear mipmap nearest":St,"nearest mipmap linear":_t,"linear mipmap linear":Dt},he),pe={none:0,browser:zt},me={uint8:ft,rgba4:N,rgb565:W,"rgb5 a1":Y},be={alpha:z,luminance:B,"luminance alpha":P,rgb:L,rgba:O,rgba4:C,"rgb5 a1":U,rgb565:q},ge={};e.ext_srgb&&(be.srgb=Q,be.srgba=X),e.oes_texture_float&&(me.float32=me.float=ht),e.oes_texture_half_float&&(me.float16=me["half float"]=Z),e.webgl_depth_texture&&(w(be,{depth:H,"depth stencil":G}),w(me,{uint16:lt,uint32:ct,"depth stencil":V})),e.webgl_compressed_texture_s3tc&&w(ge,{"rgb s3tc dxt1":$,"rgba s3tc dxt1":J,"rgba s3tc dxt3":K,"rgba s3tc dxt5":tt}),e.webgl_compressed_texture_atc&&w(ge,{"rgb atc":et,"rgba atc explicit alpha":rt,"rgba atc interpolated alpha":nt}),e.webgl_compressed_texture_pvrtc&&w(ge,{"rgb pvrtc 4bppv1":at,"rgb pvrtc 2bppv1":it,"rgba pvrtc 4bppv1":ot,"rgba pvrtc 2bppv1":st}),e.webgl_compressed_texture_etc1&&(ge["rgb etc1"]=ut);var ve=Array.prototype.slice.call(t.getParameter(k));Object.keys(ge).forEach(function(t){var e=ge[t];ve.indexOf(e)>=0&&(be[t]=e)});var ye=Object.keys(be);r.textureFormats=ye;var xe=[];Object.keys(be).forEach(function(t){var e=be[t];xe[e]=t});var we=[];Object.keys(me).forEach(function(t){var e=me[t];we[e]=t});var Me=[];Object.keys(he).forEach(function(t){var e=he[t];Me[e]=t});var Se=[];Object.keys(de).forEach(function(t){var e=de[t];Se[e]=t});var _e=[];Object.keys(ce).forEach(function(t){var e=ce[t];_e[e]=t});var De=ye.reduce(function(t,e){var r=be[e];return r===B||r===z||r===B||r===P||r===H||r===G?t[r]=r:r===U||e.indexOf("rgba")>=0?t[r]=O:t[r]=L,t},{}),Ae=[],Ie=[],Ee=0,Fe={},ke=r.maxTextureUnits,je=Array(ke).map(function(){return null});return w(re.prototype,{bind:function(){var e=this;e.bindCount+=1;var r=e.unit;if(r<0){for(var n=0;n<ke;++n){var a=je[n];if(a){if(a.bindCount>0)continue;a.unit=-1}je[n]=e,r=n;break}r>=ke&&x.raise("insufficient number of texture units"),m.profile&&p.maxTextureUnits<r+1&&(p.maxTextureUnits=r+1),e.unit=r,t.activeTexture(Lt+r),t.bindTexture(e.target,e.texture)}return r},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&ie(this);
}}),m.profile&&(p.getTotalTextureSize=function(){var t=0;return Object.keys(Fe).forEach(function(e){t+=Fe[e].stats.size}),t}),{create2D:oe,createCube:se,clear:ue,getTexture:function(t){return null},restore:fe}}},{"./constants/arraytypes.json":49,"./util/check":66,"./util/extend":69,"./util/is-array-like":70,"./util/is-ndarray":71,"./util/is-typed-array":72,"./util/pool":74,"./util/to-half-float":76,"./util/values":77}],65:[function(t,e,r){var n=34918,a=34919,i=35007;e.exports=function(t,e){function r(){return m.pop()||p.createQueryEXT()}function o(t){m.push(t)}function s(t){var e=r();p.beginQueryEXT(i,e),b.push(e),h(b.length-1,b.length,t)}function u(){p.endQueryEXT(i)}function f(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function l(){return g.pop()||new f}function c(t){g.push(t)}function h(t,e,r){var n=l();n.startQueryIndex=t,n.endQueryIndex=e,n.sum=0,n.stats=r,v.push(n)}function d(){var t,e,r=b.length;if(0!==r){x.length=Math.max(x.length,r+1),y.length=Math.max(y.length,r+1),y[0]=0,x[0]=0;var i=0;for(t=0,e=0;e<b.length;++e){var s=b[e];p.getQueryObjectEXT(s,a)?(i+=p.getQueryObjectEXT(s,n),o(s)):b[t++]=s,y[e+1]=i,x[e+1]=t}for(b.length=t,t=0,e=0;e<v.length;++e){var u=v[e],f=u.startQueryIndex,l=u.endQueryIndex;u.sum+=y[l]-y[f];var h=x[f],d=x[l];d===h?(u.stats.gpuTime+=u.sum/1e6,c(u)):(u.startQueryIndex=h,u.endQueryIndex=d,v[t++]=u)}v.length=t}}var p=e.ext_disjoint_timer_query;if(!p)return null;var m=[],b=[],g=[],v=[],y=[],x=[];return{beginQuery:s,endQuery:u,pushScopeStats:h,update:d,getNumPendingQueries:function(){return b.length},clear:function(){m.push.apply(m,b);for(var t=0;t<m.length;t++)p.deleteQueryEXT(m[t]);b.length=0,m.length=0},restore:function(){b.length=0,m.length=0}}}},{}],66:[function(t,e,r){function n(t){return"undefined"!=typeof btoa?btoa(t):"base64:"+t}function a(t){var e=new Error("(regl) "+t);throw console.error(e),e}function i(t,e){t||a(e)}function o(t){return t?": "+t:""}function s(t,e,r){t in e||a("unknown parameter ("+t+")"+o(r)+". possible values: "+Object.keys(e).join())}function u(t,e){L(t)||a("invalid parameter type"+o(e)+". must be a typed array")}function f(t,e,r){typeof t!==e&&a("invalid parameter type"+o(r)+". expected "+e+", got "+typeof t)}function l(t,e){t>=0&&(0|t)===t||a("invalid parameter type, ("+t+")"+o(e)+". must be a nonnegative integer")}function c(t,e,r){e.indexOf(t)<0&&a("invalid value"+o(r)+". must be one of: "+e)}function h(t){Object.keys(t).forEach(function(t){P.indexOf(t)<0&&a('invalid regl constructor argument "'+t+'". must be one of '+P)})}function d(t,e){for(t+="";t.length<e;)t=" "+t;return t}function p(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function m(t,e){this.number=t,this.line=e,this.errors=[]}function b(t,e,r){this.file=t,this.line=e,this.message=r}function g(){var t=new Error,e=(t.stack||t).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return n?n[1]:"unknown"}function v(){var t=new Error,e=(t.stack||t).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return n?n[1]:"unknown"}function y(t,e){var r=t.split("\n"),a=1,i=0,o={unknown:new p,0:new p};o.unknown.name=o[0].name=e||g(),o.unknown.lines.push(new m(0,""));for(var s=0;s<r.length;++s){var u=r[s],f=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(u);if(f)switch(f[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(f[2]);l&&(a=0|l[1],l[2]&&(i=0|l[2],i in o||(o[i]=new p)));break;case"define":var c=/SHADER_NAME(_B64)?\s+(.*)$/.exec(f[2]);c&&(o[i].name=c[1]?n(c[2]):c[2])}o[i].lines.push(new m(a++,u))}return Object.keys(o).forEach(function(t){var e=o[t];e.lines.forEach(function(t){e.index[t.number]=t})}),o}function x(t){var e=[];return t.split("\n").forEach(function(t){if(!(t.length<5)){var r=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(t);r?e.push(new b(0|r[1],0|r[2],r[3].trim())):t.length>0&&e.push(new b("unknown",0,t))}}),e}function w(t,e){e.forEach(function(e){var r=t[e.file];if(r){var n=r.index[e.line];if(n)return n.errors.push(e),void(r.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)})}function M(t,e,r,n,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(e),s=n===t.FRAGMENT_SHADER?"fragment":"vertex";F(r,"string",s+" shader source must be a string",a);var u=y(r,a),f=x(o);w(u,f),Object.keys(u).forEach(function(t){function e(t,e){n.push(t),a.push(e||"")}var r=u[t];if(r.hasErrors){var n=[""],a=[""];e("file number "+t+": "+r.name+"\n","color:red;text-decoration:underline;font-weight:bold"),r.lines.forEach(function(t){if(t.errors.length>0){e(d(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),e(t.line+"\n","color:red; background-color:yellow; font-weight:bold");var r=0;t.errors.forEach(function(n){var a=n.message,i=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(a);if(i){var o=i[1];switch(a=i[2],o){case"assign":o="="}r=Math.max(t.line.indexOf(o,r),0)}else r=0;e(d("| ",6)),e(d("^^^",r+3)+"\n","font-weight:bold"),e(d("| ",6)),e(a+"\n","font-weight:bold")}),e(d("| ",6)+"\n")}else e(d(t.number,4)+"|  "),e(t.line+"\n","color:red")}),"undefined"!=typeof document?(a[0]=n.join("%c"),console.log.apply(console,a)):console.log(n.join(""))}}),i.raise("Error compiling "+s+" shader, "+u[0].name)}}function S(t,e,r,n,a){if(!t.getProgramParameter(e,t.LINK_STATUS)){var o=t.getProgramInfoLog(e),s=y(r,a),u=y(n,a),f='Error linking program with vertex shader, "'+u[0].name+'", and fragment shader "'+s[0].name+'"';"undefined"!=typeof document?console.log("%c"+f+"\n%c"+o,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+o),i.raise(f)}}function _(t){t._commandRef=g()}function D(t,e,r,n){function a(t){return t?n.id(t):0}function i(t,e){Object.keys(e).forEach(function(e){t[n.id(e)]=!0})}_(t),t._fragId=a(t.static.frag),t._vertId=a(t.static.vert);var o=t._uniformSet={};i(o,e.static),i(o,e.dynamic);var s=t._attributeSet={};i(s,r.static),i(s,r.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function A(t,e){var r=v();a(t+" in command "+(e||g())+("unknown"===r?"":" called from "+r))}function I(t,e,r){t||A(e,r||g())}function E(t,e,r,n){t in e||A("unknown parameter ("+t+")"+o(r)+". possible values: "+Object.keys(e).join(),n||g())}function F(t,e,r,n){typeof t!==e&&A("invalid parameter type"+o(r)+". expected "+e+", got "+typeof t,n||g())}function k(t){t()}function j(t,e,r){t.texture?c(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):c(t.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")}function T(t,e){return t===K||t===J||t===tt?2:t===et?4:nt[t]*e}function R(t){return!(t&t-1||!t)}function O(t,e,r){var n,a=e.width,o=e.height,s=e.channels;i(a>0&&a<=r.maxTextureSize&&o>0&&o<=r.maxTextureSize,"invalid texture shape"),t.wrapS===C&&t.wrapT===C||i(R(a)&&R(o),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==a&&1!==o&&i(t.minFilter!==q&&t.minFilter!==Y&&t.minFilter!==N&&t.minFilter!==W,"min filter requires mipmap"):(i(R(a)&&R(o),"texture must be a square power of 2 to support mipmapping"),i(e.mipmask===(a<<1)-1,"missing or incomplete mipmap data")),e.type===$&&(r.extensions.indexOf("oes_texture_float_linear")<0&&i(t.minFilter===U&&t.magFilter===U,"filter not supported, must enable oes_texture_float_linear"),i(!t.genMipmaps,"mipmap generation not supported with float textures"));var u=e.images;for(n=0;n<16;++n)if(u[n]){var f=a>>n,l=o>>n;i(e.mipmask&1<<n,"missing mipmap data");var c=u[n];i(c.width===f&&c.height===l,"invalid shape for mip images"),i(c.format===e.format&&c.internalformat===e.internalformat&&c.type===e.type,"incompatible type for mip image"),c.compressed||(c.data?i(c.data.byteLength===f*l*Math.max(T(c.type,s),c.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):c.element||c.copy)}else t.genMipmaps||i(0===(e.mipmask&1<<n),"extra mipmap data");e.compressed&&i(!t.genMipmaps,"mipmap generation for compressed images not supported")}function z(t,e,r,n){var a=t.width,o=t.height,s=t.channels;i(a>0&&a<=n.maxTextureSize&&o>0&&o<=n.maxTextureSize,"invalid texture shape"),i(a===o,"cube map must be square"),i(e.wrapS===C&&e.wrapT===C,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var f=r[u];i(f.width===a&&f.height===o,"inconsistent cube map face shape"),e.genMipmaps&&(i(!f.compressed,"can not generate mipmap for compressed textures"),i(1===f.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=f.images,c=0;c<16;++c){var h=l[c];if(h){var d=a>>c,p=o>>c;i(f.mipmask&1<<c,"missing mipmap data"),i(h.width===d&&h.height===p,"invalid shape for mip images"),i(h.format===t.format&&h.internalformat===t.internalformat&&h.type===t.type,"incompatible type for mip image"),h.compressed||(h.data?i(h.data.byteLength===d*p*Math.max(T(h.type,s),h.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):h.element||h.copy)}}}}var L=t("./is-typed-array"),B=t("./extend"),P=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],C=33071,U=9728,q=9984,N=9985,Y=9986,W=9987,V=5120,H=5121,G=5122,Q=5123,X=5124,Z=5125,$=5126,J=32819,K=32820,tt=33635,et=34042,rt=36193,nt={};nt[V]=nt[H]=1,nt[G]=nt[Q]=nt[rt]=nt[tt]=nt[J]=nt[K]=2,nt[X]=nt[Z]=nt[$]=nt[et]=4,e.exports=B(i,{optional:k,raise:a,commandRaise:A,command:I,parameter:s,commandParameter:E,constructor:h,type:f,commandType:F,isTypedArray:u,nni:l,oneOf:c,shaderError:M,linkError:S,callSite:v,saveCommandRef:_,saveDrawInfo:D,framebufferFormat:j,guessCommand:g,texture2D:O,textureCube:z})},{"./extend":69,"./is-typed-array":72}],67:[function(t,e,r){e.exports="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},{}],68:[function(t,e,r){function n(t){return Array.prototype.slice.call(t)}function a(t){return n(t).join("")}var i=t("./extend");e.exports=function(){function t(t){for(var e=0;e<c.length;++e)if(c[e]===t)return l[e];var r="g"+f++;return l.push(r),c.push(t),r}function e(){function t(){r.push.apply(r,n(arguments))}function e(){var t="v"+f++;return o.push(t),arguments.length>0&&(r.push(t,"="),r.push.apply(r,n(arguments)),r.push(";")),t}var r=[],o=[];return i(t,{def:e,toString:function(){return a([o.length>0?"var "+o+";":"",a(r)])}})}function r(){function t(t,e){a(t,e,"=",r.def(t,e),";")}var r=e(),a=e(),o=r.toString,s=a.toString;return i(function(){r.apply(r,n(arguments))},{def:r.def,entry:r,exit:a,save:t,set:function(e,n,a){t(e,n),r(e,n,"=",a,";")},toString:function(){return o()+s()}})}function o(){var t=a(arguments),e=r(),o=r(),s=e.toString,u=o.toString;return i(e,{then:function(){return e.apply(e,n(arguments)),this},else:function(){return o.apply(o,n(arguments)),this},toString:function(){var e=u();return e&&(e="else{"+e+"}"),a(["if(",t,"){",s(),"}",e])}})}function s(t,e){function n(){var t="a"+o.length;return o.push(t),t}var o=[];e=e||0;for(var s=0;s<e;++s)n();var u=r(),f=u.toString,l=d[t]=i(u,{arg:n,toString:function(){return a(["function(",o.join(),"){",f(),"}"])}});return l}function u(){var t=['"use strict";',h,"return {"];Object.keys(d).forEach(function(e){t.push('"',e,'":',d[e].toString(),",")}),t.push("}");var e=a(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),r=Function.apply(null,l.concat(e));return r.apply(null,c)}var f=0,l=[],c=[],h=e(),d={};return{global:h,link:t,block:e,proc:s,scope:r,cond:o,compile:u}}},{"./extend":69}],69:[function(t,e,r){e.exports=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t}},{}],70:[function(t,e,r){var n=t("./is-typed-array");e.exports=function(t){return Array.isArray(t)||n(t)}},{"./is-typed-array":72}],71:[function(t,e,r){var n=t("./is-typed-array");e.exports=function(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||n(t.data))}},{"./is-typed-array":72}],72:[function(t,e,r){var n=t("../constants/arraytypes.json");e.exports=function(t){return Object.prototype.toString.call(t)in n}},{"../constants/arraytypes.json":49}],73:[function(t,e,r){e.exports=function(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}},{}],74:[function(t,e,r){function n(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function a(t){var e,r;return e=(t>65535)<<4,t>>>=e,r=(t>255)<<3,t>>>=r,e|=r,r=(t>15)<<2,t>>>=r,e|=r,r=(t>3)<<1,t>>>=r,e|=r,e|t>>1}function i(t){var e=n(t),r=g[a(e)>>2];return r.length>0?r.pop():new ArrayBuffer(e)}function o(t){g[a(t.byteLength)>>2].push(t)}function s(t,e){var r=null;switch(t){case l:r=new Int8Array(i(e),0,e);break;case c:r=new Uint8Array(i(e),0,e);break;case h:r=new Int16Array(i(2*e),0,e);break;case d:r=new Uint16Array(i(2*e),0,e);break;case p:r=new Int32Array(i(4*e),0,e);break;case m:r=new Uint32Array(i(4*e),0,e);break;case b:r=new Float32Array(i(4*e),0,e);break;default:return null}return r.length!==e?r.subarray(0,e):r}function u(t){o(t.buffer)}var f=t("./loop"),l=5120,c=5121,h=5122,d=5123,p=5124,m=5125,b=5126,g=f(8,function(){return[]});e.exports={alloc:i,free:o,allocType:s,freeType:u}},{"./loop":73}],75:[function(t,e,r){"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?e.exports={next:function(t){return requestAnimationFrame(t)},cancel:function(t){return cancelAnimationFrame(t)}}:e.exports={next:function(t){return setTimeout(t,16)},cancel:clearTimeout}},{}],76:[function(t,e,r){var n=t("./pool"),a=new Float32Array(1),i=new Uint32Array(a.buffer),o=5123;e.exports=function(t){for(var e=n.allocType(o,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(t[r]===1/0)e[r]=31744;else if(t[r]===-(1/0))e[r]=64512;else{a[0]=t[r];var s=i[0],u=s>>>31<<15,f=(s<<1>>>24)-127,l=s>>13&1023;if(f<-24)e[r]=u;else if(f<-14){var c=-14-f;e[r]=u+(l+1024>>c)}else f>15?e[r]=u+31744:e[r]=u+(f+15<<10)+l}return e}},{"./pool":74}],77:[function(t,e,r){e.exports=function(t){return Object.keys(t).map(function(e){return t[e]})}},{}],78:[function(t,e,r){function n(t,e,r){function n(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();e=a.right-a.left,n=a.top-a.bottom}i.width=r*e,i.height=r*n,l(i.style,{width:e+"px",height:n+"px"})}function a(){window.removeEventListener("resize",n),t.removeChild(i)}var i=document.createElement("canvas");return l(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",l(t.style,{margin:0,padding:0})),window.addEventListener("resize",n,!1),n(),{canvas:i,onDestroy:a}}function a(t,e){function r(r){try{return t.getContext(r,e)}catch(t){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function i(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function o(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function s(t){return"string"==typeof t?t.split():(f(Array.isArray(t),"invalid extension array"),t)}function u(t){return"string"==typeof t?(f("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}var f=t("./util/check"),l=t("./util/extend");e.exports=function(t){var e,r,l,c,h=t||{},d={},p=[],m=[],b="undefined"==typeof window?1:window.devicePixelRatio,g=!1,v=function(t){t&&f.raise(t)},y=function(){};if("string"==typeof h?(f("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(h),f(e,"invalid query string for element")):"object"==typeof h?i(h)?e=h:o(h)?(c=h,l=c.canvas):(f.constructor(h),"gl"in h?c=h.gl:"canvas"in h?l=u(h.canvas):"container"in h&&(r=u(h.container)),"attributes"in h&&(d=h.attributes,f.type(d,"object","invalid context attributes")),"extensions"in h&&(p=s(h.extensions)),"optionalExtensions"in h&&(m=s(h.optionalExtensions)),"onDone"in h&&(f.type(h.onDone,"function","invalid or missing onDone callback"),v=h.onDone),"profile"in h&&(g=!!h.profile),"pixelRatio"in h&&(b=+h.pixelRatio,f(b>0,"invalid pixel ratio"))):f.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?l=e:r=e),!c){if(!l){f("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var x=n(r||document.body,v,b);if(!x)return null;l=x.canvas,y=x.onDestroy}c=a(l,d)}return c?{gl:c,canvas:l,container:r,extensions:p,optionalExtensions:m,pixelRatio:b,profile:g,onDone:v,onDestroy:y}:(y(),v("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/check":66,"./util/extend":69}],79:[function(t,e,r){function n(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}var a=t("./lib/util/check"),i=t("./lib/util/extend"),o=t("./lib/dynamic"),s=t("./lib/util/raf"),u=t("./lib/util/clock"),f=t("./lib/strings"),l=t("./lib/webgl"),c=t("./lib/extension"),h=t("./lib/limits"),d=t("./lib/buffer"),p=t("./lib/elements"),m=t("./lib/texture"),b=t("./lib/renderbuffer"),g=t("./lib/framebuffer"),v=t("./lib/attribute"),y=t("./lib/shader"),x=t("./lib/read"),w=t("./lib/core"),M=t("./lib/stats"),S=t("./lib/timer"),_=16384,D=256,A=1024,I=34962,E="webglcontextlost",F="webglcontextrestored",k=1,j=2,T=3;e.exports=function(t){function e(){if(0===vt.length)return K&&K.update(),void(Mt=null);Mt=s.next(e),q();for(var t=vt.length-1;t>=0;--t){var r=vt[t];r&&r(nt,null,0)}H.flush(),K&&K.update()}function r(){!Mt&&vt.length>0&&(Mt=s.next(e))}function R(){Mt&&(s.cancel(e),Mt=null)}function O(t){t.preventDefault(),Q=!0,R(),yt.forEach(function(t){t()})}function z(t){H.getError(),Q=!1,X.restore(),lt.restore(),st.restore(),ct.restore(),ht.restore(),dt.restore(),K&&K.restore(),pt.procs.refresh(),r(),xt.forEach(function(t){t()})}function L(){vt.length=0,R(),gt&&(gt.removeEventListener(E,O),gt.removeEventListener(F,z)),lt.clear(),dt.clear(),ht.clear(),ct.clear(),ut.clear(),st.clear(),K&&K.clear(),wt.forEach(function(t){t()})}function B(t){function e(t){function e(t){if(t in r){var e=r[t];delete r[t],Object.keys(e).forEach(function(n){r[t+"."+n]=e[n]})}}var r=i({},t);return delete r.uniforms,delete r.attributes,delete r.context,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),e("blend"),e("depth"),e("cull"),e("stencil"),e("polygonOffset"),e("scissor"),e("sample"),r}function r(t){var e={},r={};return Object.keys(t).forEach(function(n){var a=t[n];o.isDynamic(a)?r[n]=o.unbox(a,n):e[n]=a}),{dynamic:r,static:e}}function n(t){for(;g.length<t;)g.push(null);return g}function s(t,e){var r;if(Q&&a.raise("context lost"),"function"==typeof t)return b.call(this,null,t,0);if("function"==typeof e){if("number"==typeof t){for(r=0;r<t;++r)b.call(this,null,e,r);return}if(Array.isArray(t)){for(r=0;r<t.length;++r)b.call(this,t[r],e,r);return}return b.call(this,t,e,0)}if("number"==typeof t){if(t>0)return m.call(this,n(0|t),0|t)}else{if(!Array.isArray(t))return p.call(this,t);if(t.length)return m.call(this,t,t.length)}}a(!!t,"invalid args to regl({...})"),a.type(t,"object","invalid args to regl({...})");var u=r(t.context||{}),f=r(t.uniforms||{}),l=r(t.attributes||{}),c=r(e(t)),h={gpuTime:0,cpuTime:0,count:0},d=pt.compile(c,l,f,u,h),p=d.draw,m=d.batch,b=d.scope,g=[];return i(s,{stats:h})}function P(t){a("object"==typeof t&&t,"regl.clear() takes an object as input");var e=0;pt.procs.poll();var r=t.color;r&&(H.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),e|=_),"depth"in t&&(H.clearDepth(+t.depth),e|=D),"stencil"in t&&(H.clearStencil(0|t.stencil),e|=A),a(!!e,"called regl.clear with no buffer specified"),H.clear(e)}function C(t){function e(){function e(){var t=n(vt,e);vt[t]=vt[vt.length-1],vt.length-=1,vt.length<=0&&R()}var r=n(vt,t);a(r>=0,"cannot cancel a frame twice"),vt[r]=e}return a.type(t,"function","regl.frame() callback must be a function"),vt.push(t),r(),{cancel:e}}function U(){var t=bt.viewport,e=bt.scissor_box;t[0]=t[1]=e[0]=e[1]=0,nt.viewportWidth=nt.framebufferWidth=nt.drawingBufferWidth=t[2]=e[2]=H.drawingBufferWidth,nt.viewportHeight=nt.framebufferHeight=nt.drawingBufferHeight=t[3]=e[3]=H.drawingBufferHeight}function q(){nt.tick+=1,nt.time=Y(),U(),pt.procs.poll()}function N(){U(),pt.procs.refresh(),K&&K.update()}function Y(){return(u()-tt)/1e3}function W(t,e){a.type(e,"function","listener callback must be a function");var r;switch(t){case"frame":return C(e);case"lost":r=yt;break;case"restore":r=xt;break;case"destroy":r=wt;break;default:a.raise("invalid event, must be one of frame,lost,restore,destroy")}return r.push(e),{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e)return r[t]=r[r.length-1],void r.pop()}}}var V=l(t);if(!V)return null;var H=V.gl,G=H.getContextAttributes(),Q=H.isContextLost(),X=c(H,V);if(!X)return null;var Z=f(),$=M(),J=X.extensions,K=S(H,J),tt=u(),et=H.drawingBufferWidth,rt=H.drawingBufferHeight,nt={tick:0,time:0,viewportWidth:et,viewportHeight:rt,framebufferWidth:et,framebufferHeight:rt,drawingBufferWidth:et,drawingBufferHeight:rt,pixelRatio:V.pixelRatio},at={},it={elements:null,primitive:4,count:-1,offset:0,instances:-1},ot=h(H,J),st=d(H,$,V),ut=p(H,J,st,$),ft=v(H,J,ot,st,Z),lt=y(H,Z,$,V),ct=m(H,J,ot,function(){pt.procs.poll()},nt,$,V),ht=b(H,J,ot,$,V),dt=g(H,J,ot,ct,ht,$),pt=w(H,Z,J,ot,st,ut,ct,dt,at,ft,lt,it,nt,K,V),mt=x(H,dt,pt.procs.poll,nt,G,J),bt=pt.next,gt=H.canvas,vt=[],yt=[],xt=[],wt=[V.onDestroy],Mt=null;gt&&(gt.addEventListener(E,O,!1),gt.addEventListener(F,z,!1)),N();var St=i(B,{clear:P,prop:o.define.bind(null,k),context:o.define.bind(null,j),this:o.define.bind(null,T),draw:B({}),buffer:function(t){return st.create(t,I,!1,!1)},elements:function(t){return ut.create(t,!1)},texture:ct.create2D,cube:ct.createCube,renderbuffer:ht.create,framebuffer:dt.create,framebufferCube:dt.createCube,attributes:G,frame:C,on:W,limits:ot,hasExtension:function(t){return ot.extensions.indexOf(t.toLowerCase())>=0},read:mt,destroy:L,_gl:H,_refresh:N,poll:function(){q(),K&&K.update()},now:Y,stats:$});return V.onDone(null,St),St}},{"./lib/attribute":47,"./lib/buffer":48,"./lib/core":53,"./lib/dynamic":54,"./lib/elements":55,"./lib/extension":56,"./lib/framebuffer":57,"./lib/limits":58,"./lib/read":59,"./lib/renderbuffer":60,"./lib/shader":61,"./lib/stats":62,"./lib/strings":63,"./lib/texture":64,"./lib/timer":65,"./lib/util/check":66,"./lib/util/clock":67,"./lib/util/extend":69,"./lib/util/raf":75,"./lib/webgl":78}],80:[function(t,e,r){function n(){a.call(this)}e.exports=n;var a=t("events").EventEmitter,i=t("inherits");i(n,a),n.Readable=t("readable-stream/readable.js"),n.Writable=t("readable-stream/writable.js"),n.Duplex=t("readable-stream/duplex.js"),n.Transform=t("readable-stream/transform.js"),n.PassThrough=t("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(t,e){function r(e){t.writable&&!1===t.write(e)&&f.pause&&f.pause()}function n(){f.readable&&f.resume&&f.resume()}function i(){l||(l=!0,t.end())}function o(){l||(l=!0,"function"==typeof t.destroy&&t.destroy())}function s(t){if(u(),0===a.listenerCount(this,"error"))throw t}function u(){f.removeListener("data",r),t.removeListener("drain",n),f.removeListener("end",i),f.removeListener("close",o),f.removeListener("error",s),t.removeListener("error",s),f.removeListener("end",u),f.removeListener("close",u),t.removeListener("close",u)}var f=this;f.on("data",r),t.on("drain",n),t._isStdio||e&&e.end===!1||(f.on("end",i),f.on("close",o));var l=!1;return f.on("error",s),t.on("error",s),f.on("end",u),f.on("close",u),t.on("close",u),t.emit("pipe",f),t}},{events:12,inherits:25,"readable-stream/duplex.js":36,"readable-stream/passthrough.js":43,"readable-stream/readable.js":44,"readable-stream/transform.js":45,"readable-stream/writable.js":46}],81:[function(t,e,r){function n(t){if(t&&!u(t))throw new Error("Unknown encoding: "+t)}function a(t){return t.toString(this.encoding)}function i(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function o(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var s=t("buffer").Buffer,u=s.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},f=r.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),n(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=i;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=o;break;default:return void(this.write=a)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};f.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";t=t.slice(r,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=e.charCodeAt(e.length-1);if(!(n>=55296&&n<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var a=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,a),a-=this.charReceived),e+=t.toString(this.encoding,0,a);var a=e.length-1,n=e.charCodeAt(a);if(n>=55296&&n<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),t.copy(this.charBuffer,0,0,i),e.substring(0,a)}return e},f.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(e<=2&&r>>4==14){this.charLength=3;break}if(e<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=e},f.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,a=this.encoding;e+=n.slice(0,r).toString(a)}return e}},{buffer:6}],82:[function(t,e,r){(function(n){function a(t,e,r){function a(){for(;f.length&&!c.paused;){var t=f.shift();if(null===t)return c.emit("end");c.emit("data",t)}}function o(){c.writable=!1,e.call(c),!c.readable&&c.autoDestroy&&c.destroy()}t=t||function(t){this.queue(t)},e=e||function(){this.queue(null)};var s=!1,u=!1,f=[],l=!1,c=new i;return c.readable=c.writable=!0,c.paused=!1,c.autoDestroy=!(r&&r.autoDestroy===!1),c.write=function(e){return t.call(this,e),!c.paused},c.queue=c.push=function(t){return l?c:(null===t&&(l=!0),f.push(t),a(),c)},c.on("end",function(){c.readable=!1,!c.writable&&c.autoDestroy&&n.nextTick(function(){c.destroy()})}),c.end=function(t){if(!s)return s=!0,arguments.length&&c.write(t),o(),c},c.destroy=function(){if(!u)return u=!0,s=!0,f.length=0,c.writable=c.readable=!1,c.emit("close"),c},c.pause=function(){if(!c.paused)return c.paused=!0,c},c.resume=function(){return c.paused&&(c.paused=!1,c.emit("resume")),a(),c.paused||c.emit("drain"),c},c}var i=t("stream");r=e.exports=a,a.through=a}).call(this,t("_process"))},{_process:35,stream:80}],83:[function(t,e,r){"use strict";function n(t,e){for(var r=1,n=t.length,a=t[0],i=t[0],o=1;o<n;++o)if(i=a,a=t[o],e(a,i)){if(o===r){r++;continue}t[r++]=a}return t.length=r,t}function a(t){for(var e=1,r=t.length,n=t[0],a=t[0],i=1;i<r;++i,a=n)if(a=n,n=t[i],n!==a){if(i===e){e++;continue}t[e++]=n}return t.length=e,t}function i(t,e,r){return 0===t.length?t:e?(r||t.sort(e),n(t,e)):(r||t.sort(),a(t))}e.exports=i},{}],84:[function(t,e,r){(function(t){function r(t,e){function r(){if(!a){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),a=!0}return t.apply(this,arguments)}if(n("noDeprecation"))return t;var a=!1;return r}function n(e){try{if(!t.localStorage)return!1}catch(t){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],85:[function(t,e,r){!function(t){"use strict";var r={};"undefined"!=typeof e?e.exports=r:window.OBJ=r,r.Mesh=function(t){var e=[],r=[],n=[],a={};a.verts=[],a.norms=[],a.textures=[],a.hashindices={},a.indices=[],a.index=0;for(var i=t.split("\n"),o=/^v\s/,s=/^vn\s/,u=/^vt\s/,f=/^f\s/,l=/\s+/,c=0;c<i.length;c++){var h=i[c].trim(),d=h.split(l);if(d.shift(),o.test(h))e.push.apply(e,d);else if(s.test(h))r.push.apply(r,d);else if(u.test(h))n.push.apply(n,d);else if(f.test(h))for(var p=!1,m=0,b=d.length;m<b;m++){if(3!==m||p||(m=2,p=!0),d[m]in a.hashindices)a.indices.push(a.hashindices[d[m]]);else{var g=d[m].split("/");a.verts.push(+e[3*(g[0]-1)+0]),a.verts.push(+e[3*(g[0]-1)+1]),a.verts.push(+e[3*(g[0]-1)+2]),n.length&&(a.textures.push(+n[2*(g[1]-1)+0]),a.textures.push(+n[2*(g[1]-1)+1])),a.norms.push(+r[3*(g[2]-1)+0]),a.norms.push(+r[3*(g[2]-1)+1]),a.norms.push(+r[3*(g[2]-1)+2]),a.hashindices[d[m]]=a.index,a.indices.push(a.index),a.index+=1}3===m&&p&&a.indices.push(a.hashindices[d[0]])}}this.vertices=a.verts,this.vertexNormals=a.norms,this.textures=a.textures,this.indices=a.indices};var n=function(){var t=this;this.xmlhttp=new XMLHttpRequest,this.get=function(e,r){t.xmlhttp.onreadystatechange=function(){4===t.xmlhttp.readyState&&r(t.xmlhttp.responseText,t.xmlhttp.status)},t.xmlhttp.open("GET",e,!0),t.xmlhttp.send()}};r.downloadMeshes=function(e,a,i){var o=Object.keys(e).length,s=!1;i===t&&(i={});for(var u in e)e.hasOwnProperty(u)&&(new n).get(e[u],function(t){return function(e,n){if(200===n?i[t]=new r.Mesh(e):(s=!0,console.error('An error has occurred and the mesh "'+t+'" could not be downloaded.')),o--,0===o){if(s)throw console.error("An error has occurred and one or meshes has not been downloaded. The execution of the script has terminated."),"";a(i)}}}(u))};var a=function(t,e,r,n){var a=t.createBuffer(),i=e===t.ARRAY_BUFFER?Float32Array:Uint16Array;return t.bindBuffer(e,a),t.bufferData(e,new i(r),t.STATIC_DRAW),a.itemSize=n,a.numItems=r.length/n,a};r.initMeshBuffers=function(t,e){e.normalBuffer=a(t,t.ARRAY_BUFFER,e.vertexNormals,3),e.textureBuffer=a(t,t.ARRAY_BUFFER,e.textures,2),e.vertexBuffer=a(t,t.ARRAY_BUFFER,e.vertices,3),e.indexBuffer=a(t,t.ELEMENT_ARRAY_BUFFER,e.indices,1)},r.deleteMeshBuffers=function(t,e){t.deleteBuffer(e.normalBuffer),t.deleteBuffer(e.textureBuffer),t.deleteBuffer(e.vertexBuffer),t.deleteBuffer(e.indexBuffer)}}()},{}]},{},[2]);
